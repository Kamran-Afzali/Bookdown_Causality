<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 4 Causal Inference in Practice III: Difference-in-Differences with a Healthcare Application | Causal Inference in R</title>
  <meta name="description" content="Chapter 4 Causal Inference in Practice III: Difference-in-Differences with a Healthcare Application | Causal Inference in R" />
  <meta name="generator" content="bookdown 0.43 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 4 Causal Inference in Practice III: Difference-in-Differences with a Healthcare Application | Causal Inference in R" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 4 Causal Inference in Practice III: Difference-in-Differences with a Healthcare Application | Causal Inference in R" />
  
  
  

<meta name="author" content="Kamran Afzali" />


<meta name="date" content="2025-09-14" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="causal-inference-in-practice-ii-propensity-scores-doubly-robust-estimators-and-inverse-probability-weighting.html"/>
<link rel="next" href="causal-inference-in-practice-iv-instrumental-variables.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Causality analysis in R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Foundations of Causal Statistical Analysis</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#introduction"><i class="fa fa-check"></i><b>1.1</b> Introduction</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#summary-table-techniques-for-causal-statistical-analysis"><i class="fa fa-check"></i><b>1.2</b> Summary Table: Techniques for Causal Statistical Analysis</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#methodological-deep-dive-with-practical-guidance"><i class="fa fa-check"></i><b>1.3</b> Methodological Deep Dive with Practical Guidance</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#discussion"><i class="fa fa-check"></i><b>1.4</b> Discussion</a></li>
<li class="chapter" data-level="1.5" data-path="index.html"><a href="index.html#references"><i class="fa fa-check"></i><b>1.5</b> References</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="causal-inference-in-practice-i-randomized-controlled-trials-and-regression-adjustment.html"><a href="causal-inference-in-practice-i-randomized-controlled-trials-and-regression-adjustment.html"><i class="fa fa-check"></i><b>2</b> Causal Inference in Practice I: Randomized Controlled Trials and Regression Adjustment</a>
<ul>
<li class="chapter" data-level="2.1" data-path="causal-inference-in-practice-i-randomized-controlled-trials-and-regression-adjustment.html"><a href="causal-inference-in-practice-i-randomized-controlled-trials-and-regression-adjustment.html#introduction-1"><i class="fa fa-check"></i><b>2.1</b> Introduction</a></li>
<li class="chapter" data-level="2.2" data-path="causal-inference-in-practice-i-randomized-controlled-trials-and-regression-adjustment.html"><a href="causal-inference-in-practice-i-randomized-controlled-trials-and-regression-adjustment.html#randomized-controlled-trials-design-and-analysis"><i class="fa fa-check"></i><b>2.2</b> 1. Randomized Controlled Trials: Design and Analysis</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="causal-inference-in-practice-i-randomized-controlled-trials-and-regression-adjustment.html"><a href="causal-inference-in-practice-i-randomized-controlled-trials-and-regression-adjustment.html#theoretical-foundations"><i class="fa fa-check"></i><b>2.2.1</b> Theoretical Foundations</a></li>
<li class="chapter" data-level="2.2.2" data-path="causal-inference-in-practice-i-randomized-controlled-trials-and-regression-adjustment.html"><a href="causal-inference-in-practice-i-randomized-controlled-trials-and-regression-adjustment.html#r-implementation"><i class="fa fa-check"></i><b>2.2.2</b> R Implementation</a></li>
<li class="chapter" data-level="2.2.3" data-path="causal-inference-in-practice-i-randomized-controlled-trials-and-regression-adjustment.html"><a href="causal-inference-in-practice-i-randomized-controlled-trials-and-regression-adjustment.html#model-based-inference"><i class="fa fa-check"></i><b>2.2.3</b> Model-Based Inference</a></li>
<li class="chapter" data-level="2.2.4" data-path="causal-inference-in-practice-i-randomized-controlled-trials-and-regression-adjustment.html"><a href="causal-inference-in-practice-i-randomized-controlled-trials-and-regression-adjustment.html#diagnostics-and-integrity"><i class="fa fa-check"></i><b>2.2.4</b> Diagnostics and Integrity</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="causal-inference-in-practice-i-randomized-controlled-trials-and-regression-adjustment.html"><a href="causal-inference-in-practice-i-randomized-controlled-trials-and-regression-adjustment.html#regression-adjustment-a-model-based-approach-to-causal-inference"><i class="fa fa-check"></i><b>2.3</b> 2. Regression Adjustment: A Model-Based Approach to Causal Inference</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="causal-inference-in-practice-i-randomized-controlled-trials-and-regression-adjustment.html"><a href="causal-inference-in-practice-i-randomized-controlled-trials-and-regression-adjustment.html#conceptual-overview"><i class="fa fa-check"></i><b>2.3.1</b> Conceptual Overview</a></li>
<li class="chapter" data-level="2.3.2" data-path="causal-inference-in-practice-i-randomized-controlled-trials-and-regression-adjustment.html"><a href="causal-inference-in-practice-i-randomized-controlled-trials-and-regression-adjustment.html#r-implementation-1"><i class="fa fa-check"></i><b>2.3.2</b> R Implementation</a></li>
<li class="chapter" data-level="2.3.3" data-path="causal-inference-in-practice-i-randomized-controlled-trials-and-regression-adjustment.html"><a href="causal-inference-in-practice-i-randomized-controlled-trials-and-regression-adjustment.html#limitations-and-diagnostics"><i class="fa fa-check"></i><b>2.3.3</b> Limitations and Diagnostics</a></li>
<li class="chapter" data-level="2.3.4" data-path="causal-inference-in-practice-i-randomized-controlled-trials-and-regression-adjustment.html"><a href="causal-inference-in-practice-i-randomized-controlled-trials-and-regression-adjustment.html#causal-interpretation"><i class="fa fa-check"></i><b>2.3.4</b> Causal Interpretation</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="causal-inference-in-practice-i-randomized-controlled-trials-and-regression-adjustment.html"><a href="causal-inference-in-practice-i-randomized-controlled-trials-and-regression-adjustment.html#toward-integrated-reasoning"><i class="fa fa-check"></i><b>2.4</b> Toward Integrated Reasoning</a></li>
<li class="chapter" data-level="2.5" data-path="causal-inference-in-practice-i-randomized-controlled-trials-and-regression-adjustment.html"><a href="causal-inference-in-practice-i-randomized-controlled-trials-and-regression-adjustment.html#conclusion"><i class="fa fa-check"></i><b>2.5</b> Conclusion</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="causal-inference-in-practice-ii-propensity-scores-doubly-robust-estimators-and-inverse-probability-weighting.html"><a href="causal-inference-in-practice-ii-propensity-scores-doubly-robust-estimators-and-inverse-probability-weighting.html"><i class="fa fa-check"></i><b>3</b> Causal Inference in Practice II: Propensity Scores, Doubly Robust Estimators, and Inverse Probability Weighting</a>
<ul>
<li class="chapter" data-level="3.1" data-path="causal-inference-in-practice-ii-propensity-scores-doubly-robust-estimators-and-inverse-probability-weighting.html"><a href="causal-inference-in-practice-ii-propensity-scores-doubly-robust-estimators-and-inverse-probability-weighting.html#propensity-score-methods"><i class="fa fa-check"></i><b>3.1</b> Propensity Score Methods</a></li>
<li class="chapter" data-level="3.2" data-path="causal-inference-in-practice-ii-propensity-scores-doubly-robust-estimators-and-inverse-probability-weighting.html"><a href="causal-inference-in-practice-ii-propensity-scores-doubly-robust-estimators-and-inverse-probability-weighting.html#inverse-probability-weighting-ipw"><i class="fa fa-check"></i><b>3.2</b> Inverse Probability Weighting (IPW)</a></li>
<li class="chapter" data-level="3.3" data-path="causal-inference-in-practice-ii-propensity-scores-doubly-robust-estimators-and-inverse-probability-weighting.html"><a href="causal-inference-in-practice-ii-propensity-scores-doubly-robust-estimators-and-inverse-probability-weighting.html#doubly-robust-estimators"><i class="fa fa-check"></i><b>3.3</b> Doubly Robust Estimators</a></li>
<li class="chapter" data-level="3.4" data-path="causal-inference-in-practice-ii-propensity-scores-doubly-robust-estimators-and-inverse-probability-weighting.html"><a href="causal-inference-in-practice-ii-propensity-scores-doubly-robust-estimators-and-inverse-probability-weighting.html#integrative-interpretation"><i class="fa fa-check"></i><b>3.4</b> Integrative Interpretation</a></li>
<li class="chapter" data-level="3.5" data-path="causal-inference-in-practice-ii-propensity-scores-doubly-robust-estimators-and-inverse-probability-weighting.html"><a href="causal-inference-in-practice-ii-propensity-scores-doubly-robust-estimators-and-inverse-probability-weighting.html#summary-table"><i class="fa fa-check"></i><b>3.5</b> Summary Table</a></li>
<li class="chapter" data-level="3.6" data-path="causal-inference-in-practice-ii-propensity-scores-doubly-robust-estimators-and-inverse-probability-weighting.html"><a href="causal-inference-in-practice-ii-propensity-scores-doubly-robust-estimators-and-inverse-probability-weighting.html#conclusion-1"><i class="fa fa-check"></i><b>3.6</b> Conclusion</a></li>
<li class="chapter" data-level="3.7" data-path="causal-inference-in-practice-ii-propensity-scores-doubly-robust-estimators-and-inverse-probability-weighting.html"><a href="causal-inference-in-practice-ii-propensity-scores-doubly-robust-estimators-and-inverse-probability-weighting.html#references-1"><i class="fa fa-check"></i><b>3.7</b> References</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="causal-inference-in-practice-iii-difference-in-differences-with-a-healthcare-application.html"><a href="causal-inference-in-practice-iii-difference-in-differences-with-a-healthcare-application.html"><i class="fa fa-check"></i><b>4</b> Causal Inference in Practice III: Difference-in-Differences with a Healthcare Application</a>
<ul>
<li class="chapter" data-level="4.1" data-path="causal-inference-in-practice-iii-difference-in-differences-with-a-healthcare-application.html"><a href="causal-inference-in-practice-iii-difference-in-differences-with-a-healthcare-application.html#introduction-2"><i class="fa fa-check"></i><b>4.1</b> Introduction</a></li>
<li class="chapter" data-level="4.2" data-path="causal-inference-in-practice-iii-difference-in-differences-with-a-healthcare-application.html"><a href="causal-inference-in-practice-iii-difference-in-differences-with-a-healthcare-application.html#difference-in-differences-theoretical-framework"><i class="fa fa-check"></i><b>4.2</b> Difference-in-Differences: Theoretical Framework</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="causal-inference-in-practice-iii-difference-in-differences-with-a-healthcare-application.html"><a href="causal-inference-in-practice-iii-difference-in-differences-with-a-healthcare-application.html#core-concept"><i class="fa fa-check"></i><b>4.2.1</b> Core Concept</a></li>
<li class="chapter" data-level="4.2.2" data-path="causal-inference-in-practice-iii-difference-in-differences-with-a-healthcare-application.html"><a href="causal-inference-in-practice-iii-difference-in-differences-with-a-healthcare-application.html#mathematical-formalism"><i class="fa fa-check"></i><b>4.2.2</b> Mathematical Formalism</a></li>
<li class="chapter" data-level="4.2.3" data-path="causal-inference-in-practice-iii-difference-in-differences-with-a-healthcare-application.html"><a href="causal-inference-in-practice-iii-difference-in-differences-with-a-healthcare-application.html#key-assumption-parallel-trends"><i class="fa fa-check"></i><b>4.2.3</b> Key Assumption: Parallel Trends</a></li>
<li class="chapter" data-level="4.2.4" data-path="causal-inference-in-practice-iii-difference-in-differences-with-a-healthcare-application.html"><a href="causal-inference-in-practice-iii-difference-in-differences-with-a-healthcare-application.html#practical-considerations"><i class="fa fa-check"></i><b>4.2.4</b> Practical Considerations</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="causal-inference-in-practice-iii-difference-in-differences-with-a-healthcare-application.html"><a href="causal-inference-in-practice-iii-difference-in-differences-with-a-healthcare-application.html#application-evaluating-a-telemedicine-program-in-healthcare"><i class="fa fa-check"></i><b>4.3</b> Application: Evaluating a Telemedicine Program in Healthcare</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="causal-inference-in-practice-iii-difference-in-differences-with-a-healthcare-application.html"><a href="causal-inference-in-practice-iii-difference-in-differences-with-a-healthcare-application.html#scenario"><i class="fa fa-check"></i><b>4.3.1</b> Scenario</a></li>
<li class="chapter" data-level="4.3.2" data-path="causal-inference-in-practice-iii-difference-in-differences-with-a-healthcare-application.html"><a href="causal-inference-in-practice-iii-difference-in-differences-with-a-healthcare-application.html#simulated-data"><i class="fa fa-check"></i><b>4.3.2</b> Simulated Data</a></li>
<li class="chapter" data-level="4.3.3" data-path="causal-inference-in-practice-iii-difference-in-differences-with-a-healthcare-application.html"><a href="causal-inference-in-practice-iii-difference-in-differences-with-a-healthcare-application.html#r-implementation-2"><i class="fa fa-check"></i><b>4.3.3</b> R Implementation</a></li>
<li class="chapter" data-level="4.3.4" data-path="causal-inference-in-practice-iii-difference-in-differences-with-a-healthcare-application.html"><a href="causal-inference-in-practice-iii-difference-in-differences-with-a-healthcare-application.html#interpretation"><i class="fa fa-check"></i><b>4.3.4</b> Interpretation</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="causal-inference-in-practice-iii-difference-in-differences-with-a-healthcare-application.html"><a href="causal-inference-in-practice-iii-difference-in-differences-with-a-healthcare-application.html#limitations-and-extensions"><i class="fa fa-check"></i><b>4.4</b> Limitations and Extensions</a></li>
<li class="chapter" data-level="4.5" data-path="causal-inference-in-practice-iii-difference-in-differences-with-a-healthcare-application.html"><a href="causal-inference-in-practice-iii-difference-in-differences-with-a-healthcare-application.html#conclusion-2"><i class="fa fa-check"></i><b>4.5</b> Conclusion</a></li>
<li class="chapter" data-level="4.6" data-path="causal-inference-in-practice-iii-difference-in-differences-with-a-healthcare-application.html"><a href="causal-inference-in-practice-iii-difference-in-differences-with-a-healthcare-application.html#references-2"><i class="fa fa-check"></i><b>4.6</b> References</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="causal-inference-in-practice-iv-instrumental-variables.html"><a href="causal-inference-in-practice-iv-instrumental-variables.html"><i class="fa fa-check"></i><b>5</b> Causal Inference in Practice IV: Instrumental Variables</a>
<ul>
<li class="chapter" data-level="5.1" data-path="causal-inference-in-practice-iv-instrumental-variables.html"><a href="causal-inference-in-practice-iv-instrumental-variables.html#introduction-3"><i class="fa fa-check"></i><b>5.1</b> Introduction</a></li>
<li class="chapter" data-level="5.2" data-path="causal-inference-in-practice-iv-instrumental-variables.html"><a href="causal-inference-in-practice-iv-instrumental-variables.html#healthcare-case-study-hospital-quality-and-recovery-time"><i class="fa fa-check"></i><b>5.2</b> Healthcare Case Study: Hospital Quality and Recovery Time</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="causal-inference-in-practice-iv-instrumental-variables.html"><a href="causal-inference-in-practice-iv-instrumental-variables.html#r-implementation-3"><i class="fa fa-check"></i><b>5.2.1</b> R Implementation</a></li>
<li class="chapter" data-level="5.2.2" data-path="causal-inference-in-practice-iv-instrumental-variables.html"><a href="causal-inference-in-practice-iv-instrumental-variables.html#interpreting-the-results"><i class="fa fa-check"></i><b>5.2.2</b> Interpreting the Results</a></li>
<li class="chapter" data-level="5.2.3" data-path="causal-inference-in-practice-iv-instrumental-variables.html"><a href="causal-inference-in-practice-iv-instrumental-variables.html#robustness-checks"><i class="fa fa-check"></i><b>5.2.3</b> Robustness Checks</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="causal-inference-in-practice-iv-instrumental-variables.html"><a href="causal-inference-in-practice-iv-instrumental-variables.html#practical-considerations-and-extensions"><i class="fa fa-check"></i><b>5.3</b> Practical Considerations and Extensions</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="causal-inference-in-practice-iv-instrumental-variables.html"><a href="causal-inference-in-practice-iv-instrumental-variables.html#when-to-use-iv"><i class="fa fa-check"></i><b>5.3.1</b> When to Use IV</a></li>
<li class="chapter" data-level="5.3.2" data-path="causal-inference-in-practice-iv-instrumental-variables.html"><a href="causal-inference-in-practice-iv-instrumental-variables.html#advanced-topics"><i class="fa fa-check"></i><b>5.3.2</b> Advanced Topics</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="causal-inference-in-practice-iv-instrumental-variables.html"><a href="causal-inference-in-practice-iv-instrumental-variables.html#conclusion-3"><i class="fa fa-check"></i><b>5.4</b> Conclusion</a></li>
<li class="chapter" data-level="5.5" data-path="causal-inference-in-practice-iv-instrumental-variables.html"><a href="causal-inference-in-practice-iv-instrumental-variables.html#further-reading"><i class="fa fa-check"></i><b>5.5</b> Further Reading</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="causal-inference-in-practice-v-regression-discontinuity-design.html"><a href="causal-inference-in-practice-v-regression-discontinuity-design.html"><i class="fa fa-check"></i><b>6</b> Causal Inference in Practice V: Regression Discontinuity Design</a>
<ul>
<li class="chapter" data-level="6.1" data-path="causal-inference-in-practice-v-regression-discontinuity-design.html"><a href="causal-inference-in-practice-v-regression-discontinuity-design.html#introduction-4"><i class="fa fa-check"></i><b>6.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="causal-inference-in-practice-v-regression-discontinuity-design.html"><a href="causal-inference-in-practice-v-regression-discontinuity-design.html#comparison-with-other-methods"><i class="fa fa-check"></i><b>6.1.1</b> Comparison with Other Methods</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="causal-inference-in-practice-v-regression-discontinuity-design.html"><a href="causal-inference-in-practice-v-regression-discontinuity-design.html#healthcare-application-icu-admission-and-mortality"><i class="fa fa-check"></i><b>6.2</b> Healthcare Application: ICU Admission and Mortality</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="causal-inference-in-practice-v-regression-discontinuity-design.html"><a href="causal-inference-in-practice-v-regression-discontinuity-design.html#scenario-1"><i class="fa fa-check"></i><b>6.2.1</b> Scenario</a></li>
<li class="chapter" data-level="6.2.2" data-path="causal-inference-in-practice-v-regression-discontinuity-design.html"><a href="causal-inference-in-practice-v-regression-discontinuity-design.html#assumptions-and-validity"><i class="fa fa-check"></i><b>6.2.2</b> Assumptions and Validity</a></li>
<li class="chapter" data-level="6.2.3" data-path="causal-inference-in-practice-v-regression-discontinuity-design.html"><a href="causal-inference-in-practice-v-regression-discontinuity-design.html#r-implementation-4"><i class="fa fa-check"></i><b>6.2.3</b> R Implementation</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="causal-inference-in-practice-v-regression-discontinuity-design.html"><a href="causal-inference-in-practice-v-regression-discontinuity-design.html#interpretation-and-diagnostics"><i class="fa fa-check"></i><b>6.3</b> Interpretation and Diagnostics</a></li>
<li class="chapter" data-level="6.4" data-path="causal-inference-in-practice-v-regression-discontinuity-design.html"><a href="causal-inference-in-practice-v-regression-discontinuity-design.html#extensions-and-robustness"><i class="fa fa-check"></i><b>6.4</b> Extensions and Robustness</a></li>
<li class="chapter" data-level="6.5" data-path="causal-inference-in-practice-v-regression-discontinuity-design.html"><a href="causal-inference-in-practice-v-regression-discontinuity-design.html#limitations-and-considerations"><i class="fa fa-check"></i><b>6.5</b> Limitations and Considerations</a></li>
<li class="chapter" data-level="6.6" data-path="causal-inference-in-practice-v-regression-discontinuity-design.html"><a href="causal-inference-in-practice-v-regression-discontinuity-design.html#conclusion-4"><i class="fa fa-check"></i><b>6.6</b> Conclusion</a></li>
<li class="chapter" data-level="6.7" data-path="causal-inference-in-practice-v-regression-discontinuity-design.html"><a href="causal-inference-in-practice-v-regression-discontinuity-design.html#references-3"><i class="fa fa-check"></i><b>6.7</b> References</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="causal-forests-for-personalized-medicine-a-comprehensive-guide.html"><a href="causal-forests-for-personalized-medicine-a-comprehensive-guide.html"><i class="fa fa-check"></i><b>7</b> Causal Forests for Personalized Medicine: A Comprehensive Guide</a>
<ul>
<li class="chapter" data-level="7.1" data-path="causal-forests-for-personalized-medicine-a-comprehensive-guide.html"><a href="causal-forests-for-personalized-medicine-a-comprehensive-guide.html#introduction-5"><i class="fa fa-check"></i><b>7.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="causal-forests-for-personalized-medicine-a-comprehensive-guide.html"><a href="causal-forests-for-personalized-medicine-a-comprehensive-guide.html#why-traditional-approaches-fall-short"><i class="fa fa-check"></i><b>7.1.1</b> Why Traditional Approaches Fall Short</a></li>
<li class="chapter" data-level="7.1.2" data-path="causal-forests-for-personalized-medicine-a-comprehensive-guide.html"><a href="causal-forests-for-personalized-medicine-a-comprehensive-guide.html#the-causal-forest-solution"><i class="fa fa-check"></i><b>7.1.2</b> The Causal Forest Solution</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="causal-forests-for-personalized-medicine-a-comprehensive-guide.html"><a href="causal-forests-for-personalized-medicine-a-comprehensive-guide.html#theoretical-foundation-how-causal-forests-work"><i class="fa fa-check"></i><b>7.2</b> Theoretical Foundation: How Causal Forests Work</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="causal-forests-for-personalized-medicine-a-comprehensive-guide.html"><a href="causal-forests-for-personalized-medicine-a-comprehensive-guide.html#from-random-forests-to-causal-discovery"><i class="fa fa-check"></i><b>7.2.1</b> From Random Forests to Causal Discovery</a></li>
<li class="chapter" data-level="7.2.2" data-path="causal-forests-for-personalized-medicine-a-comprehensive-guide.html"><a href="causal-forests-for-personalized-medicine-a-comprehensive-guide.html#the-potential-outcomes-framework"><i class="fa fa-check"></i><b>7.2.2</b> The Potential Outcomes Framework</a></li>
<li class="chapter" data-level="7.2.3" data-path="causal-forests-for-personalized-medicine-a-comprehensive-guide.html"><a href="causal-forests-for-personalized-medicine-a-comprehensive-guide.html#key-identifying-assumptions"><i class="fa fa-check"></i><b>7.2.3</b> Key Identifying Assumptions</a></li>
<li class="chapter" data-level="7.2.4" data-path="causal-forests-for-personalized-medicine-a-comprehensive-guide.html"><a href="causal-forests-for-personalized-medicine-a-comprehensive-guide.html#the-splitting-innovation"><i class="fa fa-check"></i><b>7.2.4</b> The Splitting Innovation</a></li>
<li class="chapter" data-level="7.2.5" data-path="causal-forests-for-personalized-medicine-a-comprehensive-guide.html"><a href="causal-forests-for-personalized-medicine-a-comprehensive-guide.html#the-honesty-principle"><i class="fa fa-check"></i><b>7.2.5</b> The Honesty Principle</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="causal-forests-for-personalized-medicine-a-comprehensive-guide.html"><a href="causal-forests-for-personalized-medicine-a-comprehensive-guide.html#making-predictions-from-trees-to-treatment-recommendations"><i class="fa fa-check"></i><b>7.3</b> Making Predictions: From Trees to Treatment Recommendations</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="causal-forests-for-personalized-medicine-a-comprehensive-guide.html"><a href="causal-forests-for-personalized-medicine-a-comprehensive-guide.html#adaptive-weighting-for-individual-predictions"><i class="fa fa-check"></i><b>7.3.1</b> Adaptive Weighting for Individual Predictions</a></li>
<li class="chapter" data-level="7.3.2" data-path="causal-forests-for-personalized-medicine-a-comprehensive-guide.html"><a href="causal-forests-for-personalized-medicine-a-comprehensive-guide.html#honest-confidence-intervals"><i class="fa fa-check"></i><b>7.3.2</b> Honest Confidence Intervals</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="causal-forests-for-personalized-medicine-a-comprehensive-guide.html"><a href="causal-forests-for-personalized-medicine-a-comprehensive-guide.html#precision-medicine-case-study-personalized-diabetes-treatment"><i class="fa fa-check"></i><b>7.4</b> Precision Medicine Case Study: Personalized Diabetes Treatment</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="causal-forests-for-personalized-medicine-a-comprehensive-guide.html"><a href="causal-forests-for-personalized-medicine-a-comprehensive-guide.html#clinical-scenario"><i class="fa fa-check"></i><b>7.4.1</b> Clinical Scenario</a></li>
<li class="chapter" data-level="7.4.2" data-path="causal-forests-for-personalized-medicine-a-comprehensive-guide.html"><a href="causal-forests-for-personalized-medicine-a-comprehensive-guide.html#data-generation-and-setup"><i class="fa fa-check"></i><b>7.4.2</b> Data Generation and Setup</a></li>
<li class="chapter" data-level="7.4.3" data-path="causal-forests-for-personalized-medicine-a-comprehensive-guide.html"><a href="causal-forests-for-personalized-medicine-a-comprehensive-guide.html#fitting-the-causal-forest"><i class="fa fa-check"></i><b>7.4.3</b> Fitting the Causal Forest</a></li>
<li class="chapter" data-level="7.4.4" data-path="causal-forests-for-personalized-medicine-a-comprehensive-guide.html"><a href="causal-forests-for-personalized-medicine-a-comprehensive-guide.html#variable-importance-analysis"><i class="fa fa-check"></i><b>7.4.4</b> Variable Importance Analysis</a></li>
<li class="chapter" data-level="7.4.5" data-path="causal-forests-for-personalized-medicine-a-comprehensive-guide.html"><a href="causal-forests-for-personalized-medicine-a-comprehensive-guide.html#statistical-testing-for-heterogeneity"><i class="fa fa-check"></i><b>7.4.5</b> Statistical Testing for Heterogeneity</a></li>
<li class="chapter" data-level="7.4.6" data-path="causal-forests-for-personalized-medicine-a-comprehensive-guide.html"><a href="causal-forests-for-personalized-medicine-a-comprehensive-guide.html#visualization-and-pattern-discovery"><i class="fa fa-check"></i><b>7.4.6</b> Visualization and Pattern Discovery</a></li>
<li class="chapter" data-level="7.4.7" data-path="causal-forests-for-personalized-medicine-a-comprehensive-guide.html"><a href="causal-forests-for-personalized-medicine-a-comprehensive-guide.html#personalized-treatment-strategy-development"><i class="fa fa-check"></i><b>7.4.7</b> Personalized Treatment Strategy Development</a></li>
<li class="chapter" data-level="7.4.8" data-path="causal-forests-for-personalized-medicine-a-comprehensive-guide.html"><a href="causal-forests-for-personalized-medicine-a-comprehensive-guide.html#partial-dependence-analysis"><i class="fa fa-check"></i><b>7.4.8</b> Partial Dependence Analysis</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="causal-forests-for-personalized-medicine-a-comprehensive-guide.html"><a href="causal-forests-for-personalized-medicine-a-comprehensive-guide.html#clinical-insights-and-implementation"><i class="fa fa-check"></i><b>7.5</b> Clinical Insights and Implementation</a></li>
<li class="chapter" data-level="7.6" data-path="causal-forests-for-personalized-medicine-a-comprehensive-guide.html"><a href="causal-forests-for-personalized-medicine-a-comprehensive-guide.html#understanding-limitations-and-model-robustness"><i class="fa fa-check"></i><b>7.6</b> Understanding Limitations and Model Robustness</a></li>
<li class="chapter" data-level="7.7" data-path="causal-forests-for-personalized-medicine-a-comprehensive-guide.html"><a href="causal-forests-for-personalized-medicine-a-comprehensive-guide.html#future-directions-and-extensions"><i class="fa fa-check"></i><b>7.7</b> Future Directions and Extensions</a></li>
<li class="chapter" data-level="7.8" data-path="causal-forests-for-personalized-medicine-a-comprehensive-guide.html"><a href="causal-forests-for-personalized-medicine-a-comprehensive-guide.html#conclusion-transforming-precision-medicine"><i class="fa fa-check"></i><b>7.8</b> Conclusion: Transforming Precision Medicine</a></li>
<li class="chapter" data-level="7.9" data-path="causal-forests-for-personalized-medicine-a-comprehensive-guide.html"><a href="causal-forests-for-personalized-medicine-a-comprehensive-guide.html#references-4"><i class="fa fa-check"></i><b>7.9</b> References</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="bayesian-structural-time-series-for-causal-inference.html"><a href="bayesian-structural-time-series-for-causal-inference.html"><i class="fa fa-check"></i><b>8</b> Bayesian Structural Time Series for Causal Inference</a>
<ul>
<li class="chapter" data-level="8.1" data-path="bayesian-structural-time-series-for-causal-inference.html"><a href="bayesian-structural-time-series-for-causal-inference.html#introduction-6"><i class="fa fa-check"></i><b>8.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="bayesian-structural-time-series-for-causal-inference.html"><a href="bayesian-structural-time-series-for-causal-inference.html#theoretical-framework"><i class="fa fa-check"></i><b>8.1.1</b> Theoretical Framework</a></li>
<li class="chapter" data-level="8.1.2" data-path="bayesian-structural-time-series-for-causal-inference.html"><a href="bayesian-structural-time-series-for-causal-inference.html#control-variable-selection"><i class="fa fa-check"></i><b>8.1.2</b> Control Variable Selection</a></li>
<li class="chapter" data-level="8.1.3" data-path="bayesian-structural-time-series-for-causal-inference.html"><a href="bayesian-structural-time-series-for-causal-inference.html#healthcare-policy-evaluation-tobacco-tax-impact-analysis"><i class="fa fa-check"></i><b>8.1.3</b> Healthcare Policy Evaluation: Tobacco Tax Impact Analysis</a></li>
<li class="chapter" data-level="8.1.4" data-path="bayesian-structural-time-series-for-causal-inference.html"><a href="bayesian-structural-time-series-for-causal-inference.html#scenario-description"><i class="fa fa-check"></i><b>8.1.4</b> Scenario Description</a></li>
<li class="chapter" data-level="8.1.5" data-path="bayesian-structural-time-series-for-causal-inference.html"><a href="bayesian-structural-time-series-for-causal-inference.html#implementation-and-analysis"><i class="fa fa-check"></i><b>8.1.5</b> Implementation and Analysis</a></li>
<li class="chapter" data-level="8.1.6" data-path="bayesian-structural-time-series-for-causal-inference.html"><a href="bayesian-structural-time-series-for-causal-inference.html#example-2-mental-health-intervention-evaluation"><i class="fa fa-check"></i><b>8.1.6</b> Example 2: Mental Health Intervention Evaluation</a></li>
<li class="chapter" data-level="8.1.7" data-path="bayesian-structural-time-series-for-causal-inference.html"><a href="bayesian-structural-time-series-for-causal-inference.html#implementation-guidelines-for-healthcare-applications"><i class="fa fa-check"></i><b>8.1.7</b> Implementation Guidelines for Healthcare Applications</a></li>
<li class="chapter" data-level="8.1.8" data-path="bayesian-structural-time-series-for-causal-inference.html"><a href="bayesian-structural-time-series-for-causal-inference.html#limitations-and-considerations-1"><i class="fa fa-check"></i><b>8.1.8</b> Limitations and Considerations</a></li>
<li class="chapter" data-level="8.1.9" data-path="bayesian-structural-time-series-for-causal-inference.html"><a href="bayesian-structural-time-series-for-causal-inference.html#comparison-with-alternative-methods"><i class="fa fa-check"></i><b>8.1.9</b> Comparison with Alternative Methods</a></li>
<li class="chapter" data-level="8.1.10" data-path="bayesian-structural-time-series-for-causal-inference.html"><a href="bayesian-structural-time-series-for-causal-inference.html#conclusion-5"><i class="fa fa-check"></i><b>8.1.10</b> Conclusion</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Causal Inference in R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="causal-inference-in-practice-iii-difference-in-differences-with-a-healthcare-application" class="section level1 hasAnchor" number="4">
<h1><span class="header-section-number">Chapter 4</span> Causal Inference in Practice III: Difference-in-Differences with a Healthcare Application<a href="causal-inference-in-practice-iii-difference-in-differences-with-a-healthcare-application.html#causal-inference-in-practice-iii-difference-in-differences-with-a-healthcare-application" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="introduction-2" class="section level2 hasAnchor" number="4.1">
<h2><span class="header-section-number">4.1</span> Introduction<a href="causal-inference-in-practice-iii-difference-in-differences-with-a-healthcare-application.html#introduction-2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In observational studies, where randomized controlled trials are infeasible, causal inference methods like Difference-in-Differences (DiD) provide a robust framework for estimating treatment effects under specific assumptions. DiD is particularly valuable in settings with panel data, where units are observed over time, and some receive a treatment while others do not. By leveraging the temporal structure of data, DiD isolates the causal effect of a treatment by comparing changes in outcomes between treated and control groups over time. This approach is widely used in fields such as economics, public policy, and healthcare to evaluate interventions like policy changes or medical programs.</p>
<p>In this post, we focus on DiD, exploring its theoretical foundations, mathematical formalism, and practical implementation. We apply DiD to a realistic healthcare example—evaluating the impact of a telemedicine program on patient outcomes—using R code to demonstrate the methodology. We also discuss diagnostics, limitations, and extensions to ensure robust causal inference.</p>
</div>
<div id="difference-in-differences-theoretical-framework" class="section level2 hasAnchor" number="4.2">
<h2><span class="header-section-number">4.2</span> Difference-in-Differences: Theoretical Framework<a href="causal-inference-in-practice-iii-difference-in-differences-with-a-healthcare-application.html#difference-in-differences-theoretical-framework" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="core-concept" class="section level3 hasAnchor" number="4.2.1">
<h3><span class="header-section-number">4.2.1</span> Core Concept<a href="causal-inference-in-practice-iii-difference-in-differences-with-a-healthcare-application.html#core-concept" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>DiD estimates the causal effect of a treatment by comparing the change in outcomes over time between a treated group and a control group. The method assumes that, in the absence of treatment, the treated and control groups would follow <strong>parallel trends</strong> in their outcomes. This assumption allows DiD to account for time-invariant differences between groups and common time trends affecting both groups.</p>
</div>
<div id="mathematical-formalism" class="section level3 hasAnchor" number="4.2.2">
<h3><span class="header-section-number">4.2.2</span> Mathematical Formalism<a href="causal-inference-in-practice-iii-difference-in-differences-with-a-healthcare-application.html#mathematical-formalism" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Let’s formalize the DiD framework. For unit <span class="math inline">\(i\)</span> at time <span class="math inline">\(t \in \{0, 1\}\)</span> (pre- and post-treatment), define:</p>
<ul>
<li><span class="math inline">\(Y_{it}\)</span>: Observed outcome for unit <span class="math inline">\(i\)</span> at time <span class="math inline">\(t\)</span>.</li>
<li><span class="math inline">\(D_i \in \{0, 1\}\)</span>: Treatment indicator (<span class="math inline">\(D_i = 1\)</span> for treated units, <span class="math inline">\(D_i = 0\)</span> for control units).</li>
<li><span class="math inline">\(T_t \in \{0, 1\}\)</span>: Time indicator (<span class="math inline">\(T_t = 0\)</span> for pre-treatment, <span class="math inline">\(T_t = 1\)</span> for post-treatment).</li>
<li><span class="math inline">\(Y_{it}(1), Y_{it}(0)\)</span>: Potential outcomes under treatment and control, respectively.</li>
</ul>
<p>The causal effect of interest is the <strong>average treatment effect on the treated (ATT)</strong>:</p>
<p><span class="math display">\[
\text{ATT} = \mathbb{E}[Y_{i1}(1) - Y_{i1}(0) \mid D_i = 1]
\]</span></p>
<p>The DiD estimator assumes that the observed outcome can be modeled as:</p>
<p><span class="math display">\[
Y_{it} = \beta_0 + \beta_1 D_i + \beta_2 T_t + \delta (D_i \cdot T_t) + \epsilon_{it}
\]</span></p>
<p>Where:
- <span class="math inline">\(\beta_0\)</span>: Baseline outcome for the control group at <span class="math inline">\(t = 0\)</span>.
- <span class="math inline">\(\beta_1\)</span>: Time-invariant difference between treated and control groups.
- <span class="math inline">\(\beta_2\)</span>: Common time trend affecting both groups.
- <span class="math inline">\(\delta\)</span>: The DiD estimator, representing the ATT.
- <span class="math inline">\(\epsilon_{it}\)</span>: Error term, assumed to have mean zero.</p>
<p>The DiD estimator is computed as:</p>
<p><span class="math display">\[
\widehat{\text{DiD}} = \left( \bar{Y}_{1, \text{treated}} - \bar{Y}_{0, \text{treated}} \right) - \left( \bar{Y}_{1, \text{control}} - \bar{Y}_{0, \text{control}} \right)
\]</span></p>
<p>Where <span class="math inline">\(\bar{Y}_{t, g}\)</span> is the mean outcome for group <span class="math inline">\(g\)</span> (treated or control) at time <span class="math inline">\(t\)</span>.</p>
</div>
<div id="key-assumption-parallel-trends" class="section level3 hasAnchor" number="4.2.3">
<h3><span class="header-section-number">4.2.3</span> Key Assumption: Parallel Trends<a href="causal-inference-in-practice-iii-difference-in-differences-with-a-healthcare-application.html#key-assumption-parallel-trends" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The validity of DiD hinges on the <strong>parallel trends assumption</strong>:</p>
<p><span class="math display">\[
\mathbb{E}[Y_{i1}(0) - Y_{i0}(0) \mid D_i = 1] = \mathbb{E}[Y_{i1}(0) - Y_{i0}(0) \mid D_i = 0]
\]</span></p>
<p>This assumes that, absent treatment, the average change in outcomes for the treated group would equal that of the control group. While this assumption is untestable directly (since <span class="math inline">\(Y_{i1}(0)\)</span> is unobserved for the treated group post-treatment), we can assess its plausibility by examining pre-treatment trends or including covariates to adjust for potential confounders.</p>
</div>
<div id="practical-considerations" class="section level3 hasAnchor" number="4.2.4">
<h3><span class="header-section-number">4.2.4</span> Practical Considerations<a href="causal-inference-in-practice-iii-difference-in-differences-with-a-healthcare-application.html#practical-considerations" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li><strong>Data Requirements</strong>: DiD requires panel data (same units observed over time) or repeated cross-sectional data with clear treatment and control groups.</li>
<li><strong>Covariates</strong>: Including control variables unaffected by the treatment can improve precision and adjust for time-varying confounders.</li>
<li><strong>Diagnostics</strong>: Pre-treatment trends should be visualized to assess the parallel trends assumption. Robustness checks, such as placebo tests, can further validate the model.</li>
<li><strong>Extensions</strong>: DiD can be extended to multiple time periods, staggered treatment adoption, or heterogeneous effects using advanced methods like generalized DiD.</li>
</ul>
</div>
</div>
<div id="application-evaluating-a-telemedicine-program-in-healthcare" class="section level2 hasAnchor" number="4.3">
<h2><span class="header-section-number">4.3</span> Application: Evaluating a Telemedicine Program in Healthcare<a href="causal-inference-in-practice-iii-difference-in-differences-with-a-healthcare-application.html#application-evaluating-a-telemedicine-program-in-healthcare" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="scenario" class="section level3 hasAnchor" number="4.3.1">
<h3><span class="header-section-number">4.3.1</span> Scenario<a href="causal-inference-in-practice-iii-difference-in-differences-with-a-healthcare-application.html#scenario" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Consider a hospital system implementing a telemedicine program in 2024 to improve patient outcomes, such as reducing hospital readmissions for chronic disease patients. The program is rolled out in select clinics (treated group), while others continue standard in-person care (control group). We observe patient outcomes (e.g., 30-day readmission rates) in 2023 (pre-treatment) and 2025 (post-treatment). Using DiD, we estimate the program’s causal effect on readmissions.</p>
</div>
<div id="simulated-data" class="section level3 hasAnchor" number="4.3.2">
<h3><span class="header-section-number">4.3.2</span> Simulated Data<a href="causal-inference-in-practice-iii-difference-in-differences-with-a-healthcare-application.html#simulated-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We simulate data for 200 clinics (100 treated, 100 control) with readmission rates over two years. The true treatment effect is a 3% reduction in readmissions. We include a covariate (average patient age) to account for potential confounding.</p>
</div>
<div id="r-implementation-2" class="section level3 hasAnchor" number="4.3.3">
<h3><span class="header-section-number">4.3.3</span> R Implementation<a href="causal-inference-in-practice-iii-difference-in-differences-with-a-healthcare-application.html#r-implementation-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Below is the R code to simulate the data, estimate the DiD effect, and perform diagnostics.</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="causal-inference-in-practice-iii-difference-in-differences-with-a-healthcare-application.html#cb30-1" tabindex="-1"></a><span class="co"># Load required packages</span></span>
<span id="cb30-2"><a href="causal-inference-in-practice-iii-difference-in-differences-with-a-healthcare-application.html#cb30-2" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb30-3"><a href="causal-inference-in-practice-iii-difference-in-differences-with-a-healthcare-application.html#cb30-3" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb30-4"><a href="causal-inference-in-practice-iii-difference-in-differences-with-a-healthcare-application.html#cb30-4" tabindex="-1"></a></span>
<span id="cb30-5"><a href="causal-inference-in-practice-iii-difference-in-differences-with-a-healthcare-application.html#cb30-5" tabindex="-1"></a><span class="co"># Set seed for reproducibility</span></span>
<span id="cb30-6"><a href="causal-inference-in-practice-iii-difference-in-differences-with-a-healthcare-application.html#cb30-6" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb30-7"><a href="causal-inference-in-practice-iii-difference-in-differences-with-a-healthcare-application.html#cb30-7" tabindex="-1"></a></span>
<span id="cb30-8"><a href="causal-inference-in-practice-iii-difference-in-differences-with-a-healthcare-application.html#cb30-8" tabindex="-1"></a><span class="co"># Parameters</span></span>
<span id="cb30-9"><a href="causal-inference-in-practice-iii-difference-in-differences-with-a-healthcare-application.html#cb30-9" tabindex="-1"></a>n_clinics <span class="ot">&lt;-</span> <span class="dv">200</span>  <span class="co"># 100 treated, 100 control</span></span>
<span id="cb30-10"><a href="causal-inference-in-practice-iii-difference-in-differences-with-a-healthcare-application.html#cb30-10" tabindex="-1"></a>time_periods <span class="ot">&lt;-</span> <span class="dv">2</span>  <span class="co"># 2023 (pre), 2025 (post)</span></span>
<span id="cb30-11"><a href="causal-inference-in-practice-iii-difference-in-differences-with-a-healthcare-application.html#cb30-11" tabindex="-1"></a>true_effect <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">5</span>  <span class="co"># Increased effect size to -5% for stronger impact</span></span>
<span id="cb30-12"><a href="causal-inference-in-practice-iii-difference-in-differences-with-a-healthcare-application.html#cb30-12" tabindex="-1"></a>noise_sd <span class="ot">&lt;-</span> <span class="fl">0.5</span>    <span class="co"># Reduced noise to make effect more detectable</span></span>
<span id="cb30-13"><a href="causal-inference-in-practice-iii-difference-in-differences-with-a-healthcare-application.html#cb30-13" tabindex="-1"></a></span>
<span id="cb30-14"><a href="causal-inference-in-practice-iii-difference-in-differences-with-a-healthcare-application.html#cb30-14" tabindex="-1"></a><span class="co"># Create data</span></span>
<span id="cb30-15"><a href="causal-inference-in-practice-iii-difference-in-differences-with-a-healthcare-application.html#cb30-15" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb30-16"><a href="causal-inference-in-practice-iii-difference-in-differences-with-a-healthcare-application.html#cb30-16" tabindex="-1"></a>  <span class="at">clinic =</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span>n_clinics, <span class="at">each =</span> time_periods),</span>
<span id="cb30-17"><a href="causal-inference-in-practice-iii-difference-in-differences-with-a-healthcare-application.html#cb30-17" tabindex="-1"></a>  <span class="at">time =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">times =</span> n_clinics),  <span class="co"># 0 = 2023, 1 = 2025</span></span>
<span id="cb30-18"><a href="causal-inference-in-practice-iii-difference-in-differences-with-a-healthcare-application.html#cb30-18" tabindex="-1"></a>  <span class="at">year =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">2023</span>, <span class="dv">2025</span>), <span class="at">times =</span> n_clinics),</span>
<span id="cb30-19"><a href="causal-inference-in-practice-iii-difference-in-differences-with-a-healthcare-application.html#cb30-19" tabindex="-1"></a>  <span class="at">treated =</span> <span class="fu">rep</span>(<span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">each =</span> time_periods), <span class="at">times =</span> n_clinics<span class="sc">/</span><span class="dv">2</span>),</span>
<span id="cb30-20"><a href="causal-inference-in-practice-iii-difference-in-differences-with-a-healthcare-application.html#cb30-20" tabindex="-1"></a>  <span class="at">age =</span> <span class="fu">rep</span>(<span class="fu">rnorm</span>(n_clinics, <span class="at">mean =</span> <span class="dv">65</span>, <span class="at">sd =</span> <span class="dv">5</span>), <span class="at">each =</span> time_periods)</span>
<span id="cb30-21"><a href="causal-inference-in-practice-iii-difference-in-differences-with-a-healthcare-application.html#cb30-21" tabindex="-1"></a>)</span>
<span id="cb30-22"><a href="causal-inference-in-practice-iii-difference-in-differences-with-a-healthcare-application.html#cb30-22" tabindex="-1"></a></span>
<span id="cb30-23"><a href="causal-inference-in-practice-iii-difference-in-differences-with-a-healthcare-application.html#cb30-23" tabindex="-1"></a><span class="co"># Generate readmission rates (%)</span></span>
<span id="cb30-24"><a href="causal-inference-in-practice-iii-difference-in-differences-with-a-healthcare-application.html#cb30-24" tabindex="-1"></a>data<span class="sc">$</span>readmission <span class="ot">&lt;-</span> <span class="dv">20</span> <span class="sc">+</span>                   <span class="co"># Baseline readmission rate</span></span>
<span id="cb30-25"><a href="causal-inference-in-practice-iii-difference-in-differences-with-a-healthcare-application.html#cb30-25" tabindex="-1"></a>  <span class="dv">1</span> <span class="sc">*</span> data<span class="sc">$</span>treated <span class="sc">+</span>                      <span class="co"># Treated clinics have higher baseline</span></span>
<span id="cb30-26"><a href="causal-inference-in-practice-iii-difference-in-differences-with-a-healthcare-application.html#cb30-26" tabindex="-1"></a>  <span class="dv">2</span> <span class="sc">*</span> data<span class="sc">$</span>time <span class="sc">+</span>                         <span class="co"># Secular trend</span></span>
<span id="cb30-27"><a href="causal-inference-in-practice-iii-difference-in-differences-with-a-healthcare-application.html#cb30-27" tabindex="-1"></a>  true_effect <span class="sc">*</span> data<span class="sc">$</span>treated <span class="sc">*</span> data<span class="sc">$</span>time <span class="sc">+</span> <span class="co"># Stronger treatment effect</span></span>
<span id="cb30-28"><a href="causal-inference-in-practice-iii-difference-in-differences-with-a-healthcare-application.html#cb30-28" tabindex="-1"></a>  <span class="fl">0.1</span> <span class="sc">*</span> data<span class="sc">$</span>age <span class="sc">+</span>                        <span class="co"># Age effect</span></span>
<span id="cb30-29"><a href="causal-inference-in-practice-iii-difference-in-differences-with-a-healthcare-application.html#cb30-29" tabindex="-1"></a>  <span class="fu">rnorm</span>(<span class="fu">nrow</span>(data), <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> noise_sd)  <span class="co"># Reduced noise</span></span>
<span id="cb30-30"><a href="causal-inference-in-practice-iii-difference-in-differences-with-a-healthcare-application.html#cb30-30" tabindex="-1"></a></span>
<span id="cb30-31"><a href="causal-inference-in-practice-iii-difference-in-differences-with-a-healthcare-application.html#cb30-31" tabindex="-1"></a><span class="co"># Preview data</span></span>
<span id="cb30-32"><a href="causal-inference-in-practice-iii-difference-in-differences-with-a-healthcare-application.html#cb30-32" tabindex="-1"></a><span class="fu">head</span>(data)</span>
<span id="cb30-33"><a href="causal-inference-in-practice-iii-difference-in-differences-with-a-healthcare-application.html#cb30-33" tabindex="-1"></a></span>
<span id="cb30-34"><a href="causal-inference-in-practice-iii-difference-in-differences-with-a-healthcare-application.html#cb30-34" tabindex="-1"></a><span class="co"># Check parallel trends: Pre-treatment data (2021-2023)</span></span>
<span id="cb30-35"><a href="causal-inference-in-practice-iii-difference-in-differences-with-a-healthcare-application.html#cb30-35" tabindex="-1"></a>data_pre <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb30-36"><a href="causal-inference-in-practice-iii-difference-in-differences-with-a-healthcare-application.html#cb30-36" tabindex="-1"></a>  <span class="at">clinic =</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span>n_clinics, <span class="at">each =</span> <span class="dv">3</span>),</span>
<span id="cb30-37"><a href="causal-inference-in-practice-iii-difference-in-differences-with-a-healthcare-application.html#cb30-37" tabindex="-1"></a>  <span class="at">year =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">2021</span>, <span class="dv">2022</span>, <span class="dv">2023</span>), <span class="at">times =</span> n_clinics),</span>
<span id="cb30-38"><a href="causal-inference-in-practice-iii-difference-in-differences-with-a-healthcare-application.html#cb30-38" tabindex="-1"></a>  <span class="at">treated =</span> <span class="fu">rep</span>(<span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">each =</span> <span class="dv">3</span>), <span class="at">times =</span> n_clinics<span class="sc">/</span><span class="dv">2</span>),</span>
<span id="cb30-39"><a href="causal-inference-in-practice-iii-difference-in-differences-with-a-healthcare-application.html#cb30-39" tabindex="-1"></a>  <span class="at">readmission =</span> <span class="dv">20</span> <span class="sc">+</span> </span>
<span id="cb30-40"><a href="causal-inference-in-practice-iii-difference-in-differences-with-a-healthcare-application.html#cb30-40" tabindex="-1"></a>    <span class="dv">1</span> <span class="sc">*</span> <span class="fu">rep</span>(<span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">each =</span> <span class="dv">3</span>), <span class="at">times =</span> n_clinics<span class="sc">/</span><span class="dv">2</span>) <span class="sc">+</span>  <span class="co"># Group effect</span></span>
<span id="cb30-41"><a href="causal-inference-in-practice-iii-difference-in-differences-with-a-healthcare-application.html#cb30-41" tabindex="-1"></a>    <span class="dv">2</span> <span class="sc">*</span> <span class="fu">rep</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">2</span>, <span class="at">times =</span> n_clinics) <span class="sc">+</span>                      <span class="co"># Linear trend</span></span>
<span id="cb30-42"><a href="causal-inference-in-practice-iii-difference-in-differences-with-a-healthcare-application.html#cb30-42" tabindex="-1"></a>    <span class="fu">rnorm</span>(<span class="dv">3</span> <span class="sc">*</span> n_clinics, <span class="dv">0</span>, noise_sd)                      <span class="co"># Reduced noise</span></span>
<span id="cb30-43"><a href="causal-inference-in-practice-iii-difference-in-differences-with-a-healthcare-application.html#cb30-43" tabindex="-1"></a>)</span>
<span id="cb30-44"><a href="causal-inference-in-practice-iii-difference-in-differences-with-a-healthcare-application.html#cb30-44" tabindex="-1"></a></span>
<span id="cb30-45"><a href="causal-inference-in-practice-iii-difference-in-differences-with-a-healthcare-application.html#cb30-45" tabindex="-1"></a><span class="co"># Aggregate means for pre-treatment plot</span></span>
<span id="cb30-46"><a href="causal-inference-in-practice-iii-difference-in-differences-with-a-healthcare-application.html#cb30-46" tabindex="-1"></a>means_pre <span class="ot">&lt;-</span> data_pre <span class="sc">%&gt;%</span></span>
<span id="cb30-47"><a href="causal-inference-in-practice-iii-difference-in-differences-with-a-healthcare-application.html#cb30-47" tabindex="-1"></a>  <span class="fu">group_by</span>(year, treated) <span class="sc">%&gt;%</span></span>
<span id="cb30-48"><a href="causal-inference-in-practice-iii-difference-in-differences-with-a-healthcare-application.html#cb30-48" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">readmission =</span> <span class="fu">mean</span>(readmission), <span class="at">.groups =</span> <span class="st">&quot;drop&quot;</span>)</span>
<span id="cb30-49"><a href="causal-inference-in-practice-iii-difference-in-differences-with-a-healthcare-application.html#cb30-49" tabindex="-1"></a></span>
<span id="cb30-50"><a href="causal-inference-in-practice-iii-difference-in-differences-with-a-healthcare-application.html#cb30-50" tabindex="-1"></a><span class="co"># Plot pre-treatment trends</span></span>
<span id="cb30-51"><a href="causal-inference-in-practice-iii-difference-in-differences-with-a-healthcare-application.html#cb30-51" tabindex="-1"></a><span class="fu">ggplot</span>(means_pre, <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> readmission, <span class="at">color =</span> <span class="fu">factor</span>(treated), <span class="at">group =</span> treated)) <span class="sc">+</span></span>
<span id="cb30-52"><a href="causal-inference-in-practice-iii-difference-in-differences-with-a-healthcare-application.html#cb30-52" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb30-53"><a href="causal-inference-in-practice-iii-difference-in-differences-with-a-healthcare-application.html#cb30-53" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb30-54"><a href="causal-inference-in-practice-iii-difference-in-differences-with-a-healthcare-application.html#cb30-54" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Pre-Treatment Trends in Readmission Rates&quot;</span>,</span>
<span id="cb30-55"><a href="causal-inference-in-practice-iii-difference-in-differences-with-a-healthcare-application.html#cb30-55" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;Year&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Readmission Rate (%)&quot;</span>,</span>
<span id="cb30-56"><a href="causal-inference-in-practice-iii-difference-in-differences-with-a-healthcare-application.html#cb30-56" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">&quot;Group&quot;</span>) <span class="sc">+</span></span>
<span id="cb30-57"><a href="causal-inference-in-practice-iii-difference-in-differences-with-a-healthcare-application.html#cb30-57" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;blue&quot;</span>, <span class="st">&quot;red&quot;</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;Control&quot;</span>, <span class="st">&quot;Treated&quot;</span>)) <span class="sc">+</span></span>
<span id="cb30-58"><a href="causal-inference-in-practice-iii-difference-in-differences-with-a-healthcare-application.html#cb30-58" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb30-59"><a href="causal-inference-in-practice-iii-difference-in-differences-with-a-healthcare-application.html#cb30-59" tabindex="-1"></a></span>
<span id="cb30-60"><a href="causal-inference-in-practice-iii-difference-in-differences-with-a-healthcare-application.html#cb30-60" tabindex="-1"></a><span class="co"># Post-treatment trends for visualization</span></span>
<span id="cb30-61"><a href="causal-inference-in-practice-iii-difference-in-differences-with-a-healthcare-application.html#cb30-61" tabindex="-1"></a>means_post <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb30-62"><a href="causal-inference-in-practice-iii-difference-in-differences-with-a-healthcare-application.html#cb30-62" tabindex="-1"></a>  <span class="fu">group_by</span>(year, treated) <span class="sc">%&gt;%</span></span>
<span id="cb30-63"><a href="causal-inference-in-practice-iii-difference-in-differences-with-a-healthcare-application.html#cb30-63" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">readmission =</span> <span class="fu">mean</span>(readmission), <span class="at">.groups =</span> <span class="st">&quot;drop&quot;</span>)</span>
<span id="cb30-64"><a href="causal-inference-in-practice-iii-difference-in-differences-with-a-healthcare-application.html#cb30-64" tabindex="-1"></a></span>
<span id="cb30-65"><a href="causal-inference-in-practice-iii-difference-in-differences-with-a-healthcare-application.html#cb30-65" tabindex="-1"></a><span class="co"># Plot post-treatment trends to show diverging slopes</span></span>
<span id="cb30-66"><a href="causal-inference-in-practice-iii-difference-in-differences-with-a-healthcare-application.html#cb30-66" tabindex="-1"></a><span class="fu">ggplot</span>(means_post, <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> readmission, <span class="at">color =</span> <span class="fu">factor</span>(treated), <span class="at">group =</span> treated)) <span class="sc">+</span></span>
<span id="cb30-67"><a href="causal-inference-in-practice-iii-difference-in-differences-with-a-healthcare-application.html#cb30-67" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb30-68"><a href="causal-inference-in-practice-iii-difference-in-differences-with-a-healthcare-application.html#cb30-68" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb30-69"><a href="causal-inference-in-practice-iii-difference-in-differences-with-a-healthcare-application.html#cb30-69" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Post-Treatment Trends in Readmission Rates&quot;</span>,</span>
<span id="cb30-70"><a href="causal-inference-in-practice-iii-difference-in-differences-with-a-healthcare-application.html#cb30-70" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;Year&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Readmission Rate (%)&quot;</span>,</span>
<span id="cb30-71"><a href="causal-inference-in-practice-iii-difference-in-differences-with-a-healthcare-application.html#cb30-71" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">&quot;Group&quot;</span>) <span class="sc">+</span></span>
<span id="cb30-72"><a href="causal-inference-in-practice-iii-difference-in-differences-with-a-healthcare-application.html#cb30-72" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;blue&quot;</span>, <span class="st">&quot;red&quot;</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;Control&quot;</span>, <span class="st">&quot;Treated&quot;</span>)) <span class="sc">+</span></span>
<span id="cb30-73"><a href="causal-inference-in-practice-iii-difference-in-differences-with-a-healthcare-application.html#cb30-73" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb30-74"><a href="causal-inference-in-practice-iii-difference-in-differences-with-a-healthcare-application.html#cb30-74" tabindex="-1"></a></span>
<span id="cb30-75"><a href="causal-inference-in-practice-iii-difference-in-differences-with-a-healthcare-application.html#cb30-75" tabindex="-1"></a><span class="co"># DiD regression with covariate</span></span>
<span id="cb30-76"><a href="causal-inference-in-practice-iii-difference-in-differences-with-a-healthcare-application.html#cb30-76" tabindex="-1"></a>did_model <span class="ot">&lt;-</span> <span class="fu">lm</span>(readmission <span class="sc">~</span> treated <span class="sc">+</span> time <span class="sc">+</span> treated<span class="sc">:</span>time <span class="sc">+</span> age, <span class="at">data =</span> data)</span>
<span id="cb30-77"><a href="causal-inference-in-practice-iii-difference-in-differences-with-a-healthcare-application.html#cb30-77" tabindex="-1"></a></span>
<span id="cb30-78"><a href="causal-inference-in-practice-iii-difference-in-differences-with-a-healthcare-application.html#cb30-78" tabindex="-1"></a><span class="co"># Summary of results</span></span>
<span id="cb30-79"><a href="causal-inference-in-practice-iii-difference-in-differences-with-a-healthcare-application.html#cb30-79" tabindex="-1"></a><span class="fu">summary</span>(did_model)</span>
<span id="cb30-80"><a href="causal-inference-in-practice-iii-difference-in-differences-with-a-healthcare-application.html#cb30-80" tabindex="-1"></a></span>
<span id="cb30-81"><a href="causal-inference-in-practice-iii-difference-in-differences-with-a-healthcare-application.html#cb30-81" tabindex="-1"></a><span class="co"># Manual DiD calculation</span></span>
<span id="cb30-82"><a href="causal-inference-in-practice-iii-difference-in-differences-with-a-healthcare-application.html#cb30-82" tabindex="-1"></a>means <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb30-83"><a href="causal-inference-in-practice-iii-difference-in-differences-with-a-healthcare-application.html#cb30-83" tabindex="-1"></a>  <span class="fu">group_by</span>(treated, time) <span class="sc">%&gt;%</span></span>
<span id="cb30-84"><a href="causal-inference-in-practice-iii-difference-in-differences-with-a-healthcare-application.html#cb30-84" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">readmission =</span> <span class="fu">mean</span>(readmission), <span class="at">.groups =</span> <span class="st">&quot;drop&quot;</span>)</span>
<span id="cb30-85"><a href="causal-inference-in-practice-iii-difference-in-differences-with-a-healthcare-application.html#cb30-85" tabindex="-1"></a></span>
<span id="cb30-86"><a href="causal-inference-in-practice-iii-difference-in-differences-with-a-healthcare-application.html#cb30-86" tabindex="-1"></a>y0_control <span class="ot">&lt;-</span> means<span class="sc">$</span>readmission[means<span class="sc">$</span>treated <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> means<span class="sc">$</span>time <span class="sc">==</span> <span class="dv">0</span>]</span>
<span id="cb30-87"><a href="causal-inference-in-practice-iii-difference-in-differences-with-a-healthcare-application.html#cb30-87" tabindex="-1"></a>y1_control <span class="ot">&lt;-</span> means<span class="sc">$</span>readmission[means<span class="sc">$</span>treated <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> means<span class="sc">$</span>time <span class="sc">==</span> <span class="dv">1</span>]</span>
<span id="cb30-88"><a href="causal-inference-in-practice-iii-difference-in-differences-with-a-healthcare-application.html#cb30-88" tabindex="-1"></a>y0_treated <span class="ot">&lt;-</span> means<span class="sc">$</span>readmission[means<span class="sc">$</span>treated <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> means<span class="sc">$</span>time <span class="sc">==</span> <span class="dv">0</span>]</span>
<span id="cb30-89"><a href="causal-inference-in-practice-iii-difference-in-differences-with-a-healthcare-application.html#cb30-89" tabindex="-1"></a>y1_treated <span class="ot">&lt;-</span> means<span class="sc">$</span>readmission[means<span class="sc">$</span>treated <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> means<span class="sc">$</span>time <span class="sc">==</span> <span class="dv">1</span>]</span>
<span id="cb30-90"><a href="causal-inference-in-practice-iii-difference-in-differences-with-a-healthcare-application.html#cb30-90" tabindex="-1"></a></span>
<span id="cb30-91"><a href="causal-inference-in-practice-iii-difference-in-differences-with-a-healthcare-application.html#cb30-91" tabindex="-1"></a>did_estimate <span class="ot">&lt;-</span> (y1_treated <span class="sc">-</span> y0_treated) <span class="sc">-</span> (y1_control <span class="sc">-</span> y0_control)</span>
<span id="cb30-92"><a href="causal-inference-in-practice-iii-difference-in-differences-with-a-healthcare-application.html#cb30-92" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;DiD Estimate:&quot;</span>, did_estimate, <span class="st">&quot;%</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb30-93"><a href="causal-inference-in-practice-iii-difference-in-differences-with-a-healthcare-application.html#cb30-93" tabindex="-1"></a></span>
<span id="cb30-94"><a href="causal-inference-in-practice-iii-difference-in-differences-with-a-healthcare-application.html#cb30-94" tabindex="-1"></a><span class="co"># Placebo test: Pre-treatment periods (2022 vs. 2023)</span></span>
<span id="cb30-95"><a href="causal-inference-in-practice-iii-difference-in-differences-with-a-healthcare-application.html#cb30-95" tabindex="-1"></a>data_placebo <span class="ot">&lt;-</span> data_pre[data_pre<span class="sc">$</span>year <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">2022</span>, <span class="dv">2023</span>), ]</span>
<span id="cb30-96"><a href="causal-inference-in-practice-iii-difference-in-differences-with-a-healthcare-application.html#cb30-96" tabindex="-1"></a>did_placebo <span class="ot">&lt;-</span> <span class="fu">lm</span>(readmission <span class="sc">~</span> treated <span class="sc">*</span> <span class="fu">factor</span>(year), <span class="at">data =</span> data_placebo)</span>
<span id="cb30-97"><a href="causal-inference-in-practice-iii-difference-in-differences-with-a-healthcare-application.html#cb30-97" tabindex="-1"></a><span class="fu">summary</span>(did_placebo)</span></code></pre></div>
</div>
<div id="interpretation" class="section level3 hasAnchor" number="4.3.4">
<h3><span class="header-section-number">4.3.4</span> Interpretation<a href="causal-inference-in-practice-iii-difference-in-differences-with-a-healthcare-application.html#interpretation" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li><strong>Pre-Treatment Trends</strong>: The plot checks if readmission rates for treated and control clinics followed parallel trends before 2023, supporting the parallel trends assumption.</li>
<li><strong>DiD Estimate</strong>: The regression coefficient on the interaction term (<span class="math inline">\(\text{treated} \cdot \text{time}\)</span>) estimates the treatment effect, adjusted for patient age. The manual calculation confirms this estimate.</li>
<li><strong>Placebo Test</strong>: Applying DiD to pre-treatment years (2022 vs. 2023) should yield an insignificant effect, reinforcing the validity of the parallel trends assumption.</li>
</ul>
<p>In our simulation, the estimated effect is close to the true effect (-3%), indicating that the telemedicine program reduced readmissions by approximately 3 percentage points.</p>
</div>
</div>
<div id="limitations-and-extensions" class="section level2 hasAnchor" number="4.4">
<h2><span class="header-section-number">4.4</span> Limitations and Extensions<a href="causal-inference-in-practice-iii-difference-in-differences-with-a-healthcare-application.html#limitations-and-extensions" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li><strong>Parallel Trends Violation</strong>: If pre-treatment trends diverge, DiD estimates may be biased. Techniques like synthetic controls or triple differences can address this.</li>
<li><strong>Time-Varying Confounders</strong>: Unobserved factors changing differentially between groups (e.g., new healthcare policies) can bias results. Including relevant covariates mitigates this.</li>
<li><strong>Generalizability</strong>: The ATT applies to the treated group. Generalizing to other populations requires caution.</li>
<li><strong>Extensions</strong>: For staggered treatment timing or multiple periods, generalized DiD models or fixed-effects regressions can be used.</li>
</ul>
</div>
<div id="conclusion-2" class="section level2 hasAnchor" number="4.5">
<h2><span class="header-section-number">4.5</span> Conclusion<a href="causal-inference-in-practice-iii-difference-in-differences-with-a-healthcare-application.html#conclusion-2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Difference-in-Differences is a powerful quasi-experimental method for causal inference, particularly in healthcare settings where randomized trials are impractical. By leveraging panel data and the parallel trends assumption, DiD isolates treatment effects with intuitive appeal. Our healthcare example demonstrated how DiD can evaluate a telemedicine program’s impact on readmissions, with R code providing a practical implementation. Diagnostics like pre-treatment trend checks and placebo tests enhance robustness. In future posts, we’ll explore advanced methods like Regression Discontinuity and Synthetic Controls to further expand the causal inference toolkit.</p>
</div>
<div id="references-2" class="section level2 hasAnchor" number="4.6">
<h2><span class="header-section-number">4.6</span> References<a href="causal-inference-in-practice-iii-difference-in-differences-with-a-healthcare-application.html#references-2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li>Angrist, J. D., &amp; Pischke, J.-S. (2009). <em>Mostly Harmless Econometrics</em>. Princeton University Press.</li>
<li>Abadie, A. (2005). Semiparametric difference-in-differences estimators. <em>Review of Economic Studies</em>, 72(1), 1–19.</li>
<li>Hernán, M. A., &amp; Robins, J. M. (2020). <em>Causal Inference: What If</em>. Chapman &amp; Hall/CRC.</li>
<li>Wooldridge, J. M. (2010). <em>Econometric Analysis of Cross Section and Panel Data</em>. MIT Press.</li>
</ul>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="causal-inference-in-practice-ii-propensity-scores-doubly-robust-estimators-and-inverse-probability-weighting.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="causal-inference-in-practice-iv-instrumental-variables.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
  "sharing": {
    "github": false,
    "facebook": true,
    "twitter": true,
    "linkedin": false,
    "weibo": false,
    "instapaper": false,
    "vk": false,
    "whatsapp": false,
    "all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
  },
  "fontsettings": {
    "theme": "white",
    "family": "sans",
    "size": 2
  },
  "edit": {
    "link": "https://github.com/Kamran-Afzali/Bookdown_Causality/edit/main/04-DID.Rmd",
    "text": "Edit"
  },
  "history": {
    "link": null,
    "text": null
  },
  "view": {
    "link": "https://github.com/Kamran-Afzali/Bookdown_Causality/blob/main/04-DID.Rmd",
    "text": null
  },
  "download": null,
  "search": {
    "engine": "fuse",
    "options": null
  },
  "toc": {
    "collapse": "subsection"
  }
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
