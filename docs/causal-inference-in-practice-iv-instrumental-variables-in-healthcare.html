<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 5 Causal Inference in Practice IV: Instrumental Variables in Healthcare | Causal Inference in R</title>
  <meta name="description" content="Chapter 5 Causal Inference in Practice IV: Instrumental Variables in Healthcare | Causal Inference in R" />
  <meta name="generator" content="bookdown 0.43 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 5 Causal Inference in Practice IV: Instrumental Variables in Healthcare | Causal Inference in R" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 5 Causal Inference in Practice IV: Instrumental Variables in Healthcare | Causal Inference in R" />
  
  
  

<meta name="author" content="Kamran Afzali" />


<meta name="date" content="2025-07-22" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="causal-inference-in-practice-iii-difference-in-differences-with-a-healthcare-application.html"/>

<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Causality analysis in R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Foundations of Causal Statistical Analysis</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#introduction"><i class="fa fa-check"></i><b>1.1</b> Introduction</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#summary-table-techniques-for-causal-statistical-analysis"><i class="fa fa-check"></i><b>1.2</b> Summary Table: Techniques for Causal Statistical Analysis</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#methodological-deep-dive-with-practical-guidance"><i class="fa fa-check"></i><b>1.3</b> Methodological Deep Dive with Practical Guidance</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#discussion"><i class="fa fa-check"></i><b>1.4</b> Discussion</a></li>
<li class="chapter" data-level="1.5" data-path="index.html"><a href="index.html#references"><i class="fa fa-check"></i><b>1.5</b> References</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="causal-inference-in-practice-i-randomized-controlled-trials-and-regression-adjustment.html"><a href="causal-inference-in-practice-i-randomized-controlled-trials-and-regression-adjustment.html"><i class="fa fa-check"></i><b>2</b> Causal Inference in Practice I: Randomized Controlled Trials and Regression Adjustment</a>
<ul>
<li class="chapter" data-level="2.1" data-path="causal-inference-in-practice-i-randomized-controlled-trials-and-regression-adjustment.html"><a href="causal-inference-in-practice-i-randomized-controlled-trials-and-regression-adjustment.html#introduction-1"><i class="fa fa-check"></i><b>2.1</b> Introduction</a></li>
<li class="chapter" data-level="2.2" data-path="causal-inference-in-practice-i-randomized-controlled-trials-and-regression-adjustment.html"><a href="causal-inference-in-practice-i-randomized-controlled-trials-and-regression-adjustment.html#randomized-controlled-trials-design-and-analysis"><i class="fa fa-check"></i><b>2.2</b> 1. Randomized Controlled Trials: Design and Analysis</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="causal-inference-in-practice-i-randomized-controlled-trials-and-regression-adjustment.html"><a href="causal-inference-in-practice-i-randomized-controlled-trials-and-regression-adjustment.html#theoretical-foundations"><i class="fa fa-check"></i><b>2.2.1</b> Theoretical Foundations</a></li>
<li class="chapter" data-level="2.2.2" data-path="causal-inference-in-practice-i-randomized-controlled-trials-and-regression-adjustment.html"><a href="causal-inference-in-practice-i-randomized-controlled-trials-and-regression-adjustment.html#r-implementation"><i class="fa fa-check"></i><b>2.2.2</b> R Implementation</a></li>
<li class="chapter" data-level="2.2.3" data-path="causal-inference-in-practice-i-randomized-controlled-trials-and-regression-adjustment.html"><a href="causal-inference-in-practice-i-randomized-controlled-trials-and-regression-adjustment.html#model-based-inference"><i class="fa fa-check"></i><b>2.2.3</b> Model-Based Inference</a></li>
<li class="chapter" data-level="2.2.4" data-path="causal-inference-in-practice-i-randomized-controlled-trials-and-regression-adjustment.html"><a href="causal-inference-in-practice-i-randomized-controlled-trials-and-regression-adjustment.html#diagnostics-and-integrity"><i class="fa fa-check"></i><b>2.2.4</b> Diagnostics and Integrity</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="causal-inference-in-practice-i-randomized-controlled-trials-and-regression-adjustment.html"><a href="causal-inference-in-practice-i-randomized-controlled-trials-and-regression-adjustment.html#regression-adjustment-a-model-based-approach-to-causal-inference"><i class="fa fa-check"></i><b>2.3</b> 2. Regression Adjustment: A Model-Based Approach to Causal Inference</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="causal-inference-in-practice-i-randomized-controlled-trials-and-regression-adjustment.html"><a href="causal-inference-in-practice-i-randomized-controlled-trials-and-regression-adjustment.html#conceptual-overview"><i class="fa fa-check"></i><b>2.3.1</b> Conceptual Overview</a></li>
<li class="chapter" data-level="2.3.2" data-path="causal-inference-in-practice-i-randomized-controlled-trials-and-regression-adjustment.html"><a href="causal-inference-in-practice-i-randomized-controlled-trials-and-regression-adjustment.html#r-implementation-1"><i class="fa fa-check"></i><b>2.3.2</b> R Implementation</a></li>
<li class="chapter" data-level="2.3.3" data-path="causal-inference-in-practice-i-randomized-controlled-trials-and-regression-adjustment.html"><a href="causal-inference-in-practice-i-randomized-controlled-trials-and-regression-adjustment.html#limitations-and-diagnostics"><i class="fa fa-check"></i><b>2.3.3</b> Limitations and Diagnostics</a></li>
<li class="chapter" data-level="2.3.4" data-path="causal-inference-in-practice-i-randomized-controlled-trials-and-regression-adjustment.html"><a href="causal-inference-in-practice-i-randomized-controlled-trials-and-regression-adjustment.html#causal-interpretation"><i class="fa fa-check"></i><b>2.3.4</b> Causal Interpretation</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="causal-inference-in-practice-i-randomized-controlled-trials-and-regression-adjustment.html"><a href="causal-inference-in-practice-i-randomized-controlled-trials-and-regression-adjustment.html#toward-integrated-reasoning"><i class="fa fa-check"></i><b>2.4</b> Toward Integrated Reasoning</a></li>
<li class="chapter" data-level="2.5" data-path="causal-inference-in-practice-i-randomized-controlled-trials-and-regression-adjustment.html"><a href="causal-inference-in-practice-i-randomized-controlled-trials-and-regression-adjustment.html#conclusion"><i class="fa fa-check"></i><b>2.5</b> Conclusion</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="causal-inference-in-practice-ii-propensity-scores-doubly-robust-estimators-and-inverse-probability-weighting.html"><a href="causal-inference-in-practice-ii-propensity-scores-doubly-robust-estimators-and-inverse-probability-weighting.html"><i class="fa fa-check"></i><b>3</b> Causal Inference in Practice II: Propensity Scores, Doubly Robust Estimators, and Inverse Probability Weighting</a>
<ul>
<li class="chapter" data-level="3.1" data-path="causal-inference-in-practice-ii-propensity-scores-doubly-robust-estimators-and-inverse-probability-weighting.html"><a href="causal-inference-in-practice-ii-propensity-scores-doubly-robust-estimators-and-inverse-probability-weighting.html#propensity-score-methods"><i class="fa fa-check"></i><b>3.1</b> Propensity Score Methods</a></li>
<li class="chapter" data-level="3.2" data-path="causal-inference-in-practice-ii-propensity-scores-doubly-robust-estimators-and-inverse-probability-weighting.html"><a href="causal-inference-in-practice-ii-propensity-scores-doubly-robust-estimators-and-inverse-probability-weighting.html#inverse-probability-weighting-ipw"><i class="fa fa-check"></i><b>3.2</b> Inverse Probability Weighting (IPW)</a></li>
<li class="chapter" data-level="3.3" data-path="causal-inference-in-practice-ii-propensity-scores-doubly-robust-estimators-and-inverse-probability-weighting.html"><a href="causal-inference-in-practice-ii-propensity-scores-doubly-robust-estimators-and-inverse-probability-weighting.html#doubly-robust-estimators"><i class="fa fa-check"></i><b>3.3</b> Doubly Robust Estimators</a></li>
<li class="chapter" data-level="3.4" data-path="causal-inference-in-practice-ii-propensity-scores-doubly-robust-estimators-and-inverse-probability-weighting.html"><a href="causal-inference-in-practice-ii-propensity-scores-doubly-robust-estimators-and-inverse-probability-weighting.html#integrative-interpretation"><i class="fa fa-check"></i><b>3.4</b> Integrative Interpretation</a></li>
<li class="chapter" data-level="3.5" data-path="causal-inference-in-practice-ii-propensity-scores-doubly-robust-estimators-and-inverse-probability-weighting.html"><a href="causal-inference-in-practice-ii-propensity-scores-doubly-robust-estimators-and-inverse-probability-weighting.html#summary-table"><i class="fa fa-check"></i><b>3.5</b> Summary Table</a></li>
<li class="chapter" data-level="3.6" data-path="causal-inference-in-practice-ii-propensity-scores-doubly-robust-estimators-and-inverse-probability-weighting.html"><a href="causal-inference-in-practice-ii-propensity-scores-doubly-robust-estimators-and-inverse-probability-weighting.html#conclusion-1"><i class="fa fa-check"></i><b>3.6</b> Conclusion</a></li>
<li class="chapter" data-level="3.7" data-path="causal-inference-in-practice-ii-propensity-scores-doubly-robust-estimators-and-inverse-probability-weighting.html"><a href="causal-inference-in-practice-ii-propensity-scores-doubly-robust-estimators-and-inverse-probability-weighting.html#references-1"><i class="fa fa-check"></i><b>3.7</b> References</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="causal-inference-in-practice-iii-difference-in-differences-with-a-healthcare-application.html"><a href="causal-inference-in-practice-iii-difference-in-differences-with-a-healthcare-application.html"><i class="fa fa-check"></i><b>4</b> Causal Inference in Practice III: Difference-in-Differences with a Healthcare Application</a>
<ul>
<li class="chapter" data-level="4.1" data-path="causal-inference-in-practice-iii-difference-in-differences-with-a-healthcare-application.html"><a href="causal-inference-in-practice-iii-difference-in-differences-with-a-healthcare-application.html#introduction-2"><i class="fa fa-check"></i><b>4.1</b> Introduction</a></li>
<li class="chapter" data-level="4.2" data-path="causal-inference-in-practice-iii-difference-in-differences-with-a-healthcare-application.html"><a href="causal-inference-in-practice-iii-difference-in-differences-with-a-healthcare-application.html#difference-in-differences-theoretical-framework"><i class="fa fa-check"></i><b>4.2</b> Difference-in-Differences: Theoretical Framework</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="causal-inference-in-practice-iii-difference-in-differences-with-a-healthcare-application.html"><a href="causal-inference-in-practice-iii-difference-in-differences-with-a-healthcare-application.html#core-concept"><i class="fa fa-check"></i><b>4.2.1</b> Core Concept</a></li>
<li class="chapter" data-level="4.2.2" data-path="causal-inference-in-practice-iii-difference-in-differences-with-a-healthcare-application.html"><a href="causal-inference-in-practice-iii-difference-in-differences-with-a-healthcare-application.html#mathematical-formalism"><i class="fa fa-check"></i><b>4.2.2</b> Mathematical Formalism</a></li>
<li class="chapter" data-level="4.2.3" data-path="causal-inference-in-practice-iii-difference-in-differences-with-a-healthcare-application.html"><a href="causal-inference-in-practice-iii-difference-in-differences-with-a-healthcare-application.html#key-assumption-parallel-trends"><i class="fa fa-check"></i><b>4.2.3</b> Key Assumption: Parallel Trends</a></li>
<li class="chapter" data-level="4.2.4" data-path="causal-inference-in-practice-iii-difference-in-differences-with-a-healthcare-application.html"><a href="causal-inference-in-practice-iii-difference-in-differences-with-a-healthcare-application.html#practical-considerations"><i class="fa fa-check"></i><b>4.2.4</b> Practical Considerations</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="causal-inference-in-practice-iii-difference-in-differences-with-a-healthcare-application.html"><a href="causal-inference-in-practice-iii-difference-in-differences-with-a-healthcare-application.html#application-evaluating-a-telemedicine-program-in-healthcare"><i class="fa fa-check"></i><b>4.3</b> Application: Evaluating a Telemedicine Program in Healthcare</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="causal-inference-in-practice-iii-difference-in-differences-with-a-healthcare-application.html"><a href="causal-inference-in-practice-iii-difference-in-differences-with-a-healthcare-application.html#scenario"><i class="fa fa-check"></i><b>4.3.1</b> Scenario</a></li>
<li class="chapter" data-level="4.3.2" data-path="causal-inference-in-practice-iii-difference-in-differences-with-a-healthcare-application.html"><a href="causal-inference-in-practice-iii-difference-in-differences-with-a-healthcare-application.html#simulated-data"><i class="fa fa-check"></i><b>4.3.2</b> Simulated Data</a></li>
<li class="chapter" data-level="4.3.3" data-path="causal-inference-in-practice-iii-difference-in-differences-with-a-healthcare-application.html"><a href="causal-inference-in-practice-iii-difference-in-differences-with-a-healthcare-application.html#r-implementation-2"><i class="fa fa-check"></i><b>4.3.3</b> R Implementation</a></li>
<li class="chapter" data-level="4.3.4" data-path="causal-inference-in-practice-iii-difference-in-differences-with-a-healthcare-application.html"><a href="causal-inference-in-practice-iii-difference-in-differences-with-a-healthcare-application.html#interpretation"><i class="fa fa-check"></i><b>4.3.4</b> Interpretation</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="causal-inference-in-practice-iii-difference-in-differences-with-a-healthcare-application.html"><a href="causal-inference-in-practice-iii-difference-in-differences-with-a-healthcare-application.html#limitations-and-extensions"><i class="fa fa-check"></i><b>4.4</b> Limitations and Extensions</a></li>
<li class="chapter" data-level="4.5" data-path="causal-inference-in-practice-iii-difference-in-differences-with-a-healthcare-application.html"><a href="causal-inference-in-practice-iii-difference-in-differences-with-a-healthcare-application.html#conclusion-2"><i class="fa fa-check"></i><b>4.5</b> Conclusion</a></li>
<li class="chapter" data-level="4.6" data-path="causal-inference-in-practice-iii-difference-in-differences-with-a-healthcare-application.html"><a href="causal-inference-in-practice-iii-difference-in-differences-with-a-healthcare-application.html#references-2"><i class="fa fa-check"></i><b>4.6</b> References</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="causal-inference-in-practice-iv-instrumental-variables-in-healthcare.html"><a href="causal-inference-in-practice-iv-instrumental-variables-in-healthcare.html"><i class="fa fa-check"></i><b>5</b> Causal Inference in Practice IV: Instrumental Variables in Healthcare</a>
<ul>
<li class="chapter" data-level="5.1" data-path="causal-inference-in-practice-iv-instrumental-variables-in-healthcare.html"><a href="causal-inference-in-practice-iv-instrumental-variables-in-healthcare.html#introduction-3"><i class="fa fa-check"></i><b>5.1</b> Introduction</a></li>
<li class="chapter" data-level="5.2" data-path="causal-inference-in-practice-iv-instrumental-variables-in-healthcare.html"><a href="causal-inference-in-practice-iv-instrumental-variables-in-healthcare.html#theoretical-framework"><i class="fa fa-check"></i><b>5.2</b> Theoretical Framework</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="causal-inference-in-practice-iv-instrumental-variables-in-healthcare.html"><a href="causal-inference-in-practice-iv-instrumental-variables-in-healthcare.html#motivation-and-identification"><i class="fa fa-check"></i><b>5.2.1</b> Motivation and Identification</a></li>
<li class="chapter" data-level="5.2.2" data-path="causal-inference-in-practice-iv-instrumental-variables-in-healthcare.html"><a href="causal-inference-in-practice-iv-instrumental-variables-in-healthcare.html#estimation"><i class="fa fa-check"></i><b>5.2.2</b> Estimation</a></li>
<li class="chapter" data-level="5.2.3" data-path="causal-inference-in-practice-iv-instrumental-variables-in-healthcare.html"><a href="causal-inference-in-practice-iv-instrumental-variables-in-healthcare.html#comparison-with-other-methods"><i class="fa fa-check"></i><b>5.2.3</b> Comparison with Other Methods</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="causal-inference-in-practice-iv-instrumental-variables-in-healthcare.html"><a href="causal-inference-in-practice-iv-instrumental-variables-in-healthcare.html#healthcare-application-hospital-quality-and-recovery-time"><i class="fa fa-check"></i><b>5.3</b> Healthcare Application: Hospital Quality and Recovery Time</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="causal-inference-in-practice-iv-instrumental-variables-in-healthcare.html"><a href="causal-inference-in-practice-iv-instrumental-variables-in-healthcare.html#scenario-1"><i class="fa fa-check"></i><b>5.3.1</b> Scenario</a></li>
<li class="chapter" data-level="5.3.2" data-path="causal-inference-in-practice-iv-instrumental-variables-in-healthcare.html"><a href="causal-inference-in-practice-iv-instrumental-variables-in-healthcare.html#assumptions"><i class="fa fa-check"></i><b>5.3.2</b> Assumptions</a></li>
<li class="chapter" data-level="5.3.3" data-path="causal-inference-in-practice-iv-instrumental-variables-in-healthcare.html"><a href="causal-inference-in-practice-iv-instrumental-variables-in-healthcare.html#r-implementation-3"><i class="fa fa-check"></i><b>5.3.3</b> R Implementation</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="causal-inference-in-practice-iv-instrumental-variables-in-healthcare.html"><a href="causal-inference-in-practice-iv-instrumental-variables-in-healthcare.html#interpretation-1"><i class="fa fa-check"></i><b>5.4</b> Interpretation</a></li>
<li class="chapter" data-level="5.5" data-path="causal-inference-in-practice-iv-instrumental-variables-in-healthcare.html"><a href="causal-inference-in-practice-iv-instrumental-variables-in-healthcare.html#limitations"><i class="fa fa-check"></i><b>5.5</b> Limitations</a></li>
<li class="chapter" data-level="5.6" data-path="causal-inference-in-practice-iv-instrumental-variables-in-healthcare.html"><a href="causal-inference-in-practice-iv-instrumental-variables-in-healthcare.html#conclusion-3"><i class="fa fa-check"></i><b>5.6</b> Conclusion</a></li>
<li class="chapter" data-level="5.7" data-path="causal-inference-in-practice-iv-instrumental-variables-in-healthcare.html"><a href="causal-inference-in-practice-iv-instrumental-variables-in-healthcare.html#references-3"><i class="fa fa-check"></i><b>5.7</b> References</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Causal Inference in R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="causal-inference-in-practice-iv-instrumental-variables-in-healthcare" class="section level1 hasAnchor" number="5">
<h1><span class="header-section-number">Chapter 5</span> Causal Inference in Practice IV: Instrumental Variables in Healthcare<a href="causal-inference-in-practice-iv-instrumental-variables-in-healthcare.html#causal-inference-in-practice-iv-instrumental-variables-in-healthcare" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="introduction-3" class="section level2 hasAnchor" number="5.1">
<h2><span class="header-section-number">5.1</span> Introduction<a href="causal-inference-in-practice-iv-instrumental-variables-in-healthcare.html#introduction-3" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Establishing causal relationships in observational studies is challenging due to confounding, where unobserved factors influence both treatment assignment and outcomes, leading to biased estimates. While methods like propensity score matching or Difference-in-Differences address specific confounding scenarios, they often rely on strong assumptions, such as conditional ignorability or parallel trends, which may not hold when key confounders are unmeasured. Instrumental Variables (IV) estimation offers a robust alternative by leveraging exogenous variation to estimate causal effects, even in the presence of unobserved confounding, making it particularly valuable in settings like healthcare where randomized trials may be infeasible or unethical.</p>
<p>This essay explores the IV method, detailing its theoretical framework, mathematical formalism, and practical application in a healthcare context—estimating the causal effect of hospital quality on patient recovery time. Using simulated data, we implement IV estimation in R, verify key assumptions, and compare results with naive approaches. We also discuss the method’s strengths, limitations, and contrasts with other causal inference techniques, providing a clear and practical guide for researchers.</p>
</div>
<div id="theoretical-framework" class="section level2 hasAnchor" number="5.2">
<h2><span class="header-section-number">5.2</span> Theoretical Framework<a href="causal-inference-in-practice-iv-instrumental-variables-in-healthcare.html#theoretical-framework" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="motivation-and-identification" class="section level3 hasAnchor" number="5.2.1">
<h3><span class="header-section-number">5.2.1</span> Motivation and Identification<a href="causal-inference-in-practice-iv-instrumental-variables-in-healthcare.html#motivation-and-identification" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In observational data studies, unmeasured confounding violates the conditional ignorability assumption, i.e., $Y(1), Y(0) D X$, where $Y(1)$ and $Y(0)$ are potential outcomes under treatment ($D = 1$) and control ($D = 0$), and $X$ represents observed covariates. IV methods address this by using an instrument $Z$, a variable that induces variation in the treatment $D$ but affects the outcome $Y$ only through $D$. A valid instrument must satisfy three conditions:</p>
<ol style="list-style-type: decimal">
<li><strong>Relevance</strong>: The instrument must be correlated with the treatment, formally $(Z, D) $.</li>
<li><strong>Exclusion Restriction</strong>: The instrument affects the outcome only through the treatment, i.e., $Y = f(D, X, )$, with $Z f$.</li>
<li><strong>Independence</strong>: The instrument is exogenous, independent of unobserved confounders affecting the outcome, i.e., $Z X$.</li>
</ol>
<p>When these hold, IV identifies the Local Average Treatment Effect (LATE), the causal effect for compliers—individuals whose treatment status is influenced by the instrument. Unlike the Average Treatment Effect (ATE), which applies to the entire population, LATE is specific to this subpopulation, a trade-off for addressing unmeasured confounding.</p>
</div>
<div id="estimation" class="section level3 hasAnchor" number="5.2.2">
<h3><span class="header-section-number">5.2.2</span> Estimation<a href="causal-inference-in-practice-iv-instrumental-variables-in-healthcare.html#estimation" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>For binary instruments and treatments, the IV estimand is given by the Wald estimator:</p>
<p><span class="math display">\[
\widehat{\text{LATE}} = \frac{\mathbb{E}[Y \mid Z = 1] - \mathbb{E}[Y \mid Z = 0]}{\mathbb{E}[D \mid Z = 1] - \mathbb{E}[D \mid Z = 0]}
\]</span></p>
<p>This ratio scales the reduced-form effect (instrument on outcome) by the first-stage effect (instrument on treatment). In general settings with continuous variables or covariates, two-stage least squares (2SLS) is used:</p>
<ol style="list-style-type: decimal">
<li><p><strong>First Stage</strong>: Regress the treatment on the instrument and covariates:</p>
<p><span class="math display">\[
D_i = \pi_0 + \pi_1 Z_i + \pi_2^\top X_i + \nu_i
\]</span></p></li>
<li><p><strong>Second Stage</strong>: Regress the outcome on the predicted treatment and covariates:</p>
<p><span class="math display">\[
Y_i = \alpha_0 + \alpha_1 \hat{D}_i + \alpha_2^\top X_i + \varepsilon_i
\]</span></p></li>
</ol>
<p>The coefficient $_1$ estimates the LATE, consistent under valid IV assumptions, even with unmeasured confounding.</p>
</div>
<div id="comparison-with-other-methods" class="section level3 hasAnchor" number="5.2.3">
<h3><span class="header-section-number">5.2.3</span> Comparison with Other Methods<a href="causal-inference-in-practice-iv-instrumental-variables-in-healthcare.html#comparison-with-other-methods" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>IV differs from propensity score methods, which assume conditional ignorability and estimate ATE or ATT, requiring all confounders to be observed. IV, by contrast, handles unmeasured confounding but requires a valid instrument and estimates LATE. Difference-in-Differences (DiD) relies on parallel trends, assuming untreated units represent the counterfactual trend, and is suited for time-varying treatments but cannot address confounding that varies differentially over time. IV’s strength lies in its robustness to hidden bias, though it demands careful instrument selection and limits generalizability to compliers.</p>
</div>
</div>
<div id="healthcare-application-hospital-quality-and-recovery-time" class="section level2 hasAnchor" number="5.3">
<h2><span class="header-section-number">5.3</span> Healthcare Application: Hospital Quality and Recovery Time<a href="causal-inference-in-practice-iv-instrumental-variables-in-healthcare.html#healthcare-application-hospital-quality-and-recovery-time" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="scenario-1" class="section level3 hasAnchor" number="5.3.1">
<h3><span class="header-section-number">5.3.1</span> Scenario<a href="causal-inference-in-practice-iv-instrumental-variables-in-healthcare.html#scenario-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We aim to estimate the causal effect of hospital quality ($D_i = 1$ for high-quality hospitals, $D_i = 0$ for standard hospitals) on recovery time after surgery ($Y_i$, in days, lower is better). Naive regression, $Y_i = _0 + _1 D_i + _2^X_i + _i$, may be biased due to unmeasured confounders like patient health consciousness, which affects both hospital choice and recovery. We use geographic proximity to a high-quality hospital ($Z_i = 1$ if within 10 miles, $Z_i = 0$ otherwise) as an instrument, assuming patients closer to high-quality hospitals are more likely to choose them, but proximity affects recovery only through hospital choice.</p>
</div>
<div id="assumptions" class="section level3 hasAnchor" number="5.3.2">
<h3><span class="header-section-number">5.3.2</span> Assumptions<a href="causal-inference-in-practice-iv-instrumental-variables-in-healthcare.html#assumptions" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li><strong>Relevance</strong>: Proximity influences hospital choice ($(Z_i, D_i) $), testable via the first-stage F-statistic.</li>
<li><strong>Exclusion Restriction</strong>: Proximity affects recovery only through hospital choice, not via other pathways like local healthcare quality.</li>
<li><strong>Independence</strong>: Proximity is uncorrelated with unmeasured confounders (e.g., health consciousness), plausible after controlling for observables like income or education.</li>
</ul>
</div>
<div id="r-implementation-3" class="section level3 hasAnchor" number="5.3.3">
<h3><span class="header-section-number">5.3.3</span> R Implementation<a href="causal-inference-in-practice-iv-instrumental-variables-in-healthcare.html#r-implementation-3" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We simulate data for 1000 patients, with a true LATE of -5 days (high-quality hospitals reduce recovery time by 5 days for compliers). The R code below implements 2SLS, computes the Wald estimator, and compares with naive OLS.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="causal-inference-in-practice-iv-instrumental-variables-in-healthcare.html#cb10-1" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">requireNamespace</span>(<span class="st">&quot;AER&quot;</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>)) <span class="fu">install.packages</span>(<span class="st">&quot;AER&quot;</span>)</span>
<span id="cb10-2"><a href="causal-inference-in-practice-iv-instrumental-variables-in-healthcare.html#cb10-2" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">requireNamespace</span>(<span class="st">&quot;ggplot2&quot;</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>)) <span class="fu">install.packages</span>(<span class="st">&quot;ggplot2&quot;</span>)</span>
<span id="cb10-3"><a href="causal-inference-in-practice-iv-instrumental-variables-in-healthcare.html#cb10-3" tabindex="-1"></a><span class="fu">library</span>(AER)</span>
<span id="cb10-4"><a href="causal-inference-in-practice-iv-instrumental-variables-in-healthcare.html#cb10-4" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb10-5"><a href="causal-inference-in-practice-iv-instrumental-variables-in-healthcare.html#cb10-5" tabindex="-1"></a></span>
<span id="cb10-6"><a href="causal-inference-in-practice-iv-instrumental-variables-in-healthcare.html#cb10-6" tabindex="-1"></a><span class="co"># Set seed for reproducibility</span></span>
<span id="cb10-7"><a href="causal-inference-in-practice-iv-instrumental-variables-in-healthcare.html#cb10-7" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb10-8"><a href="causal-inference-in-practice-iv-instrumental-variables-in-healthcare.html#cb10-8" tabindex="-1"></a></span>
<span id="cb10-9"><a href="causal-inference-in-practice-iv-instrumental-variables-in-healthcare.html#cb10-9" tabindex="-1"></a><span class="co"># Simulate data</span></span>
<span id="cb10-10"><a href="causal-inference-in-practice-iv-instrumental-variables-in-healthcare.html#cb10-10" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span>  <span class="co"># Number of patients</span></span>
<span id="cb10-11"><a href="causal-inference-in-practice-iv-instrumental-variables-in-healthcare.html#cb10-11" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="dv">5</span>     <span class="co"># Number of covariates</span></span>
<span id="cb10-12"><a href="causal-inference-in-practice-iv-instrumental-variables-in-healthcare.html#cb10-12" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rnorm</span>(n <span class="sc">*</span> p), <span class="at">nrow =</span> n)  <span class="co"># Covariates (e.g., age, comorbidities)</span></span>
<span id="cb10-13"><a href="causal-inference-in-practice-iv-instrumental-variables-in-healthcare.html#cb10-13" tabindex="-1"></a><span class="fu">colnames</span>(X) <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;X&quot;</span>, <span class="dv">1</span><span class="sc">:</span>p)</span>
<span id="cb10-14"><a href="causal-inference-in-practice-iv-instrumental-variables-in-healthcare.html#cb10-14" tabindex="-1"></a></span>
<span id="cb10-15"><a href="causal-inference-in-practice-iv-instrumental-variables-in-healthcare.html#cb10-15" tabindex="-1"></a><span class="co"># Instrument: Z = 1 if within 10 miles</span></span>
<span id="cb10-16"><a href="causal-inference-in-practice-iv-instrumental-variables-in-healthcare.html#cb10-16" tabindex="-1"></a>Z <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(n, <span class="dv">1</span>, <span class="fl">0.5</span>)</span>
<span id="cb10-17"><a href="causal-inference-in-practice-iv-instrumental-variables-in-healthcare.html#cb10-17" tabindex="-1"></a></span>
<span id="cb10-18"><a href="causal-inference-in-practice-iv-instrumental-variables-in-healthcare.html#cb10-18" tabindex="-1"></a><span class="co"># Treatment: D = 1 for high-quality hospital</span></span>
<span id="cb10-19"><a href="causal-inference-in-practice-iv-instrumental-variables-in-healthcare.html#cb10-19" tabindex="-1"></a>pi_1 <span class="ot">&lt;-</span> <span class="fl">0.8</span>  <span class="co"># Strong instrument effect</span></span>
<span id="cb10-20"><a href="causal-inference-in-practice-iv-instrumental-variables-in-healthcare.html#cb10-20" tabindex="-1"></a>D <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">runif</span>(n) <span class="sc">&lt;</span> <span class="fu">plogis</span>(<span class="fl">0.5</span> <span class="sc">+</span> pi_1 <span class="sc">*</span> Z <span class="sc">+</span> <span class="fl">0.2</span> <span class="sc">*</span> <span class="fu">rowSums</span>(X[, <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>])))</span>
<span id="cb10-21"><a href="causal-inference-in-practice-iv-instrumental-variables-in-healthcare.html#cb10-21" tabindex="-1"></a></span>
<span id="cb10-22"><a href="causal-inference-in-practice-iv-instrumental-variables-in-healthcare.html#cb10-22" tabindex="-1"></a><span class="co"># Outcome: Recovery time (days)</span></span>
<span id="cb10-23"><a href="causal-inference-in-practice-iv-instrumental-variables-in-healthcare.html#cb10-23" tabindex="-1"></a>true_late <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">5</span></span>
<span id="cb10-24"><a href="causal-inference-in-practice-iv-instrumental-variables-in-healthcare.html#cb10-24" tabindex="-1"></a>Y <span class="ot">&lt;-</span> <span class="dv">20</span> <span class="sc">+</span> true_late <span class="sc">*</span> D <span class="sc">+</span> <span class="dv">2</span> <span class="sc">*</span> <span class="fu">rowSums</span>(X[, <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>]) <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="at">sd =</span> <span class="dv">2</span>)</span>
<span id="cb10-25"><a href="causal-inference-in-practice-iv-instrumental-variables-in-healthcare.html#cb10-25" tabindex="-1"></a></span>
<span id="cb10-26"><a href="causal-inference-in-practice-iv-instrumental-variables-in-healthcare.html#cb10-26" tabindex="-1"></a><span class="co"># Data frame</span></span>
<span id="cb10-27"><a href="causal-inference-in-practice-iv-instrumental-variables-in-healthcare.html#cb10-27" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Y =</span> Y, <span class="at">D =</span> D, <span class="at">Z =</span> Z, X)</span>
<span id="cb10-28"><a href="causal-inference-in-practice-iv-instrumental-variables-in-healthcare.html#cb10-28" tabindex="-1"></a></span>
<span id="cb10-29"><a href="causal-inference-in-practice-iv-instrumental-variables-in-healthcare.html#cb10-29" tabindex="-1"></a><span class="co"># First stage: Check relevance</span></span>
<span id="cb10-30"><a href="causal-inference-in-practice-iv-instrumental-variables-in-healthcare.html#cb10-30" tabindex="-1"></a>first_stage <span class="ot">&lt;-</span> <span class="fu">lm</span>(D <span class="sc">~</span> Z <span class="sc">+</span> ., <span class="at">data =</span> data[, <span class="fu">c</span>(<span class="st">&quot;D&quot;</span>, <span class="st">&quot;Z&quot;</span>, <span class="fu">paste0</span>(<span class="st">&quot;X&quot;</span>, <span class="dv">1</span><span class="sc">:</span>p))])</span>
<span id="cb10-31"><a href="causal-inference-in-practice-iv-instrumental-variables-in-healthcare.html#cb10-31" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;First-stage F-statistic:&quot;</span>, <span class="fu">summary</span>(first_stage)<span class="sc">$</span>fstatistic[<span class="dv">1</span>], <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb10-32"><a href="causal-inference-in-practice-iv-instrumental-variables-in-healthcare.html#cb10-32" tabindex="-1"></a></span>
<span id="cb10-33"><a href="causal-inference-in-practice-iv-instrumental-variables-in-healthcare.html#cb10-33" tabindex="-1"></a><span class="co"># 2SLS estimation</span></span>
<span id="cb10-34"><a href="causal-inference-in-practice-iv-instrumental-variables-in-healthcare.html#cb10-34" tabindex="-1"></a>iv_model <span class="ot">&lt;-</span> <span class="fu">ivreg</span>(Y <span class="sc">~</span> D <span class="sc">+</span> . <span class="sc">|</span> Z <span class="sc">+</span> ., <span class="at">data =</span> data[, <span class="fu">c</span>(<span class="st">&quot;Y&quot;</span>, <span class="st">&quot;D&quot;</span>, <span class="st">&quot;Z&quot;</span>, <span class="fu">paste0</span>(<span class="st">&quot;X&quot;</span>, <span class="dv">1</span><span class="sc">:</span>p))])</span>
<span id="cb10-35"><a href="causal-inference-in-practice-iv-instrumental-variables-in-healthcare.html#cb10-35" tabindex="-1"></a>iv_results <span class="ot">&lt;-</span> <span class="fu">summary</span>(iv_model)</span>
<span id="cb10-36"><a href="causal-inference-in-practice-iv-instrumental-variables-in-healthcare.html#cb10-36" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;2SLS LATE estimate:&quot;</span>, <span class="fu">coef</span>(iv_results)[<span class="st">&quot;D&quot;</span>, <span class="st">&quot;Estimate&quot;</span>], <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb10-37"><a href="causal-inference-in-practice-iv-instrumental-variables-in-healthcare.html#cb10-37" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Standard error:&quot;</span>, <span class="fu">coef</span>(iv_results)[<span class="st">&quot;D&quot;</span>, <span class="st">&quot;Std. Error&quot;</span>], <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb10-38"><a href="causal-inference-in-practice-iv-instrumental-variables-in-healthcare.html#cb10-38" tabindex="-1"></a></span>
<span id="cb10-39"><a href="causal-inference-in-practice-iv-instrumental-variables-in-healthcare.html#cb10-39" tabindex="-1"></a><span class="co"># Wald estimator</span></span>
<span id="cb10-40"><a href="causal-inference-in-practice-iv-instrumental-variables-in-healthcare.html#cb10-40" tabindex="-1"></a>y_z1 <span class="ot">&lt;-</span> <span class="fu">mean</span>(data<span class="sc">$</span>Y[data<span class="sc">$</span>Z <span class="sc">==</span> <span class="dv">1</span>])</span>
<span id="cb10-41"><a href="causal-inference-in-practice-iv-instrumental-variables-in-healthcare.html#cb10-41" tabindex="-1"></a>y_z0 <span class="ot">&lt;-</span> <span class="fu">mean</span>(data<span class="sc">$</span>Y[data<span class="sc">$</span>Z <span class="sc">==</span> <span class="dv">0</span>])</span>
<span id="cb10-42"><a href="causal-inference-in-practice-iv-instrumental-variables-in-healthcare.html#cb10-42" tabindex="-1"></a>d_z1 <span class="ot">&lt;-</span> <span class="fu">mean</span>(data<span class="sc">$</span>D[data<span class="sc">$</span>Z <span class="sc">==</span> <span class="dv">1</span>])</span>
<span id="cb10-43"><a href="causal-inference-in-practice-iv-instrumental-variables-in-healthcare.html#cb10-43" tabindex="-1"></a>d_z0 <span class="ot">&lt;-</span> <span class="fu">mean</span>(data<span class="sc">$</span>D[data<span class="sc">$</span>Z <span class="sc">==</span> <span class="dv">0</span>])</span>
<span id="cb10-44"><a href="causal-inference-in-practice-iv-instrumental-variables-in-healthcare.html#cb10-44" tabindex="-1"></a>wald_estimate <span class="ot">&lt;-</span> (y_z1 <span class="sc">-</span> y_z0) <span class="sc">/</span> (d_z1 <span class="sc">-</span> d_z0)</span>
<span id="cb10-45"><a href="causal-inference-in-practice-iv-instrumental-variables-in-healthcare.html#cb10-45" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Wald estimator LATE:&quot;</span>, wald_estimate, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb10-46"><a href="causal-inference-in-practice-iv-instrumental-variables-in-healthcare.html#cb10-46" tabindex="-1"></a></span>
<span id="cb10-47"><a href="causal-inference-in-practice-iv-instrumental-variables-in-healthcare.html#cb10-47" tabindex="-1"></a><span class="co"># Naive OLS</span></span>
<span id="cb10-48"><a href="causal-inference-in-practice-iv-instrumental-variables-in-healthcare.html#cb10-48" tabindex="-1"></a>ols_model <span class="ot">&lt;-</span> <span class="fu">lm</span>(Y <span class="sc">~</span> D <span class="sc">+</span> ., <span class="at">data =</span> data[, <span class="fu">c</span>(<span class="st">&quot;Y&quot;</span>, <span class="st">&quot;D&quot;</span>, <span class="fu">paste0</span>(<span class="st">&quot;X&quot;</span>, <span class="dv">1</span><span class="sc">:</span>p))])</span>
<span id="cb10-49"><a href="causal-inference-in-practice-iv-instrumental-variables-in-healthcare.html#cb10-49" tabindex="-1"></a>ols_estimate <span class="ot">&lt;-</span> <span class="fu">coef</span>(ols_model)[<span class="st">&quot;D&quot;</span>]</span>
<span id="cb10-50"><a href="causal-inference-in-practice-iv-instrumental-variables-in-healthcare.html#cb10-50" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Naive OLS estimate:&quot;</span>, ols_estimate, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb10-51"><a href="causal-inference-in-practice-iv-instrumental-variables-in-healthcare.html#cb10-51" tabindex="-1"></a></span>
<span id="cb10-52"><a href="causal-inference-in-practice-iv-instrumental-variables-in-healthcare.html#cb10-52" tabindex="-1"></a><span class="co"># Visualize results</span></span>
<span id="cb10-53"><a href="causal-inference-in-practice-iv-instrumental-variables-in-healthcare.html#cb10-53" tabindex="-1"></a>estimates <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb10-54"><a href="causal-inference-in-practice-iv-instrumental-variables-in-healthcare.html#cb10-54" tabindex="-1"></a>  <span class="at">Method =</span> <span class="fu">c</span>(<span class="st">&quot;2SLS&quot;</span>, <span class="st">&quot;Wald&quot;</span>, <span class="st">&quot;OLS&quot;</span>),</span>
<span id="cb10-55"><a href="causal-inference-in-practice-iv-instrumental-variables-in-healthcare.html#cb10-55" tabindex="-1"></a>  <span class="at">Estimate =</span> <span class="fu">c</span>(<span class="fu">coef</span>(iv_results)[<span class="st">&quot;D&quot;</span>, <span class="st">&quot;Estimate&quot;</span>], wald_estimate, ols_estimate),</span>
<span id="cb10-56"><a href="causal-inference-in-practice-iv-instrumental-variables-in-healthcare.html#cb10-56" tabindex="-1"></a>  <span class="at">SE =</span> <span class="fu">c</span>(<span class="fu">coef</span>(iv_results)[<span class="st">&quot;D&quot;</span>, <span class="st">&quot;Std. Error&quot;</span>], <span class="cn">NA</span>, <span class="fu">summary</span>(ols_model)<span class="sc">$</span>coefficients[<span class="st">&quot;D&quot;</span>, <span class="st">&quot;Std. Error&quot;</span>]),</span>
<span id="cb10-57"><a href="causal-inference-in-practice-iv-instrumental-variables-in-healthcare.html#cb10-57" tabindex="-1"></a>  <span class="at">Lower =</span> <span class="fu">c</span>(<span class="fu">coef</span>(iv_results)[<span class="st">&quot;D&quot;</span>, <span class="st">&quot;Estimate&quot;</span>] <span class="sc">-</span> <span class="fl">1.96</span> <span class="sc">*</span> <span class="fu">coef</span>(iv_results)[<span class="st">&quot;D&quot;</span>, <span class="st">&quot;Std. Error&quot;</span>],</span>
<span id="cb10-58"><a href="causal-inference-in-practice-iv-instrumental-variables-in-healthcare.html#cb10-58" tabindex="-1"></a>            <span class="cn">NA</span>, ols_estimate <span class="sc">-</span> <span class="fl">1.96</span> <span class="sc">*</span> <span class="fu">summary</span>(ols_model)<span class="sc">$</span>coefficients[<span class="st">&quot;D&quot;</span>, <span class="st">&quot;Std. Error&quot;</span>]),</span>
<span id="cb10-59"><a href="causal-inference-in-practice-iv-instrumental-variables-in-healthcare.html#cb10-59" tabindex="-1"></a>  <span class="at">Upper =</span> <span class="fu">c</span>(<span class="fu">coef</span>(iv_results)[<span class="st">&quot;D&quot;</span>, <span class="st">&quot;Estimate&quot;</span>] <span class="sc">+</span> <span class="fl">1.96</span> <span class="sc">*</span> <span class="fu">coef</span>(iv_results)[<span class="st">&quot;D&quot;</span>, <span class="st">&quot;Std. Error&quot;</span>],</span>
<span id="cb10-60"><a href="causal-inference-in-practice-iv-instrumental-variables-in-healthcare.html#cb10-60" tabindex="-1"></a>            <span class="cn">NA</span>, ols_estimate <span class="sc">+</span> <span class="fl">1.96</span> <span class="sc">*</span> <span class="fu">summary</span>(ols_model)<span class="sc">$</span>coefficients[<span class="st">&quot;D&quot;</span>, <span class="st">&quot;Std. Error&quot;</span>])</span>
<span id="cb10-61"><a href="causal-inference-in-practice-iv-instrumental-variables-in-healthcare.html#cb10-61" tabindex="-1"></a>)</span>
<span id="cb10-62"><a href="causal-inference-in-practice-iv-instrumental-variables-in-healthcare.html#cb10-62" tabindex="-1"></a></span>
<span id="cb10-63"><a href="causal-inference-in-practice-iv-instrumental-variables-in-healthcare.html#cb10-63" tabindex="-1"></a><span class="fu">ggplot</span>(estimates, <span class="fu">aes</span>(<span class="at">x =</span> Method, <span class="at">y =</span> Estimate, <span class="at">fill =</span> Method)) <span class="sc">+</span></span>
<span id="cb10-64"><a href="causal-inference-in-practice-iv-instrumental-variables-in-healthcare.html#cb10-64" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">&quot;identity&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb10-65"><a href="causal-inference-in-practice-iv-instrumental-variables-in-healthcare.html#cb10-65" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> Lower, <span class="at">ymax =</span> Upper), <span class="at">width =</span> <span class="fl">0.2</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb10-66"><a href="causal-inference-in-practice-iv-instrumental-variables-in-healthcare.html#cb10-66" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> true_late, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb10-67"><a href="causal-inference-in-practice-iv-instrumental-variables-in-healthcare.html#cb10-67" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Estimated Effect of Hospital Quality on Recovery Time&quot;</span>,</span>
<span id="cb10-68"><a href="causal-inference-in-practice-iv-instrumental-variables-in-healthcare.html#cb10-68" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Effect (Days)&quot;</span>, <span class="at">x =</span> <span class="st">&quot;Method&quot;</span>) <span class="sc">+</span></span>
<span id="cb10-69"><a href="causal-inference-in-practice-iv-instrumental-variables-in-healthcare.html#cb10-69" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;2SLS&quot;</span> <span class="ot">=</span> <span class="st">&quot;#1f77b4&quot;</span>, <span class="st">&quot;Wald&quot;</span> <span class="ot">=</span> <span class="st">&quot;#ff7f0e&quot;</span>, <span class="st">&quot;OLS&quot;</span> <span class="ot">=</span> <span class="st">&quot;#2ca02c&quot;</span>)) <span class="sc">+</span></span>
<span id="cb10-70"><a href="causal-inference-in-practice-iv-instrumental-variables-in-healthcare.html#cb10-70" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb10-71"><a href="causal-inference-in-practice-iv-instrumental-variables-in-healthcare.html#cb10-71" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="at">x =</span> <span class="fl">3.5</span>, <span class="at">y =</span> true_late <span class="sc">+</span> <span class="fl">0.5</span>, <span class="at">label =</span> <span class="st">&quot;True LATE&quot;</span>, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>)</span></code></pre></div>
</div>
</div>
<div id="interpretation-1" class="section level2 hasAnchor" number="5.4">
<h2><span class="header-section-number">5.4</span> Interpretation<a href="causal-inference-in-practice-iv-instrumental-variables-in-healthcare.html#interpretation-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The first-stage F-statistic assesses relevance; values above 10 indicate a strong instrument. In our simulation, ($_1 = 0.8$) ensures relevance. The 2SLS estimate ($_1$) should approximate the true LATE (-5 days), with confidence intervals reflecting precision. The Wald estimator, computed manually, should align closely with 2SLS but may be less precise without covariates. Naive OLS, ignoring unmeasured confounding, often yields biased estimates, typically attenuated toward zero. The plot visualizes these estimates, with 2SLS and Wald near -5 and OLS deviating, highlighting IV’s ability to correct for confounding.</p>
<p>Exclusion and independence assumptions rely on domain knowledge. Proximity is assumed to affect recovery only through hospital choice, not via other channels like local healthcare quality. Independence holds if proximity is uncorrelated with unmeasured confounders, plausible after adjusting for observables.</p>
</div>
<div id="limitations" class="section level2 hasAnchor" number="5.5">
<h2><span class="header-section-number">5.5</span> Limitations<a href="causal-inference-in-practice-iv-instrumental-variables-in-healthcare.html#limitations" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>IV estimation faces several challenges. Weak instruments (low first-stage F-statistic) lead to biased and imprecise estimates. Violation of the exclusion restriction, e.g., if proximity affects recovery through local resources, biases the LATE. Similarly, correlation between the instrument and unmeasured confounders violates independence. The LATE applies only to compliers, limiting generalizability to the broader population. Multiple instruments or endogenous variables require additional assumptions and tests, such as the Hansen J-test for overidentification. Heterogeneous treatment effects further complicate interpretation, as the LATE may not reflect effects for non-compliers.</p>
</div>
<div id="conclusion-3" class="section level2 hasAnchor" number="5.6">
<h2><span class="header-section-number">5.6</span> Conclusion<a href="causal-inference-in-practice-iv-instrumental-variables-in-healthcare.html#conclusion-3" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Instrumental Variables is a powerful tool for causal inference in observational studies, particularly in healthcare where unmeasured confounding is common. By leveraging an exogenous instrument like geographic proximity, IV can estimate causal effects, such as the impact of hospital quality on recovery time, even when randomized trials are impractical. The R implementation demonstrates practical application, with diagnostics ensuring assumption validity. While IV requires careful instrument selection and assumption justification, its ability to address hidden bias makes it indispensable for robust causal inference. Future research can explore extensions, such as handling heterogeneous effects or integrating IV with machine learning for improved precision.</p>
</div>
<div id="references-3" class="section level2 hasAnchor" number="5.7">
<h2><span class="header-section-number">5.7</span> References<a href="causal-inference-in-practice-iv-instrumental-variables-in-healthcare.html#references-3" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li>Angrist, J. D., &amp; Pischke, J.-S. (2009). <em>Mostly Harmless Econometrics: An Empiricist’s Companion</em>. Princeton University Press.</li>
<li>Wooldridge, J. M. (2010). <em>Econometric Analysis of Cross Section and Panel Data</em>. MIT Press.</li>
<li>Imbens, G. W., &amp; Rubin, D. B. (2015). <em>Causal Inference for Statistics, Social, and Biomedical Sciences: An Introduction</em>. Cambridge University Press.</li>
<li>Hernán, M. A., &amp; Robins, J. M. (2020). <em>Causal Inference: What If</em>. Chapman &amp; Hall/CRC.</li>
</ul>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="causal-inference-in-practice-iii-difference-in-differences-with-a-healthcare-application.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
  "sharing": {
    "github": false,
    "facebook": true,
    "twitter": true,
    "linkedin": false,
    "weibo": false,
    "instapaper": false,
    "vk": false,
    "whatsapp": false,
    "all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
  },
  "fontsettings": {
    "theme": "white",
    "family": "sans",
    "size": 2
  },
  "edit": {
    "link": "https://github.com/Kamran-Afzali/Bookdown_Causality/edit/main/05-IV.Rmd",
    "text": "Edit"
  },
  "history": {
    "link": null,
    "text": null
  },
  "view": {
    "link": "https://github.com/Kamran-Afzali/Bookdown_Causality/blob/main/05-IV.Rmd",
    "text": null
  },
  "download": null,
  "search": {
    "engine": "fuse",
    "options": null
  },
  "toc": {
    "collapse": "subsection"
  }
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
