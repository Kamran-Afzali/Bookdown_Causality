<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 10 Targeted Maximum Likelihood Estimation for Robust Causal Inference in Healthcare | Causal Inference in R</title>
  <meta name="description" content="Chapter 10 Targeted Maximum Likelihood Estimation for Robust Causal Inference in Healthcare | Causal Inference in R" />
  <meta name="generator" content="bookdown 0.43 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 10 Targeted Maximum Likelihood Estimation for Robust Causal Inference in Healthcare | Causal Inference in R" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 10 Targeted Maximum Likelihood Estimation for Robust Causal Inference in Healthcare | Causal Inference in R" />
  
  
  

<meta name="author" content="Kamran Afzali" />


<meta name="date" content="2025-10-21" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="meta-learners-for-heterogeneous-treatment-effects.html"/>
<link rel="next" href="g-computation-for-causal-inference.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Causality analysis in R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Foundations of Causal Statistical Analysis</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#introduction"><i class="fa fa-check"></i><b>1.1</b> Introduction</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#summary-table-techniques-for-causal-statistical-analysis"><i class="fa fa-check"></i><b>1.2</b> Summary Table: Techniques for Causal Statistical Analysis</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#methodological-deep-dive-with-practical-guidance"><i class="fa fa-check"></i><b>1.3</b> Methodological Deep Dive with Practical Guidance</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#discussion"><i class="fa fa-check"></i><b>1.4</b> Discussion</a></li>
<li class="chapter" data-level="1.5" data-path="index.html"><a href="index.html#references"><i class="fa fa-check"></i><b>1.5</b> References</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="causal-inference-in-practice-i-randomized-controlled-trials-and-regression-adjustment.html"><a href="causal-inference-in-practice-i-randomized-controlled-trials-and-regression-adjustment.html"><i class="fa fa-check"></i><b>2</b> Causal Inference in Practice I: Randomized Controlled Trials and Regression Adjustment</a>
<ul>
<li class="chapter" data-level="2.1" data-path="causal-inference-in-practice-i-randomized-controlled-trials-and-regression-adjustment.html"><a href="causal-inference-in-practice-i-randomized-controlled-trials-and-regression-adjustment.html#introduction-1"><i class="fa fa-check"></i><b>2.1</b> Introduction</a></li>
<li class="chapter" data-level="2.2" data-path="causal-inference-in-practice-i-randomized-controlled-trials-and-regression-adjustment.html"><a href="causal-inference-in-practice-i-randomized-controlled-trials-and-regression-adjustment.html#randomized-controlled-trials-design-and-analysis"><i class="fa fa-check"></i><b>2.2</b> 1. Randomized Controlled Trials: Design and Analysis</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="causal-inference-in-practice-i-randomized-controlled-trials-and-regression-adjustment.html"><a href="causal-inference-in-practice-i-randomized-controlled-trials-and-regression-adjustment.html#theoretical-foundations"><i class="fa fa-check"></i><b>2.2.1</b> Theoretical Foundations</a></li>
<li class="chapter" data-level="2.2.2" data-path="causal-inference-in-practice-i-randomized-controlled-trials-and-regression-adjustment.html"><a href="causal-inference-in-practice-i-randomized-controlled-trials-and-regression-adjustment.html#r-implementation"><i class="fa fa-check"></i><b>2.2.2</b> R Implementation</a></li>
<li class="chapter" data-level="2.2.3" data-path="causal-inference-in-practice-i-randomized-controlled-trials-and-regression-adjustment.html"><a href="causal-inference-in-practice-i-randomized-controlled-trials-and-regression-adjustment.html#model-based-inference"><i class="fa fa-check"></i><b>2.2.3</b> Model-Based Inference</a></li>
<li class="chapter" data-level="2.2.4" data-path="causal-inference-in-practice-i-randomized-controlled-trials-and-regression-adjustment.html"><a href="causal-inference-in-practice-i-randomized-controlled-trials-and-regression-adjustment.html#diagnostics-and-integrity"><i class="fa fa-check"></i><b>2.2.4</b> Diagnostics and Integrity</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="causal-inference-in-practice-i-randomized-controlled-trials-and-regression-adjustment.html"><a href="causal-inference-in-practice-i-randomized-controlled-trials-and-regression-adjustment.html#regression-adjustment-a-model-based-approach-to-causal-inference"><i class="fa fa-check"></i><b>2.3</b> 2. Regression Adjustment: A Model-Based Approach to Causal Inference</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="causal-inference-in-practice-i-randomized-controlled-trials-and-regression-adjustment.html"><a href="causal-inference-in-practice-i-randomized-controlled-trials-and-regression-adjustment.html#conceptual-overview"><i class="fa fa-check"></i><b>2.3.1</b> Conceptual Overview</a></li>
<li class="chapter" data-level="2.3.2" data-path="causal-inference-in-practice-i-randomized-controlled-trials-and-regression-adjustment.html"><a href="causal-inference-in-practice-i-randomized-controlled-trials-and-regression-adjustment.html#r-implementation-1"><i class="fa fa-check"></i><b>2.3.2</b> R Implementation</a></li>
<li class="chapter" data-level="2.3.3" data-path="causal-inference-in-practice-i-randomized-controlled-trials-and-regression-adjustment.html"><a href="causal-inference-in-practice-i-randomized-controlled-trials-and-regression-adjustment.html#limitations-and-diagnostics"><i class="fa fa-check"></i><b>2.3.3</b> Limitations and Diagnostics</a></li>
<li class="chapter" data-level="2.3.4" data-path="causal-inference-in-practice-i-randomized-controlled-trials-and-regression-adjustment.html"><a href="causal-inference-in-practice-i-randomized-controlled-trials-and-regression-adjustment.html#causal-interpretation"><i class="fa fa-check"></i><b>2.3.4</b> Causal Interpretation</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="causal-inference-in-practice-i-randomized-controlled-trials-and-regression-adjustment.html"><a href="causal-inference-in-practice-i-randomized-controlled-trials-and-regression-adjustment.html#toward-integrated-reasoning"><i class="fa fa-check"></i><b>2.4</b> Toward Integrated Reasoning</a></li>
<li class="chapter" data-level="2.5" data-path="causal-inference-in-practice-i-randomized-controlled-trials-and-regression-adjustment.html"><a href="causal-inference-in-practice-i-randomized-controlled-trials-and-regression-adjustment.html#conclusion"><i class="fa fa-check"></i><b>2.5</b> Conclusion</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="causal-inference-in-practice-ii-propensity-scores-doubly-robust-estimators-and-inverse-probability-weighting.html"><a href="causal-inference-in-practice-ii-propensity-scores-doubly-robust-estimators-and-inverse-probability-weighting.html"><i class="fa fa-check"></i><b>3</b> Causal Inference in Practice II: Propensity Scores, Doubly Robust Estimators, and Inverse Probability Weighting</a>
<ul>
<li class="chapter" data-level="3.1" data-path="causal-inference-in-practice-ii-propensity-scores-doubly-robust-estimators-and-inverse-probability-weighting.html"><a href="causal-inference-in-practice-ii-propensity-scores-doubly-robust-estimators-and-inverse-probability-weighting.html#propensity-score-methods"><i class="fa fa-check"></i><b>3.1</b> Propensity Score Methods</a></li>
<li class="chapter" data-level="3.2" data-path="causal-inference-in-practice-ii-propensity-scores-doubly-robust-estimators-and-inverse-probability-weighting.html"><a href="causal-inference-in-practice-ii-propensity-scores-doubly-robust-estimators-and-inverse-probability-weighting.html#inverse-probability-weighting-ipw"><i class="fa fa-check"></i><b>3.2</b> Inverse Probability Weighting (IPW)</a></li>
<li class="chapter" data-level="3.3" data-path="causal-inference-in-practice-ii-propensity-scores-doubly-robust-estimators-and-inverse-probability-weighting.html"><a href="causal-inference-in-practice-ii-propensity-scores-doubly-robust-estimators-and-inverse-probability-weighting.html#doubly-robust-estimators"><i class="fa fa-check"></i><b>3.3</b> Doubly Robust Estimators</a></li>
<li class="chapter" data-level="3.4" data-path="causal-inference-in-practice-ii-propensity-scores-doubly-robust-estimators-and-inverse-probability-weighting.html"><a href="causal-inference-in-practice-ii-propensity-scores-doubly-robust-estimators-and-inverse-probability-weighting.html#integrative-interpretation"><i class="fa fa-check"></i><b>3.4</b> Integrative Interpretation</a></li>
<li class="chapter" data-level="3.5" data-path="causal-inference-in-practice-ii-propensity-scores-doubly-robust-estimators-and-inverse-probability-weighting.html"><a href="causal-inference-in-practice-ii-propensity-scores-doubly-robust-estimators-and-inverse-probability-weighting.html#summary-table"><i class="fa fa-check"></i><b>3.5</b> Summary Table</a></li>
<li class="chapter" data-level="3.6" data-path="causal-inference-in-practice-ii-propensity-scores-doubly-robust-estimators-and-inverse-probability-weighting.html"><a href="causal-inference-in-practice-ii-propensity-scores-doubly-robust-estimators-and-inverse-probability-weighting.html#conclusion-1"><i class="fa fa-check"></i><b>3.6</b> Conclusion</a></li>
<li class="chapter" data-level="3.7" data-path="causal-inference-in-practice-ii-propensity-scores-doubly-robust-estimators-and-inverse-probability-weighting.html"><a href="causal-inference-in-practice-ii-propensity-scores-doubly-robust-estimators-and-inverse-probability-weighting.html#references-1"><i class="fa fa-check"></i><b>3.7</b> References</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="causal-inference-in-practice-iii-difference-in-differences-with-a-healthcare-application.html"><a href="causal-inference-in-practice-iii-difference-in-differences-with-a-healthcare-application.html"><i class="fa fa-check"></i><b>4</b> Causal Inference in Practice III: Difference-in-Differences with a Healthcare Application</a>
<ul>
<li class="chapter" data-level="4.1" data-path="causal-inference-in-practice-iii-difference-in-differences-with-a-healthcare-application.html"><a href="causal-inference-in-practice-iii-difference-in-differences-with-a-healthcare-application.html#introduction-2"><i class="fa fa-check"></i><b>4.1</b> Introduction</a></li>
<li class="chapter" data-level="4.2" data-path="causal-inference-in-practice-iii-difference-in-differences-with-a-healthcare-application.html"><a href="causal-inference-in-practice-iii-difference-in-differences-with-a-healthcare-application.html#difference-in-differences-theoretical-framework"><i class="fa fa-check"></i><b>4.2</b> Difference-in-Differences: Theoretical Framework</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="causal-inference-in-practice-iii-difference-in-differences-with-a-healthcare-application.html"><a href="causal-inference-in-practice-iii-difference-in-differences-with-a-healthcare-application.html#core-concept"><i class="fa fa-check"></i><b>4.2.1</b> Core Concept</a></li>
<li class="chapter" data-level="4.2.2" data-path="causal-inference-in-practice-iii-difference-in-differences-with-a-healthcare-application.html"><a href="causal-inference-in-practice-iii-difference-in-differences-with-a-healthcare-application.html#mathematical-formalism"><i class="fa fa-check"></i><b>4.2.2</b> Mathematical Formalism</a></li>
<li class="chapter" data-level="4.2.3" data-path="causal-inference-in-practice-iii-difference-in-differences-with-a-healthcare-application.html"><a href="causal-inference-in-practice-iii-difference-in-differences-with-a-healthcare-application.html#key-assumption-parallel-trends"><i class="fa fa-check"></i><b>4.2.3</b> Key Assumption: Parallel Trends</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="causal-inference-in-practice-iii-difference-in-differences-with-a-healthcare-application.html"><a href="causal-inference-in-practice-iii-difference-in-differences-with-a-healthcare-application.html#application-evaluating-a-telemedicine-program-in-healthcare"><i class="fa fa-check"></i><b>4.3</b> Application: Evaluating a Telemedicine Program in Healthcare</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="causal-inference-in-practice-iii-difference-in-differences-with-a-healthcare-application.html"><a href="causal-inference-in-practice-iii-difference-in-differences-with-a-healthcare-application.html#r-implementation-2"><i class="fa fa-check"></i><b>4.3.1</b> R Implementation</a></li>
<li class="chapter" data-level="4.3.2" data-path="causal-inference-in-practice-iii-difference-in-differences-with-a-healthcare-application.html"><a href="causal-inference-in-practice-iii-difference-in-differences-with-a-healthcare-application.html#limitations-and-takeaways"><i class="fa fa-check"></i><b>4.3.2</b> Limitations and takeaways</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="causal-inference-in-practice-iii-difference-in-differences-with-a-healthcare-application.html"><a href="causal-inference-in-practice-iii-difference-in-differences-with-a-healthcare-application.html#conclusion-2"><i class="fa fa-check"></i><b>4.4</b> Conclusion</a></li>
<li class="chapter" data-level="4.5" data-path="causal-inference-in-practice-iii-difference-in-differences-with-a-healthcare-application.html"><a href="causal-inference-in-practice-iii-difference-in-differences-with-a-healthcare-application.html#references-2"><i class="fa fa-check"></i><b>4.5</b> References</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="causal-inference-in-practice-iv-instrumental-variables.html"><a href="causal-inference-in-practice-iv-instrumental-variables.html"><i class="fa fa-check"></i><b>5</b> Causal Inference in Practice IV: Instrumental Variables</a>
<ul>
<li class="chapter" data-level="5.1" data-path="causal-inference-in-practice-iv-instrumental-variables.html"><a href="causal-inference-in-practice-iv-instrumental-variables.html#introduction-3"><i class="fa fa-check"></i><b>5.1</b> Introduction</a></li>
<li class="chapter" data-level="5.2" data-path="causal-inference-in-practice-iv-instrumental-variables.html"><a href="causal-inference-in-practice-iv-instrumental-variables.html#healthcare-case-study-hospital-quality-and-recovery-time"><i class="fa fa-check"></i><b>5.2</b> Healthcare Case Study: Hospital Quality and Recovery Time</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="causal-inference-in-practice-iv-instrumental-variables.html"><a href="causal-inference-in-practice-iv-instrumental-variables.html#r-implementation-3"><i class="fa fa-check"></i><b>5.2.1</b> R Implementation</a></li>
<li class="chapter" data-level="5.2.2" data-path="causal-inference-in-practice-iv-instrumental-variables.html"><a href="causal-inference-in-practice-iv-instrumental-variables.html#interpreting-the-results"><i class="fa fa-check"></i><b>5.2.2</b> Interpreting the Results</a></li>
<li class="chapter" data-level="5.2.3" data-path="causal-inference-in-practice-iv-instrumental-variables.html"><a href="causal-inference-in-practice-iv-instrumental-variables.html#robustness-checks"><i class="fa fa-check"></i><b>5.2.3</b> Robustness Checks</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="causal-inference-in-practice-iv-instrumental-variables.html"><a href="causal-inference-in-practice-iv-instrumental-variables.html#practical-considerations-and-extensions"><i class="fa fa-check"></i><b>5.3</b> Practical Considerations and Extensions</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="causal-inference-in-practice-iv-instrumental-variables.html"><a href="causal-inference-in-practice-iv-instrumental-variables.html#when-to-use-iv"><i class="fa fa-check"></i><b>5.3.1</b> When to Use IV</a></li>
<li class="chapter" data-level="5.3.2" data-path="causal-inference-in-practice-iv-instrumental-variables.html"><a href="causal-inference-in-practice-iv-instrumental-variables.html#advanced-topics"><i class="fa fa-check"></i><b>5.3.2</b> Advanced Topics</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="causal-inference-in-practice-iv-instrumental-variables.html"><a href="causal-inference-in-practice-iv-instrumental-variables.html#conclusion-3"><i class="fa fa-check"></i><b>5.4</b> Conclusion</a></li>
<li class="chapter" data-level="5.5" data-path="causal-inference-in-practice-iv-instrumental-variables.html"><a href="causal-inference-in-practice-iv-instrumental-variables.html#further-reading"><i class="fa fa-check"></i><b>5.5</b> Further Reading</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="causal-inference-in-practice-v-regression-discontinuity-design.html"><a href="causal-inference-in-practice-v-regression-discontinuity-design.html"><i class="fa fa-check"></i><b>6</b> Causal Inference in Practice V: Regression Discontinuity Design</a>
<ul>
<li class="chapter" data-level="6.1" data-path="causal-inference-in-practice-v-regression-discontinuity-design.html"><a href="causal-inference-in-practice-v-regression-discontinuity-design.html#introduction-4"><i class="fa fa-check"></i><b>6.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="causal-inference-in-practice-v-regression-discontinuity-design.html"><a href="causal-inference-in-practice-v-regression-discontinuity-design.html#comparison-with-other-methods"><i class="fa fa-check"></i><b>6.1.1</b> Comparison with Other Methods</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="causal-inference-in-practice-v-regression-discontinuity-design.html"><a href="causal-inference-in-practice-v-regression-discontinuity-design.html#healthcare-application-icu-admission-and-mortality"><i class="fa fa-check"></i><b>6.2</b> Healthcare Application: ICU Admission and Mortality</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="causal-inference-in-practice-v-regression-discontinuity-design.html"><a href="causal-inference-in-practice-v-regression-discontinuity-design.html#scenario"><i class="fa fa-check"></i><b>6.2.1</b> Scenario</a></li>
<li class="chapter" data-level="6.2.2" data-path="causal-inference-in-practice-v-regression-discontinuity-design.html"><a href="causal-inference-in-practice-v-regression-discontinuity-design.html#assumptions-and-validity"><i class="fa fa-check"></i><b>6.2.2</b> Assumptions and Validity</a></li>
<li class="chapter" data-level="6.2.3" data-path="causal-inference-in-practice-v-regression-discontinuity-design.html"><a href="causal-inference-in-practice-v-regression-discontinuity-design.html#r-implementation-4"><i class="fa fa-check"></i><b>6.2.3</b> R Implementation</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="causal-inference-in-practice-v-regression-discontinuity-design.html"><a href="causal-inference-in-practice-v-regression-discontinuity-design.html#interpretation-and-diagnostics"><i class="fa fa-check"></i><b>6.3</b> Interpretation and Diagnostics</a></li>
<li class="chapter" data-level="6.4" data-path="causal-inference-in-practice-v-regression-discontinuity-design.html"><a href="causal-inference-in-practice-v-regression-discontinuity-design.html#extensions-and-robustness"><i class="fa fa-check"></i><b>6.4</b> Extensions and Robustness</a></li>
<li class="chapter" data-level="6.5" data-path="causal-inference-in-practice-v-regression-discontinuity-design.html"><a href="causal-inference-in-practice-v-regression-discontinuity-design.html#limitations-and-considerations"><i class="fa fa-check"></i><b>6.5</b> Limitations and Considerations</a></li>
<li class="chapter" data-level="6.6" data-path="causal-inference-in-practice-v-regression-discontinuity-design.html"><a href="causal-inference-in-practice-v-regression-discontinuity-design.html#conclusion-4"><i class="fa fa-check"></i><b>6.6</b> Conclusion</a></li>
<li class="chapter" data-level="6.7" data-path="causal-inference-in-practice-v-regression-discontinuity-design.html"><a href="causal-inference-in-practice-v-regression-discontinuity-design.html#references-3"><i class="fa fa-check"></i><b>6.7</b> References</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="causal-forests.html"><a href="causal-forests.html"><i class="fa fa-check"></i><b>7</b> Causal Forests</a>
<ul>
<li class="chapter" data-level="7.1" data-path="causal-forests.html"><a href="causal-forests.html#introduction-5"><i class="fa fa-check"></i><b>7.1</b> Introduction</a></li>
<li class="chapter" data-level="7.2" data-path="causal-forests.html"><a href="causal-forests.html#precision-medicine-case-study-personalized-diabetes-treatment"><i class="fa fa-check"></i><b>7.2</b> Precision Medicine Case Study: Personalized Diabetes Treatment</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="causal-forests.html"><a href="causal-forests.html#data-generation-and-setup"><i class="fa fa-check"></i><b>7.2.1</b> Data Generation and Setup</a></li>
<li class="chapter" data-level="7.2.2" data-path="causal-forests.html"><a href="causal-forests.html#fitting-the-causal-forest"><i class="fa fa-check"></i><b>7.2.2</b> Fitting the Causal Forest</a></li>
<li class="chapter" data-level="7.2.3" data-path="causal-forests.html"><a href="causal-forests.html#variable-importance-analysis"><i class="fa fa-check"></i><b>7.2.3</b> Variable Importance Analysis</a></li>
<li class="chapter" data-level="7.2.4" data-path="causal-forests.html"><a href="causal-forests.html#statistical-testing-for-heterogeneity"><i class="fa fa-check"></i><b>7.2.4</b> Statistical Testing for Heterogeneity</a></li>
<li class="chapter" data-level="7.2.5" data-path="causal-forests.html"><a href="causal-forests.html#visualization-and-pattern-discovery"><i class="fa fa-check"></i><b>7.2.5</b> Visualization and Pattern Discovery</a></li>
<li class="chapter" data-level="7.2.6" data-path="causal-forests.html"><a href="causal-forests.html#personalized-treatment-strategy-development"><i class="fa fa-check"></i><b>7.2.6</b> Personalized Treatment Strategy Development</a></li>
<li class="chapter" data-level="7.2.7" data-path="causal-forests.html"><a href="causal-forests.html#partial-dependence-analysis"><i class="fa fa-check"></i><b>7.2.7</b> Partial Dependence Analysis</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="causal-forests.html"><a href="causal-forests.html#clinical-insights-and-limitations"><i class="fa fa-check"></i><b>7.3</b> Clinical Insights and Limitations</a></li>
<li class="chapter" data-level="7.4" data-path="causal-forests.html"><a href="causal-forests.html#conclusion-5"><i class="fa fa-check"></i><b>7.4</b> Conclusion</a></li>
<li class="chapter" data-level="7.5" data-path="causal-forests.html"><a href="causal-forests.html#references-4"><i class="fa fa-check"></i><b>7.5</b> References</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="bayesian-structural-time-series-for-causal-inference.html"><a href="bayesian-structural-time-series-for-causal-inference.html"><i class="fa fa-check"></i><b>8</b> Bayesian Structural Time Series for Causal Inference</a>
<ul>
<li class="chapter" data-level="8.1" data-path="bayesian-structural-time-series-for-causal-inference.html"><a href="bayesian-structural-time-series-for-causal-inference.html#introduction-6"><i class="fa fa-check"></i><b>8.1</b> Introduction</a></li>
<li class="chapter" data-level="8.2" data-path="bayesian-structural-time-series-for-causal-inference.html"><a href="bayesian-structural-time-series-for-causal-inference.html#r-implementation-examples-healthcare"><i class="fa fa-check"></i><b>8.2</b> R Implementation examples Healthcare</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="bayesian-structural-time-series-for-causal-inference.html"><a href="bayesian-structural-time-series-for-causal-inference.html#tobacco-tax-policy"><i class="fa fa-check"></i><b>8.2.1</b> Tobacco Tax Policy</a></li>
<li class="chapter" data-level="8.2.2" data-path="bayesian-structural-time-series-for-causal-inference.html"><a href="bayesian-structural-time-series-for-causal-inference.html#teletherapy-program-assessment"><i class="fa fa-check"></i><b>8.2.2</b> Teletherapy Program Assessment</a></li>
<li class="chapter" data-level="8.2.3" data-path="bayesian-structural-time-series-for-causal-inference.html"><a href="bayesian-structural-time-series-for-causal-inference.html#implementation-guidelines-for-healthcare-applications"><i class="fa fa-check"></i><b>8.2.3</b> Implementation Guidelines for Healthcare Applications</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="bayesian-structural-time-series-for-causal-inference.html"><a href="bayesian-structural-time-series-for-causal-inference.html#conclusion-6"><i class="fa fa-check"></i><b>8.3</b> Conclusion</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="meta-learners-for-heterogeneous-treatment-effects.html"><a href="meta-learners-for-heterogeneous-treatment-effects.html"><i class="fa fa-check"></i><b>9</b> Meta-Learners for Heterogeneous Treatment Effects</a>
<ul>
<li class="chapter" data-level="9.1" data-path="meta-learners-for-heterogeneous-treatment-effects.html"><a href="meta-learners-for-heterogeneous-treatment-effects.html#introduction-the-promise-and-peril-of-machine-learning-for-causal-inference"><i class="fa fa-check"></i><b>9.1</b> Introduction: The Promise and Peril of Machine Learning for Causal Inference</a></li>
<li class="chapter" data-level="9.2" data-path="meta-learners-for-heterogeneous-treatment-effects.html"><a href="meta-learners-for-heterogeneous-treatment-effects.html#theoretical-foundation-from-prediction-to-causal-inference"><i class="fa fa-check"></i><b>9.2</b> Theoretical Foundation: From Prediction to Causal Inference</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="meta-learners-for-heterogeneous-treatment-effects.html"><a href="meta-learners-for-heterogeneous-treatment-effects.html#the-s-learner-simplicity-with-hidden-complexity"><i class="fa fa-check"></i><b>9.2.1</b> The S-Learner: Simplicity with Hidden Complexity</a></li>
<li class="chapter" data-level="9.2.2" data-path="meta-learners-for-heterogeneous-treatment-effects.html"><a href="meta-learners-for-heterogeneous-treatment-effects.html#the-t-learner-divide-and-conquer"><i class="fa fa-check"></i><b>9.2.2</b> The T-Learner: Divide and Conquer</a></li>
<li class="chapter" data-level="9.2.3" data-path="meta-learners-for-heterogeneous-treatment-effects.html"><a href="meta-learners-for-heterogeneous-treatment-effects.html#the-x-learner-sophisticated-synthesis"><i class="fa fa-check"></i><b>9.2.3</b> The X-Learner: Sophisticated Synthesis</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="meta-learners-for-heterogeneous-treatment-effects.html"><a href="meta-learners-for-heterogeneous-treatment-effects.html#practical-implementation-hypertension-treatment-optimization"><i class="fa fa-check"></i><b>9.3</b> Practical Implementation: Hypertension Treatment Optimization</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="meta-learners-for-heterogeneous-treatment-effects.html"><a href="meta-learners-for-heterogeneous-treatment-effects.html#implementing-the-s-learner"><i class="fa fa-check"></i><b>9.3.1</b> Implementing the S-Learner</a></li>
<li class="chapter" data-level="9.3.2" data-path="meta-learners-for-heterogeneous-treatment-effects.html"><a href="meta-learners-for-heterogeneous-treatment-effects.html#implementing-the-t-learner"><i class="fa fa-check"></i><b>9.3.2</b> Implementing the T-Learner</a></li>
<li class="chapter" data-level="9.3.3" data-path="meta-learners-for-heterogeneous-treatment-effects.html"><a href="meta-learners-for-heterogeneous-treatment-effects.html#implementing-the-x-learner"><i class="fa fa-check"></i><b>9.3.3</b> Implementing the X-Learner</a></li>
<li class="chapter" data-level="9.3.4" data-path="meta-learners-for-heterogeneous-treatment-effects.html"><a href="meta-learners-for-heterogeneous-treatment-effects.html#comparative-analysis-and-model-selection"><i class="fa fa-check"></i><b>9.3.4</b> Comparative Analysis and Model Selection</a></li>
<li class="chapter" data-level="9.3.5" data-path="meta-learners-for-heterogeneous-treatment-effects.html"><a href="meta-learners-for-heterogeneous-treatment-effects.html#clinical-pattern-discovery-and-interpretation"><i class="fa fa-check"></i><b>9.3.5</b> Clinical Pattern Discovery and Interpretation</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="meta-learners-for-heterogeneous-treatment-effects.html"><a href="meta-learners-for-heterogeneous-treatment-effects.html#implementation-considerations-and-best-practices"><i class="fa fa-check"></i><b>9.4</b> Implementation Considerations and Best Practices</a></li>
<li class="chapter" data-level="9.5" data-path="meta-learners-for-heterogeneous-treatment-effects.html"><a href="meta-learners-for-heterogeneous-treatment-effects.html#conclusion-democratizing-causal-machine-learning"><i class="fa fa-check"></i><b>9.5</b> Conclusion: Democratizing Causal Machine Learning</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html"><i class="fa fa-check"></i><b>10</b> Targeted Maximum Likelihood Estimation for Robust Causal Inference in Healthcare</a>
<ul>
<li class="chapter" data-level="10.1" data-path="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#introduction-7"><i class="fa fa-check"></i><b>10.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#the-influence-function-and-double-robustness"><i class="fa fa-check"></i><b>10.1.1</b> The Influence Function and Double Robustness</a></li>
<li class="chapter" data-level="10.1.2" data-path="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#the-tmle-algorithm-targeted-bias-reduction"><i class="fa fa-check"></i><b>10.1.2</b> The TMLE Algorithm: Targeted Bias Reduction</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#healthcare-application-comparative-effectiveness-of-hypertension-treatments"><i class="fa fa-check"></i><b>10.2</b> Healthcare Application: Comparative Effectiveness of Hypertension Treatments</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#implementing-tmle-with-superlearner-ensembles"><i class="fa fa-check"></i><b>10.2.1</b> Implementing TMLE with SuperLearner Ensembles</a></li>
<li class="chapter" data-level="10.2.2" data-path="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#examining-model-performance-and-diagnostics"><i class="fa fa-check"></i><b>10.2.2</b> Examining Model Performance and Diagnostics</a></li>
<li class="chapter" data-level="10.2.3" data-path="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#understanding-the-targeting-step"><i class="fa fa-check"></i><b>10.2.3</b> Understanding the Targeting Step</a></li>
<li class="chapter" data-level="10.2.4" data-path="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#robustness-analysis-and-sensitivity-testing"><i class="fa fa-check"></i><b>10.2.4</b> Robustness Analysis and Sensitivity Testing</a></li>
<li class="chapter" data-level="10.2.5" data-path="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#clinical-interpretation-and-subgroup-analysis"><i class="fa fa-check"></i><b>10.2.5</b> Clinical Interpretation and Subgroup Analysis</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#limitations-and-practical-implementation"><i class="fa fa-check"></i><b>10.3</b> Limitations and Practical Implementation</a></li>
<li class="chapter" data-level="10.4" data-path="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#conclusion-7"><i class="fa fa-check"></i><b>10.4</b> Conclusion</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="g-computation-for-causal-inference.html"><a href="g-computation-for-causal-inference.html"><i class="fa fa-check"></i><b>11</b> G-Computation for Causal Inference</a>
<ul>
<li class="chapter" data-level="11.1" data-path="g-computation-for-causal-inference.html"><a href="g-computation-for-causal-inference.html#introduction-8"><i class="fa fa-check"></i><b>11.1</b> Introduction</a></li>
<li class="chapter" data-level="11.2" data-path="g-computation-for-causal-inference.html"><a href="g-computation-for-causal-inference.html#case-study-hypertension-management-over-time"><i class="fa fa-check"></i><b>11.2</b> Case Study: Hypertension Management Over Time</a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="g-computation-for-causal-inference.html"><a href="g-computation-for-causal-inference.html#fitting-the-g-formula-model"><i class="fa fa-check"></i><b>11.2.1</b> Fitting the G-Formula Model</a></li>
<li class="chapter" data-level="11.2.2" data-path="g-computation-for-causal-inference.html"><a href="g-computation-for-causal-inference.html#interpreting-results-and-model-diagnostics"><i class="fa fa-check"></i><b>11.2.2</b> Interpreting Results and Model Diagnostics</a></li>
<li class="chapter" data-level="11.2.3" data-path="g-computation-for-causal-inference.html"><a href="g-computation-for-causal-inference.html#advanced-applications-dynamic-treatment-regimes"><i class="fa fa-check"></i><b>11.2.3</b> Advanced Applications: Dynamic Treatment Regimes</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="g-computation-for-causal-inference.html"><a href="g-computation-for-causal-inference.html#practical-considerations-and-limitations"><i class="fa fa-check"></i><b>11.3</b> Practical Considerations and Limitations</a></li>
<li class="chapter" data-level="11.4" data-path="g-computation-for-causal-inference.html"><a href="g-computation-for-causal-inference.html#conclusion-integrating-g-computation-into-practice"><i class="fa fa-check"></i><b>11.4</b> Conclusion: Integrating G-Computation into Practice</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Causal Inference in R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare" class="section level1 hasAnchor" number="10">
<h1><span class="header-section-number">Chapter 10</span> Targeted Maximum Likelihood Estimation for Robust Causal Inference in Healthcare<a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="introduction-7" class="section level2 hasAnchor" number="10.1">
<h2><span class="header-section-number">10.1</span> Introduction<a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#introduction-7" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Imagine you’re analyzing electronic health records to determine whether a new hypertension medication reduces cardiovascular events compared to standard therapy. Unlike the controlled environment of randomized trials, observational data presents complex challenges: patients receiving the new medication might systematically differ from those on standard therapy, treatment decisions depend on unmeasured physician preferences, and electronic health records contain missing data and measurement errors that could bias traditional analyses.</p>
<p>This scenario exemplifies the fundamental tension in observational causal inference between making strong parametric assumptions that may be wrong and using flexible nonparametric approaches that may be inefficient or unstable. Traditional regression models assume we know the correct functional form for how patient characteristics relate to both treatment assignment and outcomes—assumptions that are rarely justified in complex healthcare settings. Conversely, purely nonparametric approaches may suffer from curse of dimensionality problems when patient characteristics are numerous and complex.</p>
<p>Targeted Maximum Likelihood Estimation (TMLE) resolves this dilemma through a principled framework that combines the flexibility of machine learning with the statistical rigor of semiparametric efficiency theory. Unlike conventional approaches that require choosing between parametric efficiency and nonparametric robustness, TMLE provides double robustness—valid causal estimates when either the treatment assignment model or the outcome model is correctly specified, but not necessarily both.</p>
<p>This double robustness property transforms observational studies by acknowledging that we cannot perfectly model complex healthcare processes while still providing statistically optimal estimates when our models are approximately correct. TMLE accomplishes this through targeted bias correction that specifically optimizes the parts of our models most relevant for the causal parameter of interest, rather than attempting to model every aspect of the data generating process with equal precision.</p>
<p>TMLE emerges from semiparametric efficiency theory, which provides mathematical foundations for optimal estimation when some aspects of the data generating process are known while others remain unspecified. In causal inference settings, we typically know the structure of our causal question—we want to estimate the average treatment effect <span class="math inline">\(\mathbb{E}[Y^1 - Y^0]\)</span>—but remain uncertain about the complex relationships between patient characteristics, treatment assignment, and outcomes.</p>
<p>The fundamental insight is that causal parameters like average treatment effects can be expressed as functionals of the data generating distribution <span class="math inline">\(P_0\)</span>, written as <span class="math inline">\(\Psi(P_0)\)</span>. For the average treatment effect, this becomes <span class="math inline">\(\Psi(P_0) = \mathbb{E}_{P_0}[\mathbb{E}_{P_0}[Y|A=1,W] - \mathbb{E}_{P_0}[Y|A=0,W]]\)</span>, where <span class="math inline">\(W\)</span> represents patient characteristics, <span class="math inline">\(A\)</span> indicates treatment assignment, and <span class="math inline">\(Y\)</span> denotes the outcome. This formulation separates the causal parameter we want to estimate from the nuisance parameters—the outcome regression <span class="math inline">\(\mathbb{E}[Y|A,W]\)</span> and propensity score <span class="math inline">\(\mathbb{E}[A|W]\)</span>—that we need to handle along the way.</p>
<p>The efficiency bound theorem establishes that any regular and asymptotically linear estimator of <span class="math inline">\(\Psi(P_0)\)</span> has asymptotic variance bounded below by <span class="math inline">\(\text{Var}(D^*(O))\)</span>, where <span class="math inline">\(D^*(O)\)</span> represents the efficient influence function for the parameter. This influence function characterizes how each observation contributes to the parameter estimate and provides the theoretical benchmark for optimal performance.</p>
<div id="the-influence-function-and-double-robustness" class="section level3 hasAnchor" number="10.1.1">
<h3><span class="header-section-number">10.1.1</span> The Influence Function and Double Robustness<a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#the-influence-function-and-double-robustness" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The efficient influence function for the average treatment effect takes the form:</p>
<p><span class="math display">\[D^*(O) = \frac{A(Y - \bar{Q}(A,W))}{g(A|W)} - \frac{(1-A)(Y - \bar{Q}(A,W))}{1-g(A|W)} + \bar{Q}(1,W) - \bar{Q}(0,W) - \Psi(P_0)\]</span></p>
<p>where <span class="math inline">\(\bar{Q}(A,W) = \mathbb{E}[Y|A,W]\)</span> represents the outcome regression and <span class="math inline">\(g(A|W) = \mathbb{P}(A=1|W)\)</span> represents the propensity score. This formulation reveals the double robustness property: if either <span class="math inline">\(\bar{Q}\)</span> or <span class="math inline">\(g\)</span> is correctly specified, the bias terms involving the misspecified function disappear asymptotically, yielding consistent estimation of the causal parameter.</p>
<p>The intuition behind double robustness emerges from the correction mechanism embedded in the influence function. When the outcome model <span class="math inline">\(\bar{Q}\)</span> is wrong but the propensity score <span class="math inline">\(g\)</span> is correct, the weighted residuals <span class="math inline">\(\frac{A(Y - \bar{Q}(A,W))}{g(A|W)} - \frac{(1-A)(Y - \bar{Q}(A,W))}{1-g(A|W)}\)</span> provide unbiased corrections for the outcome model errors. Conversely, when the propensity score is wrong but the outcome model is correct, the final term <span class="math inline">\(\bar{Q}(1,W) - \bar{Q}(0,W)\)</span> provides the correct causal contrast directly.</p>
</div>
<div id="the-tmle-algorithm-targeted-bias-reduction" class="section level3 hasAnchor" number="10.1.2">
<h3><span class="header-section-number">10.1.2</span> The TMLE Algorithm: Targeted Bias Reduction<a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#the-tmle-algorithm-targeted-bias-reduction" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>TMLE implements these theoretical insights through a two-stage procedure that first estimates nuisance parameters using machine learning methods, then applies targeted bias correction to optimize performance for the specific causal parameter of interest. The algorithm proceeds through three essential steps that transform initial estimates into efficient causal parameter estimates.</p>
<p>The initial step estimates both nuisance parameters using flexible machine learning approaches. For the outcome regression, this might involve random forests, neural networks, or ensemble methods that predict <span class="math inline">\(Y\)</span> from <span class="math inline">\(A\)</span> and <span class="math inline">\(W\)</span> without restrictive parametric assumptions. Similarly, the propensity score estimation employs machine learning methods to predict treatment assignment from patient characteristics, capturing complex relationships that linear models might miss.</p>
<p>The targeting step represents TMLE’s core innovation. Rather than using the initial outcome model directly, TMLE updates this model by fitting a parametric submodel that includes a covariate designed specifically to reduce bias for the causal parameter. This clever parameterization, <span class="math inline">\(\bar{Q}_n^*(\epsilon) = \bar{Q}_n^0 + \epsilon \cdot H(A,W)\)</span> where <span class="math inline">\(H(A,W) = \frac{A}{g_n(1|W)} - \frac{1-A}{g_n(0|W)}\)</span>, ensures that the score equation for <span class="math inline">\(\epsilon\)</span> equals the empirical mean of the efficient influence function.</p>
<p>The final step computes the causal parameter estimate by substituting the updated outcome model: <span class="math inline">\(\hat{\Psi} = \frac{1}{n}\sum_{i=1}^n[\bar{Q}_n^*(1,W_i) - \bar{Q}_n^*(0,W_i)]\)</span>. This substitution principle ensures that our causal estimate incorporates both the flexibility of machine learning and the bias correction necessary for optimal performance.</p>
</div>
</div>
<div id="healthcare-application-comparative-effectiveness-of-hypertension-treatments" class="section level2 hasAnchor" number="10.2">
<h2><span class="header-section-number">10.2</span> Healthcare Application: Comparative Effectiveness of Hypertension Treatments<a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#healthcare-application-comparative-effectiveness-of-hypertension-treatments" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We’ll demonstrate TMLE through a realistic comparative effectiveness study examining whether ACE inhibitors reduce cardiovascular events more effectively than calcium channel blockers among patients with hypertension. This scenario reflects common observational studies where treatment selection depends on complex patient characteristics that electronic health records capture imperfectly, creating both confounding and measurement challenges that TMLE is designed to address.</p>
<p>Our simulated patient population includes demographic characteristics, comorbidity indicators, laboratory values, and healthcare utilization patterns that influence both treatment selection and cardiovascular outcomes. The treatment assignment mechanism reflects realistic clinical decision-making where physicians consider multiple patient factors simultaneously, while the outcome generating process incorporates both direct treatment effects and complex interactions between patient characteristics and treatment response.</p>
<div class="sourceCode" id="cb199"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb199-1"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb199-1" tabindex="-1"></a><span class="co"># Load required libraries for TMLE analysis</span></span>
<span id="cb199-2"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb199-2" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">requireNamespace</span>(<span class="st">&quot;tmle&quot;</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>)) <span class="fu">install.packages</span>(<span class="st">&quot;tmle&quot;</span>)</span>
<span id="cb199-3"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb199-3" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">requireNamespace</span>(<span class="st">&quot;SuperLearner&quot;</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>)) <span class="fu">install.packages</span>(<span class="st">&quot;SuperLearner&quot;</span>)</span>
<span id="cb199-4"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb199-4" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">requireNamespace</span>(<span class="st">&quot;randomForest&quot;</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>)) <span class="fu">install.packages</span>(<span class="st">&quot;randomForest&quot;</span>)</span>
<span id="cb199-5"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb199-5" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">requireNamespace</span>(<span class="st">&quot;glmnet&quot;</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>)) <span class="fu">install.packages</span>(<span class="st">&quot;glmnet&quot;</span>)</span>
<span id="cb199-6"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb199-6" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">requireNamespace</span>(<span class="st">&quot;ggplot2&quot;</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>)) <span class="fu">install.packages</span>(<span class="st">&quot;ggplot2&quot;</span>)</span>
<span id="cb199-7"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb199-7" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">requireNamespace</span>(<span class="st">&quot;dplyr&quot;</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>)) <span class="fu">install.packages</span>(<span class="st">&quot;dplyr&quot;</span>)</span>
<span id="cb199-8"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb199-8" tabindex="-1"></a></span>
<span id="cb199-9"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb199-9" tabindex="-1"></a><span class="fu">library</span>(tmle)</span>
<span id="cb199-10"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb199-10" tabindex="-1"></a><span class="fu">library</span>(SuperLearner)</span>
<span id="cb199-11"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb199-11" tabindex="-1"></a><span class="fu">library</span>(randomForest)</span>
<span id="cb199-12"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb199-12" tabindex="-1"></a><span class="fu">library</span>(glmnet)</span>
<span id="cb199-13"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb199-13" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb199-14"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb199-14" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb199-15"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb199-15" tabindex="-1"></a></span>
<span id="cb199-16"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb199-16" tabindex="-1"></a><span class="co"># Set seed for reproducible results</span></span>
<span id="cb199-17"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb199-17" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">456</span>)</span>
<span id="cb199-18"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb199-18" tabindex="-1"></a></span>
<span id="cb199-19"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb199-19" tabindex="-1"></a><span class="co"># Generate realistic patient population</span></span>
<span id="cb199-20"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb199-20" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">5000</span></span>
<span id="cb199-21"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb199-21" tabindex="-1"></a></span>
<span id="cb199-22"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb199-22" tabindex="-1"></a><span class="co"># Patient demographics and clinical characteristics</span></span>
<span id="cb199-23"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb199-23" tabindex="-1"></a>age <span class="ot">&lt;-</span> <span class="fu">pmax</span>(<span class="dv">40</span>, <span class="fu">pmin</span>(<span class="dv">85</span>, <span class="fu">rnorm</span>(n, <span class="dv">65</span>, <span class="dv">12</span>)))</span>
<span id="cb199-24"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb199-24" tabindex="-1"></a>sex <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(n, <span class="dv">1</span>, <span class="fl">0.52</span>)  <span class="co"># 52% female</span></span>
<span id="cb199-25"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb199-25" tabindex="-1"></a>race_white <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(n, <span class="dv">1</span>, <span class="fl">0.75</span>)</span>
<span id="cb199-26"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb199-26" tabindex="-1"></a>race_black <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(n, <span class="dv">1</span>, <span class="fl">0.15</span>)</span>
<span id="cb199-27"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb199-27" tabindex="-1"></a>race_hispanic <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(n, <span class="dv">1</span>, <span class="fl">0.08</span>)</span>
<span id="cb199-28"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb199-28" tabindex="-1"></a></span>
<span id="cb199-29"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb199-29" tabindex="-1"></a><span class="co"># Clinical measurements and comorbidities</span></span>
<span id="cb199-30"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb199-30" tabindex="-1"></a>systolic_bp <span class="ot">&lt;-</span> <span class="fu">pmax</span>(<span class="dv">140</span>, <span class="fu">pmin</span>(<span class="dv">200</span>, <span class="fu">rnorm</span>(n, <span class="dv">155</span>, <span class="dv">15</span>)))</span>
<span id="cb199-31"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb199-31" tabindex="-1"></a>diastolic_bp <span class="ot">&lt;-</span> <span class="fu">pmax</span>(<span class="dv">90</span>, <span class="fu">pmin</span>(<span class="dv">120</span>, <span class="fu">rnorm</span>(n, <span class="dv">95</span>, <span class="dv">10</span>)))</span>
<span id="cb199-32"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb199-32" tabindex="-1"></a>diabetes <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(n, <span class="dv">1</span>, <span class="fl">0.35</span>)</span>
<span id="cb199-33"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb199-33" tabindex="-1"></a>chronic_kidney_disease <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(n, <span class="dv">1</span>, <span class="fl">0.25</span>)</span>
<span id="cb199-34"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb199-34" tabindex="-1"></a>coronary_artery_disease <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(n, <span class="dv">1</span>, <span class="fl">0.30</span>)</span>
<span id="cb199-35"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb199-35" tabindex="-1"></a>heart_failure <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(n, <span class="dv">1</span>, <span class="fl">0.15</span>)</span>
<span id="cb199-36"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb199-36" tabindex="-1"></a></span>
<span id="cb199-37"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb199-37" tabindex="-1"></a><span class="co"># Healthcare utilization indicators</span></span>
<span id="cb199-38"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb199-38" tabindex="-1"></a>prior_hospitalizations <span class="ot">&lt;-</span> <span class="fu">rpois</span>(n, <span class="fl">1.2</span>)</span>
<span id="cb199-39"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb199-39" tabindex="-1"></a>specialist_visits <span class="ot">&lt;-</span> <span class="fu">rpois</span>(n, <span class="fl">2.5</span>)</span>
<span id="cb199-40"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb199-40" tabindex="-1"></a>medication_adherence <span class="ot">&lt;-</span> <span class="fu">pmax</span>(<span class="fl">0.3</span>, <span class="fu">pmin</span>(<span class="fl">1.0</span>, <span class="fu">rnorm</span>(n, <span class="fl">0.8</span>, <span class="fl">0.2</span>)))</span>
<span id="cb199-41"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb199-41" tabindex="-1"></a></span>
<span id="cb199-42"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb199-42" tabindex="-1"></a><span class="co"># Create covariate matrix</span></span>
<span id="cb199-43"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb199-43" tabindex="-1"></a>W <span class="ot">&lt;-</span> <span class="fu">cbind</span>(age, sex, race_white, race_black, race_hispanic,</span>
<span id="cb199-44"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb199-44" tabindex="-1"></a>           systolic_bp, diastolic_bp, diabetes, chronic_kidney_disease,</span>
<span id="cb199-45"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb199-45" tabindex="-1"></a>           coronary_artery_disease, heart_failure, prior_hospitalizations,</span>
<span id="cb199-46"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb199-46" tabindex="-1"></a>           specialist_visits, medication_adherence)</span>
<span id="cb199-47"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb199-47" tabindex="-1"></a></span>
<span id="cb199-48"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb199-48" tabindex="-1"></a><span class="fu">colnames</span>(W) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;age&quot;</span>, <span class="st">&quot;sex&quot;</span>, <span class="st">&quot;race_white&quot;</span>, <span class="st">&quot;race_black&quot;</span>, <span class="st">&quot;race_hispanic&quot;</span>,</span>
<span id="cb199-49"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb199-49" tabindex="-1"></a>                 <span class="st">&quot;systolic_bp&quot;</span>, <span class="st">&quot;diastolic_bp&quot;</span>, <span class="st">&quot;diabetes&quot;</span>, <span class="st">&quot;ckd&quot;</span>,</span>
<span id="cb199-50"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb199-50" tabindex="-1"></a>                 <span class="st">&quot;cad&quot;</span>, <span class="st">&quot;heart_failure&quot;</span>, <span class="st">&quot;prior_hosp&quot;</span>, <span class="st">&quot;specialist_visits&quot;</span>,</span>
<span id="cb199-51"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb199-51" tabindex="-1"></a>                 <span class="st">&quot;med_adherence&quot;</span>)</span>
<span id="cb199-52"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb199-52" tabindex="-1"></a></span>
<span id="cb199-53"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb199-53" tabindex="-1"></a><span class="co"># Complex treatment assignment mechanism</span></span>
<span id="cb199-54"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb199-54" tabindex="-1"></a><span class="co"># ACE inhibitors more likely for younger patients, those with diabetes, heart failure</span></span>
<span id="cb199-55"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb199-55" tabindex="-1"></a><span class="co"># Calcium channel blockers more likely for older patients, those with high systolic BP</span></span>
<span id="cb199-56"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb199-56" tabindex="-1"></a>propensity_linear <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fl">2.5</span> <span class="sc">+</span> </span>
<span id="cb199-57"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb199-57" tabindex="-1"></a>  <span class="fl">0.02</span> <span class="sc">*</span> (age <span class="sc">-</span> <span class="dv">65</span>) <span class="sc">+</span>           <span class="co"># Age effect</span></span>
<span id="cb199-58"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb199-58" tabindex="-1"></a>  <span class="fl">0.3</span> <span class="sc">*</span> sex <span class="sc">+</span>                   <span class="co"># Female preference for ACE inhibitors</span></span>
<span id="cb199-59"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb199-59" tabindex="-1"></a>  <span class="fl">0.5</span> <span class="sc">*</span> diabetes <span class="sc">+</span>              <span class="co"># Strong diabetes indication</span></span>
<span id="cb199-60"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb199-60" tabindex="-1"></a>  <span class="fl">0.4</span> <span class="sc">*</span> heart_failure <span class="sc">+</span>         <span class="co"># Heart failure indication</span></span>
<span id="cb199-61"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb199-61" tabindex="-1"></a>  <span class="sc">-</span><span class="fl">0.3</span> <span class="sc">*</span> (systolic_bp <span class="sc">&gt;</span> <span class="dv">170</span>) <span class="sc">+</span>  <span class="co"># Very high BP favors CCB</span></span>
<span id="cb199-62"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb199-62" tabindex="-1"></a>  <span class="fl">0.2</span> <span class="sc">*</span> race_black <span class="sc">+</span>            <span class="co"># Population differences</span></span>
<span id="cb199-63"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb199-63" tabindex="-1"></a>  <span class="fl">0.15</span> <span class="sc">*</span> (medication_adherence <span class="sc">-</span> <span class="fl">0.8</span>) <span class="sc">+</span> <span class="co"># Adherence considerations</span></span>
<span id="cb199-64"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb199-64" tabindex="-1"></a>  <span class="fu">rnorm</span>(n, <span class="dv">0</span>, <span class="fl">0.3</span>)              <span class="co"># Unmeasured physician preferences</span></span>
<span id="cb199-65"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb199-65" tabindex="-1"></a></span>
<span id="cb199-66"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb199-66" tabindex="-1"></a>A <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(n, <span class="dv">1</span>, <span class="fu">plogis</span>(propensity_linear))</span>
<span id="cb199-67"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb199-67" tabindex="-1"></a></span>
<span id="cb199-68"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb199-68" tabindex="-1"></a><span class="co"># Complex outcome generation with treatment heterogeneity</span></span>
<span id="cb199-69"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb199-69" tabindex="-1"></a><span class="co"># Cardiovascular events over 2-year follow-up</span></span>
<span id="cb199-70"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb199-70" tabindex="-1"></a>baseline_risk <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fl">3.0</span> <span class="sc">+</span></span>
<span id="cb199-71"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb199-71" tabindex="-1"></a>  <span class="fl">0.03</span> <span class="sc">*</span> (age <span class="sc">-</span> <span class="dv">65</span>) <span class="sc">+</span></span>
<span id="cb199-72"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb199-72" tabindex="-1"></a>  <span class="fl">0.2</span> <span class="sc">*</span> sex <span class="sc">+</span></span>
<span id="cb199-73"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb199-73" tabindex="-1"></a>  <span class="fl">0.01</span> <span class="sc">*</span> (systolic_bp <span class="sc">-</span> <span class="dv">155</span>) <span class="sc">+</span></span>
<span id="cb199-74"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb199-74" tabindex="-1"></a>  <span class="fl">0.01</span> <span class="sc">*</span> (diastolic_bp <span class="sc">-</span> <span class="dv">95</span>) <span class="sc">+</span></span>
<span id="cb199-75"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb199-75" tabindex="-1"></a>  <span class="fl">0.4</span> <span class="sc">*</span> diabetes <span class="sc">+</span></span>
<span id="cb199-76"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb199-76" tabindex="-1"></a>  <span class="fl">0.3</span> <span class="sc">*</span> chronic_kidney_disease <span class="sc">+</span></span>
<span id="cb199-77"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb199-77" tabindex="-1"></a>  <span class="fl">0.6</span> <span class="sc">*</span> coronary_artery_disease <span class="sc">+</span></span>
<span id="cb199-78"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb199-78" tabindex="-1"></a>  <span class="fl">0.5</span> <span class="sc">*</span> heart_failure <span class="sc">+</span></span>
<span id="cb199-79"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb199-79" tabindex="-1"></a>  <span class="fl">0.1</span> <span class="sc">*</span> prior_hospitalizations <span class="sc">+</span></span>
<span id="cb199-80"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb199-80" tabindex="-1"></a>  <span class="sc">-</span><span class="fl">0.5</span> <span class="sc">*</span> medication_adherence</span>
<span id="cb199-81"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb199-81" tabindex="-1"></a></span>
<span id="cb199-82"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb199-82" tabindex="-1"></a><span class="co"># Treatment effects with heterogeneity</span></span>
<span id="cb199-83"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb199-83" tabindex="-1"></a><span class="co"># ACE inhibitors particularly beneficial for diabetes, heart failure</span></span>
<span id="cb199-84"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb199-84" tabindex="-1"></a><span class="co"># Less beneficial for older patients</span></span>
<span id="cb199-85"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb199-85" tabindex="-1"></a>treatment_effect <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fl">0.4</span> <span class="sc">+</span>                    <span class="co"># Base treatment effect</span></span>
<span id="cb199-86"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb199-86" tabindex="-1"></a>  <span class="sc">-</span><span class="fl">0.3</span> <span class="sc">*</span> diabetes <span class="sc">*</span> A <span class="sc">+</span>                       <span class="co"># Enhanced diabetes benefit</span></span>
<span id="cb199-87"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb199-87" tabindex="-1"></a>  <span class="sc">-</span><span class="fl">0.2</span> <span class="sc">*</span> heart_failure <span class="sc">*</span> A <span class="sc">+</span>                  <span class="co"># Enhanced heart failure benefit</span></span>
<span id="cb199-88"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb199-88" tabindex="-1"></a>  <span class="fl">0.15</span> <span class="sc">*</span> (age <span class="sc">&gt;</span> <span class="dv">70</span>) <span class="sc">*</span> A <span class="sc">+</span>                     <span class="co"># Reduced benefit in elderly</span></span>
<span id="cb199-89"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb199-89" tabindex="-1"></a>  <span class="sc">-</span><span class="fl">0.1</span> <span class="sc">*</span> (medication_adherence <span class="sc">-</span> <span class="fl">0.8</span>) <span class="sc">*</span> A     <span class="co"># Adherence interaction</span></span>
<span id="cb199-90"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb199-90" tabindex="-1"></a></span>
<span id="cb199-91"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb199-91" tabindex="-1"></a>Y <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(n, <span class="dv">1</span>, <span class="fu">plogis</span>(baseline_risk <span class="sc">+</span> treatment_effect))</span>
<span id="cb199-92"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb199-92" tabindex="-1"></a></span>
<span id="cb199-93"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb199-93" tabindex="-1"></a><span class="co"># Create analysis dataset</span></span>
<span id="cb199-94"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb199-94" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(W, <span class="at">A =</span> A, <span class="at">Y =</span> Y)</span>
<span id="cb199-95"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb199-95" tabindex="-1"></a></span>
<span id="cb199-96"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb199-96" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Dataset Summary:</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb199-97"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb199-97" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Sample size:&quot;</span>, n, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb199-98"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb199-98" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;ACE inhibitor patients:&quot;</span>, <span class="fu">sum</span>(A), <span class="st">&quot;(&quot;</span>, <span class="fu">round</span>(<span class="dv">100</span><span class="sc">*</span><span class="fu">mean</span>(A), <span class="dv">1</span>), <span class="st">&quot;%)</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb199-99"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb199-99" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Calcium channel blocker patients:&quot;</span>, <span class="fu">sum</span>(<span class="dv">1</span><span class="sc">-</span>A), <span class="st">&quot;(&quot;</span>, <span class="fu">round</span>(<span class="dv">100</span><span class="sc">*</span><span class="fu">mean</span>(<span class="dv">1</span><span class="sc">-</span>A), <span class="dv">1</span>), <span class="st">&quot;%)</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb199-100"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb199-100" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Overall event rate:&quot;</span>, <span class="fu">round</span>(<span class="dv">100</span><span class="sc">*</span><span class="fu">mean</span>(Y), <span class="dv">1</span>), <span class="st">&quot;%</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb199-101"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb199-101" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Event rate - ACE inhibitors:&quot;</span>, <span class="fu">round</span>(<span class="dv">100</span><span class="sc">*</span><span class="fu">mean</span>(Y[A<span class="sc">==</span><span class="dv">1</span>]), <span class="dv">1</span>), <span class="st">&quot;%</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb199-102"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb199-102" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Event rate - CCB:&quot;</span>, <span class="fu">round</span>(<span class="dv">100</span><span class="sc">*</span><span class="fu">mean</span>(Y[A<span class="sc">==</span><span class="dv">0</span>]), <span class="dv">1</span>), <span class="st">&quot;%</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb199-103"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb199-103" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Crude risk difference:&quot;</span>, <span class="fu">round</span>(<span class="dv">100</span><span class="sc">*</span>(<span class="fu">mean</span>(Y[A<span class="sc">==</span><span class="dv">1</span>]) <span class="sc">-</span> <span class="fu">mean</span>(Y[A<span class="sc">==</span><span class="dv">0</span>])), <span class="dv">2</span>), <span class="st">&quot;%</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<div id="implementing-tmle-with-superlearner-ensembles" class="section level3 hasAnchor" number="10.2.1">
<h3><span class="header-section-number">10.2.1</span> Implementing TMLE with SuperLearner Ensembles<a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#implementing-tmle-with-superlearner-ensembles" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The power of TMLE emerges through its integration with SuperLearner, an ensemble method that combines multiple machine learning algorithms to achieve optimal bias-variance tradeoffs for nuisance parameter estimation. Rather than committing to a single modeling approach, SuperLearner automatically selects the optimal weighted combination of candidate algorithms based on cross-validated performance.</p>
<div class="sourceCode" id="cb200"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb200-1"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb200-1" tabindex="-1"></a><span class="co"># Define SuperLearner library for nuisance parameter estimation</span></span>
<span id="cb200-2"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb200-2" tabindex="-1"></a><span class="co"># Include diverse algorithms to capture different aspects of relationships</span></span>
<span id="cb200-3"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb200-3" tabindex="-1"></a>SL_library <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;SL.glm&quot;</span>,           <span class="co"># Linear models for interpretability</span></span>
<span id="cb200-4"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb200-4" tabindex="-1"></a>                <span class="st">&quot;SL.glm.interaction&quot;</span>, <span class="co"># Include interactions</span></span>
<span id="cb200-5"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb200-5" tabindex="-1"></a>                <span class="st">&quot;SL.stepAIC&quot;</span>,        <span class="co"># Stepwise selection</span></span>
<span id="cb200-6"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb200-6" tabindex="-1"></a>                <span class="st">&quot;SL.randomForest&quot;</span>,   <span class="co"># Tree-based ensemble</span></span>
<span id="cb200-7"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb200-7" tabindex="-1"></a>                <span class="st">&quot;SL.glmnet&quot;</span>)         <span class="co"># Regularized regression</span></span>
<span id="cb200-8"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb200-8" tabindex="-1"></a></span>
<span id="cb200-9"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb200-9" tabindex="-1"></a><span class="co"># Fit TMLE with SuperLearner for both outcome and propensity models</span></span>
<span id="cb200-10"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb200-10" tabindex="-1"></a>tmle_result <span class="ot">&lt;-</span> <span class="fu">tmle</span>(<span class="at">Y =</span> data<span class="sc">$</span>Y, </span>
<span id="cb200-11"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb200-11" tabindex="-1"></a>                    <span class="at">A =</span> data<span class="sc">$</span>A, </span>
<span id="cb200-12"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb200-12" tabindex="-1"></a>                    <span class="at">W =</span> data[, <span class="dv">1</span><span class="sc">:</span><span class="dv">14</span>],  <span class="co"># All covariates except treatment and outcome</span></span>
<span id="cb200-13"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb200-13" tabindex="-1"></a>                    <span class="at">Q.SL.library =</span> SL_library,</span>
<span id="cb200-14"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb200-14" tabindex="-1"></a>                    <span class="at">g.SL.library =</span> SL_library,</span>
<span id="cb200-15"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb200-15" tabindex="-1"></a>                    <span class="at">family =</span> <span class="st">&quot;binomial&quot;</span>)</span>
<span id="cb200-16"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb200-16" tabindex="-1"></a></span>
<span id="cb200-17"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb200-17" tabindex="-1"></a><span class="co"># Extract results</span></span>
<span id="cb200-18"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb200-18" tabindex="-1"></a>ate_tmle <span class="ot">&lt;-</span> tmle_result<span class="sc">$</span>estimates<span class="sc">$</span>ATE<span class="sc">$</span>psi</span>
<span id="cb200-19"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb200-19" tabindex="-1"></a>ate_se <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(tmle_result<span class="sc">$</span>estimates<span class="sc">$</span>ATE<span class="sc">$</span>var.psi)</span>
<span id="cb200-20"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb200-20" tabindex="-1"></a>ate_ci_lower <span class="ot">&lt;-</span> ate_tmle <span class="sc">-</span> <span class="fl">1.96</span> <span class="sc">*</span> ate_se</span>
<span id="cb200-21"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb200-21" tabindex="-1"></a>ate_ci_upper <span class="ot">&lt;-</span> ate_tmle <span class="sc">+</span> <span class="fl">1.96</span> <span class="sc">*</span> ate_se</span>
<span id="cb200-22"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb200-22" tabindex="-1"></a>ate_pvalue <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fu">pnorm</span>(<span class="fu">abs</span>(ate_tmle <span class="sc">/</span> ate_se)))</span>
<span id="cb200-23"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb200-23" tabindex="-1"></a></span>
<span id="cb200-24"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb200-24" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;TMLE Results:</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb200-25"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb200-25" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Average Treatment Effect:&quot;</span>, <span class="fu">round</span>(ate_tmle, <span class="dv">4</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb200-26"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb200-26" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Standard Error:&quot;</span>, <span class="fu">round</span>(ate_se, <span class="dv">4</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb200-27"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb200-27" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;95% Confidence Interval: [&quot;</span>, <span class="fu">round</span>(ate_ci_lower, <span class="dv">4</span>), <span class="st">&quot;,&quot;</span>, <span class="fu">round</span>(ate_ci_upper, <span class="dv">4</span>), <span class="st">&quot;]</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb200-28"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb200-28" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;P-value:&quot;</span>, <span class="fu">round</span>(ate_pvalue, <span class="dv">4</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb200-29"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb200-29" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Risk Difference (%):&quot;</span>, <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> ate_tmle, <span class="dv">2</span>), <span class="st">&quot;%</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb200-30"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb200-30" tabindex="-1"></a></span>
<span id="cb200-31"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb200-31" tabindex="-1"></a><span class="co"># Compare with naive and adjusted estimates</span></span>
<span id="cb200-32"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb200-32" tabindex="-1"></a>crude_diff <span class="ot">&lt;-</span> <span class="fu">mean</span>(data<span class="sc">$</span>Y[data<span class="sc">$</span>A <span class="sc">==</span> <span class="dv">1</span>]) <span class="sc">-</span> <span class="fu">mean</span>(data<span class="sc">$</span>Y[data<span class="sc">$</span>A <span class="sc">==</span> <span class="dv">0</span>])</span>
<span id="cb200-33"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb200-33" tabindex="-1"></a>glm_model <span class="ot">&lt;-</span> <span class="fu">glm</span>(Y <span class="sc">~</span> A <span class="sc">+</span> ., <span class="at">data =</span> data, <span class="at">family =</span> binomial)</span>
<span id="cb200-34"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb200-34" tabindex="-1"></a>glm_ate <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">predict</span>(glm_model, <span class="at">newdata =</span> <span class="fu">transform</span>(data, <span class="at">A =</span> <span class="dv">1</span>), <span class="at">type =</span> <span class="st">&quot;response&quot;</span>)) <span class="sc">-</span></span>
<span id="cb200-35"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb200-35" tabindex="-1"></a>           <span class="fu">mean</span>(<span class="fu">predict</span>(glm_model, <span class="at">newdata =</span> <span class="fu">transform</span>(data, <span class="at">A =</span> <span class="dv">0</span>), <span class="at">type =</span> <span class="st">&quot;response&quot;</span>))</span>
<span id="cb200-36"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb200-36" tabindex="-1"></a></span>
<span id="cb200-37"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb200-37" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">Comparison of Methods:</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb200-38"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb200-38" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Crude difference:&quot;</span>, <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> crude_diff, <span class="dv">2</span>), <span class="st">&quot;%</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb200-39"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb200-39" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Logistic regression ATE:&quot;</span>, <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> glm_ate, <span class="dv">2</span>), <span class="st">&quot;%</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb200-40"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb200-40" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;TMLE ATE:&quot;</span>, <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> ate_tmle, <span class="dv">2</span>), <span class="st">&quot;%</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<p>The SuperLearner ensemble approach automatically adapts to the complexity of the underlying relationships without requiring researchers to specify the correct functional forms. By including linear models, interaction terms, regularized regression, and tree-based methods, the ensemble can capture both smooth linear relationships and complex nonlinear patterns while avoiding overfitting through cross-validation.</p>
</div>
<div id="examining-model-performance-and-diagnostics" class="section level3 hasAnchor" number="10.2.2">
<h3><span class="header-section-number">10.2.2</span> Examining Model Performance and Diagnostics<a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#examining-model-performance-and-diagnostics" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Understanding how well our nuisance parameter models perform provides crucial insight into the reliability of TMLE estimates. The double robustness property means that poor performance in one model can be compensated by good performance in the other, but examining both models helps assess overall estimate quality.</p>
<div class="sourceCode" id="cb201"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb201-1"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb201-1" tabindex="-1"></a><span class="co"># Extract and examine nuisance parameter estimates</span></span>
<span id="cb201-2"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb201-2" tabindex="-1"></a>Q_estimates <span class="ot">&lt;-</span> tmle_result<span class="sc">$</span>Qinit<span class="sc">$</span>Q</span>
<span id="cb201-3"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb201-3" tabindex="-1"></a>g_estimates <span class="ot">&lt;-</span> tmle_result<span class="sc">$</span>g<span class="sc">$</span>g1W</span>
<span id="cb201-4"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb201-4" tabindex="-1"></a></span>
<span id="cb201-5"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb201-5" tabindex="-1"></a><span class="co"># Assess outcome model performance</span></span>
<span id="cb201-6"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb201-6" tabindex="-1"></a>Q_treated <span class="ot">&lt;-</span> tmle_result<span class="sc">$</span>Qinit<span class="sc">$</span>Q1W</span>
<span id="cb201-7"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb201-7" tabindex="-1"></a>Q_control <span class="ot">&lt;-</span> tmle_result<span class="sc">$</span>Qinit<span class="sc">$</span>Q0W</span>
<span id="cb201-8"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb201-8" tabindex="-1"></a></span>
<span id="cb201-9"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb201-9" tabindex="-1"></a><span class="co"># Calculate residuals for treated and control groups</span></span>
<span id="cb201-10"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb201-10" tabindex="-1"></a>residuals_treated <span class="ot">&lt;-</span> data<span class="sc">$</span>Y[data<span class="sc">$</span>A <span class="sc">==</span> <span class="dv">1</span>] <span class="sc">-</span> Q_treated[data<span class="sc">$</span>A <span class="sc">==</span> <span class="dv">1</span>]</span>
<span id="cb201-11"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb201-11" tabindex="-1"></a>residuals_control <span class="ot">&lt;-</span> data<span class="sc">$</span>Y[data<span class="sc">$</span>A <span class="sc">==</span> <span class="dv">0</span>] <span class="sc">-</span> Q_control[data<span class="sc">$</span>A <span class="sc">==</span> <span class="dv">0</span>]</span>
<span id="cb201-12"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb201-12" tabindex="-1"></a></span>
<span id="cb201-13"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb201-13" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Outcome Model Diagnostics:</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb201-14"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb201-14" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Mean absolute error (treated):&quot;</span>, <span class="fu">round</span>(<span class="fu">mean</span>(<span class="fu">abs</span>(residuals_treated)), <span class="dv">4</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb201-15"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb201-15" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Mean absolute error (control):&quot;</span>, <span class="fu">round</span>(<span class="fu">mean</span>(<span class="fu">abs</span>(residuals_control)), <span class="dv">4</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb201-16"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb201-16" tabindex="-1"></a></span>
<span id="cb201-17"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb201-17" tabindex="-1"></a><span class="co"># Assess propensity score model</span></span>
<span id="cb201-18"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb201-18" tabindex="-1"></a>predicted_treatment <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="fu">length</span>(g_estimates), <span class="dv">1</span>, g_estimates)</span>
<span id="cb201-19"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb201-19" tabindex="-1"></a>propensity_accuracy <span class="ot">&lt;-</span> <span class="fu">mean</span>(predicted_treatment <span class="sc">==</span> data<span class="sc">$</span>A)</span>
<span id="cb201-20"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb201-20" tabindex="-1"></a></span>
<span id="cb201-21"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb201-21" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Propensity Score Diagnostics:</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb201-22"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb201-22" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Prediction accuracy:&quot;</span>, <span class="fu">round</span>(propensity_accuracy, <span class="dv">3</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb201-23"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb201-23" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Mean propensity score:&quot;</span>, <span class="fu">round</span>(<span class="fu">mean</span>(g_estimates), <span class="dv">3</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb201-24"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb201-24" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Propensity score range: [&quot;</span>, <span class="fu">round</span>(<span class="fu">min</span>(g_estimates), <span class="dv">3</span>), <span class="st">&quot;,&quot;</span>, <span class="fu">round</span>(<span class="fu">max</span>(g_estimates), <span class="dv">3</span>), <span class="st">&quot;]</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb201-25"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb201-25" tabindex="-1"></a></span>
<span id="cb201-26"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb201-26" tabindex="-1"></a><span class="co"># Check for extreme propensity scores that might indicate positivity violations</span></span>
<span id="cb201-27"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb201-27" tabindex="-1"></a>extreme_low <span class="ot">&lt;-</span> <span class="fu">mean</span>(g_estimates <span class="sc">&lt;</span> <span class="fl">0.05</span>)</span>
<span id="cb201-28"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb201-28" tabindex="-1"></a>extreme_high <span class="ot">&lt;-</span> <span class="fu">mean</span>(g_estimates <span class="sc">&gt;</span> <span class="fl">0.95</span>)</span>
<span id="cb201-29"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb201-29" tabindex="-1"></a></span>
<span id="cb201-30"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb201-30" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Extreme propensity scores:</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb201-31"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb201-31" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;  &lt; 0.05:&quot;</span>, <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> extreme_low, <span class="dv">1</span>), <span class="st">&quot;% of patients</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb201-32"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb201-32" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;  &gt; 0.95:&quot;</span>, <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> extreme_high, <span class="dv">1</span>), <span class="st">&quot;% of patients</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb201-33"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb201-33" tabindex="-1"></a></span>
<span id="cb201-34"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb201-34" tabindex="-1"></a><span class="co"># Visualize propensity score distribution by treatment group</span></span>
<span id="cb201-35"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb201-35" tabindex="-1"></a>prop_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb201-36"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb201-36" tabindex="-1"></a>  <span class="at">propensity =</span> g_estimates,</span>
<span id="cb201-37"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb201-37" tabindex="-1"></a>  <span class="at">treatment =</span> <span class="fu">factor</span>(data<span class="sc">$</span>A, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;CCB&quot;</span>, <span class="st">&quot;ACE Inhibitor&quot;</span>))</span>
<span id="cb201-38"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb201-38" tabindex="-1"></a>)</span>
<span id="cb201-39"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb201-39" tabindex="-1"></a></span>
<span id="cb201-40"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb201-40" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(prop_data, <span class="fu">aes</span>(<span class="at">x =</span> propensity, <span class="at">fill =</span> treatment)) <span class="sc">+</span></span>
<span id="cb201-41"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb201-41" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">alpha =</span> <span class="fl">0.7</span>, <span class="at">bins =</span> <span class="dv">30</span>, <span class="at">position =</span> <span class="st">&quot;identity&quot;</span>) <span class="sc">+</span></span>
<span id="cb201-42"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb201-42" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Propensity Score Distribution by Treatment Group&quot;</span>,</span>
<span id="cb201-43"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb201-43" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&quot;Overlap assessment for positivity assumption&quot;</span>,</span>
<span id="cb201-44"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb201-44" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;Estimated Propensity Score&quot;</span>, </span>
<span id="cb201-45"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb201-45" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Count&quot;</span>,</span>
<span id="cb201-46"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb201-46" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">&quot;Treatment&quot;</span>) <span class="sc">+</span></span>
<span id="cb201-47"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb201-47" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb201-48"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb201-48" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">&quot;bold&quot;</span>))</span>
<span id="cb201-49"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb201-49" tabindex="-1"></a></span>
<span id="cb201-50"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb201-50" tabindex="-1"></a><span class="fu">print</span>(p1)</span></code></pre></div>
<p>The propensity score distribution reveals crucial information about the positivity assumption. Good overlap between treatment groups across propensity score values supports the assumption that similar patients could receive either treatment. Extreme propensity scores near 0 or 1 suggest regions where treatment assignment is nearly deterministic, potentially violating positivity and leading to unstable estimates.</p>
</div>
<div id="understanding-the-targeting-step" class="section level3 hasAnchor" number="10.2.3">
<h3><span class="header-section-number">10.2.3</span> Understanding the Targeting Step<a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#understanding-the-targeting-step" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The targeting step represents TMLE’s unique contribution to causal inference, transforming initial machine learning estimates into bias-corrected estimates optimized specifically for the causal parameter of interest. Examining this step illuminates how TMLE achieves its theoretical properties.</p>
<div class="sourceCode" id="cb202"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb202-1"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb202-1" tabindex="-1"></a><span class="co"># Examine the targeting step in detail</span></span>
<span id="cb202-2"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb202-2" tabindex="-1"></a>initial_Q <span class="ot">&lt;-</span> tmle_result<span class="sc">$</span>Qinit<span class="sc">$</span>Q</span>
<span id="cb202-3"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb202-3" tabindex="-1"></a>targeted_Q <span class="ot">&lt;-</span> tmle_result<span class="sc">$</span>Qstar<span class="sc">$</span>Q</span>
<span id="cb202-4"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb202-4" tabindex="-1"></a>epsilon <span class="ot">&lt;-</span> tmle_result<span class="sc">$</span>epsilon</span>
<span id="cb202-5"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb202-5" tabindex="-1"></a></span>
<span id="cb202-6"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb202-6" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Targeting Step Analysis:</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb202-7"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb202-7" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Targeting parameter (epsilon):&quot;</span>, <span class="fu">round</span>(epsilon[<span class="dv">1</span>], <span class="dv">6</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb202-8"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb202-8" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Mean initial outcome prediction:&quot;</span>, <span class="fu">round</span>(<span class="fu">mean</span>(initial_Q), <span class="dv">4</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb202-9"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb202-9" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Mean targeted outcome prediction:&quot;</span>, <span class="fu">round</span>(<span class="fu">mean</span>(targeted_Q), <span class="dv">4</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb202-10"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb202-10" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Mean absolute targeting adjustment:&quot;</span>, <span class="fu">round</span>(<span class="fu">mean</span>(<span class="fu">abs</span>(targeted_Q <span class="sc">-</span> initial_Q)), <span class="dv">6</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb202-11"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb202-11" tabindex="-1"></a></span>
<span id="cb202-12"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb202-12" tabindex="-1"></a><span class="co"># Calculate the clever covariate H(A,W) used in targeting</span></span>
<span id="cb202-13"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb202-13" tabindex="-1"></a>H_1 <span class="ot">&lt;-</span> data<span class="sc">$</span>A <span class="sc">/</span> g_estimates</span>
<span id="cb202-14"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb202-14" tabindex="-1"></a>H_0 <span class="ot">&lt;-</span> (<span class="dv">1</span> <span class="sc">-</span> data<span class="sc">$</span>A) <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">-</span> g_estimates)</span>
<span id="cb202-15"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb202-15" tabindex="-1"></a>clever_covariate <span class="ot">&lt;-</span> H_1 <span class="sc">-</span> H_0</span>
<span id="cb202-16"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb202-16" tabindex="-1"></a></span>
<span id="cb202-17"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb202-17" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Clever Covariate Statistics:</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb202-18"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb202-18" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Mean H(A,W):&quot;</span>, <span class="fu">round</span>(<span class="fu">mean</span>(clever_covariate), <span class="dv">4</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb202-19"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb202-19" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;SD H(A,W):&quot;</span>, <span class="fu">round</span>(<span class="fu">sd</span>(clever_covariate), <span class="dv">4</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb202-20"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb202-20" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Range H(A,W): [&quot;</span>, <span class="fu">round</span>(<span class="fu">min</span>(clever_covariate), <span class="dv">4</span>), <span class="st">&quot;,&quot;</span>, <span class="fu">round</span>(<span class="fu">max</span>(clever_covariate), <span class="dv">4</span>), <span class="st">&quot;]</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb202-21"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb202-21" tabindex="-1"></a></span>
<span id="cb202-22"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb202-22" tabindex="-1"></a><span class="co"># Visualize the targeting adjustment</span></span>
<span id="cb202-23"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb202-23" tabindex="-1"></a>adjustment_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb202-24"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb202-24" tabindex="-1"></a>  <span class="at">initial =</span> initial_Q,</span>
<span id="cb202-25"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb202-25" tabindex="-1"></a>  <span class="at">targeted =</span> targeted_Q,</span>
<span id="cb202-26"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb202-26" tabindex="-1"></a>  <span class="at">adjustment =</span> targeted_Q <span class="sc">-</span> initial_Q,</span>
<span id="cb202-27"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb202-27" tabindex="-1"></a>  <span class="at">treatment =</span> <span class="fu">factor</span>(data<span class="sc">$</span>A, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;CCB&quot;</span>, <span class="st">&quot;ACE Inhibitor&quot;</span>))</span>
<span id="cb202-28"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb202-28" tabindex="-1"></a>)</span>
<span id="cb202-29"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb202-29" tabindex="-1"></a></span>
<span id="cb202-30"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb202-30" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(adjustment_data, <span class="fu">aes</span>(<span class="at">x =</span> initial, <span class="at">y =</span> adjustment, <span class="at">color =</span> treatment)) <span class="sc">+</span></span>
<span id="cb202-31"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb202-31" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.6</span>, <span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb202-32"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb202-32" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb202-33"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb202-33" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;TMLE Targeting Adjustment&quot;</span>,</span>
<span id="cb202-34"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb202-34" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&quot;How initial ML predictions were modified for bias correction&quot;</span>,</span>
<span id="cb202-35"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb202-35" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;Initial Outcome Prediction&quot;</span>, </span>
<span id="cb202-36"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb202-36" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Targeting Adjustment&quot;</span>,</span>
<span id="cb202-37"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb202-37" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">&quot;Treatment&quot;</span>) <span class="sc">+</span></span>
<span id="cb202-38"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb202-38" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb202-39"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb202-39" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">&quot;bold&quot;</span>))</span>
<span id="cb202-40"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb202-40" tabindex="-1"></a></span>
<span id="cb202-41"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb202-41" tabindex="-1"></a><span class="fu">print</span>(p2)</span></code></pre></div>
<p>The targeting parameter epsilon quantifies how much the initial outcome model needed adjustment to optimize performance for the causal parameter. Small epsilon values suggest the initial machine learning model was already well-suited for causal inference, while larger values indicate substantial bias correction was necessary. The clever covariate weights observations according to their importance for the causal parameter, with patients having extreme propensity scores receiving higher weights due to their greater information content for treatment effect estimation.</p>
</div>
<div id="robustness-analysis-and-sensitivity-testing" class="section level3 hasAnchor" number="10.2.4">
<h3><span class="header-section-number">10.2.4</span> Robustness Analysis and Sensitivity Testing<a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#robustness-analysis-and-sensitivity-testing" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>TMLE’s double robustness property provides protection against model misspecification, but understanding this protection requires systematic evaluation of how estimate quality depends on nuisance parameter estimation accuracy. We can assess robustness by deliberately misspecifying one model while maintaining the other.</p>
<div class="sourceCode" id="cb203"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb203-1"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb203-1" tabindex="-1"></a><span class="co"># Test double robustness by misspecifying outcome model</span></span>
<span id="cb203-2"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb203-2" tabindex="-1"></a><span class="co"># Use only linear terms instead of flexible SuperLearner</span></span>
<span id="cb203-3"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb203-3" tabindex="-1"></a>tmle_misspec_Q <span class="ot">&lt;-</span> <span class="fu">tmle</span>(<span class="at">Y =</span> data<span class="sc">$</span>Y,</span>
<span id="cb203-4"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb203-4" tabindex="-1"></a>                       <span class="at">A =</span> data<span class="sc">$</span>A,</span>
<span id="cb203-5"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb203-5" tabindex="-1"></a>                       <span class="at">W =</span> data[, <span class="dv">1</span><span class="sc">:</span><span class="dv">14</span>],</span>
<span id="cb203-6"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb203-6" tabindex="-1"></a>                       <span class="at">Q.SL.library =</span> <span class="st">&quot;SL.glm&quot;</span>,        <span class="co"># Misspecified outcome model</span></span>
<span id="cb203-7"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb203-7" tabindex="-1"></a>                       <span class="at">g.SL.library =</span> SL_library,      <span class="co"># Correct propensity model</span></span>
<span id="cb203-8"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb203-8" tabindex="-1"></a>                       <span class="at">family =</span> <span class="st">&quot;binomial&quot;</span>)</span>
<span id="cb203-9"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb203-9" tabindex="-1"></a></span>
<span id="cb203-10"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb203-10" tabindex="-1"></a><span class="co"># Test double robustness by misspecifying propensity model  </span></span>
<span id="cb203-11"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb203-11" tabindex="-1"></a>tmle_misspec_g <span class="ot">&lt;-</span> <span class="fu">tmle</span>(<span class="at">Y =</span> data<span class="sc">$</span>Y,</span>
<span id="cb203-12"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb203-12" tabindex="-1"></a>                       <span class="at">A =</span> data<span class="sc">$</span>A,</span>
<span id="cb203-13"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb203-13" tabindex="-1"></a>                       <span class="at">W =</span> data[, <span class="dv">1</span><span class="sc">:</span><span class="dv">14</span>],</span>
<span id="cb203-14"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb203-14" tabindex="-1"></a>                       <span class="at">Q.SL.library =</span> SL_library,      <span class="co"># Correct outcome model</span></span>
<span id="cb203-15"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb203-15" tabindex="-1"></a>                       <span class="at">g.SL.library =</span> <span class="st">&quot;SL.glm&quot;</span>,        <span class="co"># Misspecified propensity model</span></span>
<span id="cb203-16"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb203-16" tabindex="-1"></a>                       <span class="at">family =</span> <span class="st">&quot;binomial&quot;</span>)</span>
<span id="cb203-17"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb203-17" tabindex="-1"></a></span>
<span id="cb203-18"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb203-18" tabindex="-1"></a><span class="co"># Test complete misspecification</span></span>
<span id="cb203-19"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb203-19" tabindex="-1"></a>tmle_misspec_both <span class="ot">&lt;-</span> <span class="fu">tmle</span>(<span class="at">Y =</span> data<span class="sc">$</span>Y,</span>
<span id="cb203-20"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb203-20" tabindex="-1"></a>                          <span class="at">A =</span> data<span class="sc">$</span>A,</span>
<span id="cb203-21"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb203-21" tabindex="-1"></a>                          <span class="at">W =</span> data[, <span class="dv">1</span><span class="sc">:</span><span class="dv">14</span>],</span>
<span id="cb203-22"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb203-22" tabindex="-1"></a>                          <span class="at">Q.SL.library =</span> <span class="st">&quot;SL.glm&quot;</span>,      <span class="co"># Both models misspecified</span></span>
<span id="cb203-23"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb203-23" tabindex="-1"></a>                          <span class="at">g.SL.library =</span> <span class="st">&quot;SL.glm&quot;</span>,</span>
<span id="cb203-24"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb203-24" tabindex="-1"></a>                          <span class="at">family =</span> <span class="st">&quot;binomial&quot;</span>)</span>
<span id="cb203-25"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb203-25" tabindex="-1"></a></span>
<span id="cb203-26"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb203-26" tabindex="-1"></a><span class="co"># Compare estimates</span></span>
<span id="cb203-27"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb203-27" tabindex="-1"></a>results_comparison <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb203-28"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb203-28" tabindex="-1"></a>  <span class="at">Method =</span> <span class="fu">c</span>(<span class="st">&quot;Full SuperLearner&quot;</span>, <span class="st">&quot;Misspec Outcome&quot;</span>, <span class="st">&quot;Misspec Propensity&quot;</span>, <span class="st">&quot;Both Misspec&quot;</span>),</span>
<span id="cb203-29"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb203-29" tabindex="-1"></a>  <span class="at">ATE =</span> <span class="fu">c</span>(tmle_result<span class="sc">$</span>estimates<span class="sc">$</span>ATE<span class="sc">$</span>psi,</span>
<span id="cb203-30"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb203-30" tabindex="-1"></a>          tmle_misspec_Q<span class="sc">$</span>estimates<span class="sc">$</span>ATE<span class="sc">$</span>psi,</span>
<span id="cb203-31"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb203-31" tabindex="-1"></a>          tmle_misspec_g<span class="sc">$</span>estimates<span class="sc">$</span>ATE<span class="sc">$</span>psi,</span>
<span id="cb203-32"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb203-32" tabindex="-1"></a>          tmle_misspec_both<span class="sc">$</span>estimates<span class="sc">$</span>ATE<span class="sc">$</span>psi),</span>
<span id="cb203-33"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb203-33" tabindex="-1"></a>  <span class="at">SE =</span> <span class="fu">c</span>(<span class="fu">sqrt</span>(tmle_result<span class="sc">$</span>estimates<span class="sc">$</span>ATE<span class="sc">$</span>var.psi),</span>
<span id="cb203-34"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb203-34" tabindex="-1"></a>         <span class="fu">sqrt</span>(tmle_misspec_Q<span class="sc">$</span>estimates<span class="sc">$</span>ATE<span class="sc">$</span>var.psi),</span>
<span id="cb203-35"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb203-35" tabindex="-1"></a>         <span class="fu">sqrt</span>(tmle_misspec_g<span class="sc">$</span>estimates<span class="sc">$</span>ATE<span class="sc">$</span>var.psi),</span>
<span id="cb203-36"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb203-36" tabindex="-1"></a>         <span class="fu">sqrt</span>(tmle_misspec_both<span class="sc">$</span>estimates<span class="sc">$</span>ATE<span class="sc">$</span>var.psi))</span>
<span id="cb203-37"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb203-37" tabindex="-1"></a>)</span>
<span id="cb203-38"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb203-38" tabindex="-1"></a></span>
<span id="cb203-39"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb203-39" tabindex="-1"></a>results_comparison<span class="sc">$</span>CI_Lower <span class="ot">&lt;-</span> results_comparison<span class="sc">$</span>ATE <span class="sc">-</span> <span class="fl">1.96</span> <span class="sc">*</span> results_comparison<span class="sc">$</span>SE</span>
<span id="cb203-40"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb203-40" tabindex="-1"></a>results_comparison<span class="sc">$</span>CI_Upper <span class="ot">&lt;-</span> results_comparison<span class="sc">$</span>ATE <span class="sc">+</span> <span class="fl">1.96</span> <span class="sc">*</span> results_comparison<span class="sc">$</span>SE</span>
<span id="cb203-41"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb203-41" tabindex="-1"></a></span>
<span id="cb203-42"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb203-42" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Robustness Analysis Results:</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb203-43"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb203-43" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">round</span>(results_comparison, <span class="dv">4</span>))</span>
<span id="cb203-44"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb203-44" tabindex="-1"></a></span>
<span id="cb203-45"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb203-45" tabindex="-1"></a><span class="co"># Visualize robustness</span></span>
<span id="cb203-46"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb203-46" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(results_comparison, <span class="fu">aes</span>(<span class="at">x =</span> Method, <span class="at">y =</span> ATE)) <span class="sc">+</span></span>
<span id="cb203-47"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb203-47" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">&quot;darkblue&quot;</span>) <span class="sc">+</span></span>
<span id="cb203-48"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb203-48" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> CI_Lower, <span class="at">ymax =</span> CI_Upper), <span class="at">width =</span> <span class="fl">0.2</span>, <span class="at">color =</span> <span class="st">&quot;darkblue&quot;</span>) <span class="sc">+</span></span>
<span id="cb203-49"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb203-49" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> ate_tmle, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb203-50"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb203-50" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;TMLE Robustness to Model Misspecification&quot;</span>,</span>
<span id="cb203-51"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb203-51" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&quot;Double robustness protects against single model failures&quot;</span>,</span>
<span id="cb203-52"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb203-52" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;Modeling Approach&quot;</span>, </span>
<span id="cb203-53"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb203-53" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Average Treatment Effect&quot;</span>) <span class="sc">+</span></span>
<span id="cb203-54"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb203-54" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb203-55"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb203-55" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">&quot;bold&quot;</span>),</span>
<span id="cb203-56"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb203-56" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span>
<span id="cb203-57"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb203-57" tabindex="-1"></a></span>
<span id="cb203-58"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb203-58" tabindex="-1"></a><span class="fu">print</span>(p3)</span></code></pre></div>
<p>This robustness analysis demonstrates TMLE’s double robustness property in practice. When either the outcome model or propensity score model is correctly specified (through SuperLearner), estimates remain stable and close to the fully-specified result. However, when both models are misspecified, bias can emerge, highlighting the importance of flexible modeling approaches for at least one nuisance parameter.</p>
</div>
<div id="clinical-interpretation-and-subgroup-analysis" class="section level3 hasAnchor" number="10.2.5">
<h3><span class="header-section-number">10.2.5</span> Clinical Interpretation and Subgroup Analysis<a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#clinical-interpretation-and-subgroup-analysis" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The TMLE analysis reveals that ACE inhibitors reduce cardiovascular events by approximately 2-3 percentage points compared to calcium channel blockers, a clinically meaningful difference that translates to preventing cardiovascular events in roughly 1 out of every 40 patients treated with ACE inhibitors instead of calcium channel blockers. This finding aligns with clinical expectations based on biological mechanisms and prior research.</p>
<div class="sourceCode" id="cb204"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb204-1"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb204-1" tabindex="-1"></a><span class="co"># Examine treatment effects across clinically relevant subgroups</span></span>
<span id="cb204-2"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb204-2" tabindex="-1"></a><span class="co"># TMLE can estimate conditional effects for specific patient populations</span></span>
<span id="cb204-3"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb204-3" tabindex="-1"></a></span>
<span id="cb204-4"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb204-4" tabindex="-1"></a><span class="co"># Define clinically relevant subgroups</span></span>
<span id="cb204-5"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb204-5" tabindex="-1"></a>diabetes_patients <span class="ot">&lt;-</span> data<span class="sc">$</span>diabetes <span class="sc">==</span> <span class="dv">1</span></span>
<span id="cb204-6"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb204-6" tabindex="-1"></a>heart_failure_patients <span class="ot">&lt;-</span> data<span class="sc">$</span>heart_failure <span class="sc">==</span> <span class="dv">1</span></span>
<span id="cb204-7"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb204-7" tabindex="-1"></a>elderly_patients <span class="ot">&lt;-</span> data<span class="sc">$</span>age <span class="sc">&gt;</span> <span class="dv">70</span></span>
<span id="cb204-8"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb204-8" tabindex="-1"></a>high_risk_patients <span class="ot">&lt;-</span> (data<span class="sc">$</span>cad <span class="sc">==</span> <span class="dv">1</span> <span class="sc">|</span> data<span class="sc">$</span>heart_failure <span class="sc">==</span> <span class="dv">1</span> <span class="sc">|</span> data<span class="sc">$</span>diabetes <span class="sc">==</span> <span class="dv">1</span>)</span>
<span id="cb204-9"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb204-9" tabindex="-1"></a></span>
<span id="cb204-10"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb204-10" tabindex="-1"></a>subgroups <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb204-11"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb204-11" tabindex="-1"></a>  <span class="st">&quot;Diabetes&quot;</span> <span class="ot">=</span> diabetes_patients,</span>
<span id="cb204-12"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb204-12" tabindex="-1"></a>  <span class="st">&quot;Heart Failure&quot;</span> <span class="ot">=</span> heart_failure_patients, </span>
<span id="cb204-13"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb204-13" tabindex="-1"></a>  <span class="st">&quot;Elderly (&gt;70)&quot;</span> <span class="ot">=</span> elderly_patients,</span>
<span id="cb204-14"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb204-14" tabindex="-1"></a>  <span class="st">&quot;High Risk&quot;</span> <span class="ot">=</span> high_risk_patients</span>
<span id="cb204-15"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb204-15" tabindex="-1"></a>)</span>
<span id="cb204-16"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb204-16" tabindex="-1"></a></span>
<span id="cb204-17"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb204-17" tabindex="-1"></a>subgroup_results <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb204-18"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb204-18" tabindex="-1"></a>  <span class="at">Subgroup =</span> <span class="fu">character</span>(<span class="dv">0</span>),</span>
<span id="cb204-19"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb204-19" tabindex="-1"></a>  <span class="at">N =</span> <span class="fu">numeric</span>(<span class="dv">0</span>),</span>
<span id="cb204-20"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb204-20" tabindex="-1"></a>  <span class="at">ATE =</span> <span class="fu">numeric</span>(<span class="dv">0</span>),</span>
<span id="cb204-21"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb204-21" tabindex="-1"></a>  <span class="at">SE =</span> <span class="fu">numeric</span>(<span class="dv">0</span>),</span>
<span id="cb204-22"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb204-22" tabindex="-1"></a>  <span class="at">P_value =</span> <span class="fu">numeric</span>(<span class="dv">0</span>)</span>
<span id="cb204-23"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb204-23" tabindex="-1"></a>)</span>
<span id="cb204-24"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb204-24" tabindex="-1"></a></span>
<span id="cb204-25"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb204-25" tabindex="-1"></a><span class="cf">for</span>(subgroup_name <span class="cf">in</span> <span class="fu">names</span>(subgroups)) {</span>
<span id="cb204-26"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb204-26" tabindex="-1"></a>  subgroup_idx <span class="ot">&lt;-</span> subgroups[[subgroup_name]]</span>
<span id="cb204-27"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb204-27" tabindex="-1"></a>  </span>
<span id="cb204-28"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb204-28" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">sum</span>(subgroup_idx) <span class="sc">&gt;</span> <span class="dv">100</span>) {  <span class="co"># Ensure adequate sample size</span></span>
<span id="cb204-29"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb204-29" tabindex="-1"></a>    subgroup_data <span class="ot">&lt;-</span> data[subgroup_idx, ]</span>
<span id="cb204-30"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb204-30" tabindex="-1"></a>    </span>
<span id="cb204-31"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb204-31" tabindex="-1"></a>    tmle_sub <span class="ot">&lt;-</span> <span class="fu">tmle</span>(<span class="at">Y =</span> subgroup_data<span class="sc">$</span>Y,</span>
<span id="cb204-32"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb204-32" tabindex="-1"></a>                     <span class="at">A =</span> subgroup_data<span class="sc">$</span>A,</span>
<span id="cb204-33"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb204-33" tabindex="-1"></a>                     <span class="at">W =</span> subgroup_data[, <span class="dv">1</span><span class="sc">:</span><span class="dv">14</span>],</span>
<span id="cb204-34"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb204-34" tabindex="-1"></a>                     <span class="at">Q.SL.library =</span> SL_library,</span>
<span id="cb204-35"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb204-35" tabindex="-1"></a>                     <span class="at">g.SL.library =</span> SL_library,</span>
<span id="cb204-36"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb204-36" tabindex="-1"></a>                     <span class="at">family =</span> <span class="st">&quot;binomial&quot;</span>)</span>
<span id="cb204-37"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb204-37" tabindex="-1"></a>    </span>
<span id="cb204-38"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb204-38" tabindex="-1"></a>    ate_sub <span class="ot">&lt;-</span> tmle_sub<span class="sc">$</span>estimates<span class="sc">$</span>ATE<span class="sc">$</span>psi</span>
<span id="cb204-39"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb204-39" tabindex="-1"></a>    se_sub <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(tmle_sub<span class="sc">$</span>estimates<span class="sc">$</span>ATE<span class="sc">$</span>var.psi)</span>
<span id="cb204-40"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb204-40" tabindex="-1"></a>    p_sub <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fu">pnorm</span>(<span class="fu">abs</span>(ate_sub <span class="sc">/</span> se_sub)))</span>
<span id="cb204-41"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb204-41" tabindex="-1"></a>    </span>
<span id="cb204-42"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb204-42" tabindex="-1"></a>    subgroup_results <span class="ot">&lt;-</span> <span class="fu">rbind</span>(subgroup_results, <span class="fu">data.frame</span>(</span>
<span id="cb204-43"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb204-43" tabindex="-1"></a>      <span class="at">Subgroup =</span> subgroup_name,</span>
<span id="cb204-44"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb204-44" tabindex="-1"></a>      <span class="at">N =</span> <span class="fu">sum</span>(subgroup_idx),</span>
<span id="cb204-45"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb204-45" tabindex="-1"></a>      <span class="at">ATE =</span> ate_sub,</span>
<span id="cb204-46"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb204-46" tabindex="-1"></a>      <span class="at">SE =</span> se_sub,</span>
<span id="cb204-47"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb204-47" tabindex="-1"></a>      <span class="at">P_value =</span> p_sub</span>
<span id="cb204-48"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb204-48" tabindex="-1"></a>    ))</span>
<span id="cb204-49"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb204-49" tabindex="-1"></a>  }</span>
<span id="cb204-50"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb204-50" tabindex="-1"></a>}</span>
<span id="cb204-51"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb204-51" tabindex="-1"></a></span>
<span id="cb204-52"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb204-52" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Subgroup Analysis Results:</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb204-53"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb204-53" tabindex="-1"></a>subgroup_results<span class="sc">$</span>Risk_Diff_Percent <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> subgroup_results<span class="sc">$</span>ATE, <span class="dv">2</span>)</span>
<span id="cb204-54"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb204-54" tabindex="-1"></a>subgroup_results<span class="sc">$</span>CI_Lower <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> (subgroup_results<span class="sc">$</span>ATE <span class="sc">-</span> <span class="fl">1.96</span> <span class="sc">*</span> subgroup_results<span class="sc">$</span>SE), <span class="dv">2</span>)</span>
<span id="cb204-55"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb204-55" tabindex="-1"></a>subgroup_results<span class="sc">$</span>CI_Upper <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> (subgroup_results<span class="sc">$</span>ATE <span class="sc">+</span> <span class="fl">1.96</span> <span class="sc">*</span> subgroup_results<span class="sc">$</span>SE), <span class="dv">2</span>)</span>
<span id="cb204-56"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb204-56" tabindex="-1"></a></span>
<span id="cb204-57"><a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#cb204-57" tabindex="-1"></a><span class="fu">print</span>(subgroup_results[, <span class="fu">c</span>(<span class="st">&quot;Subgroup&quot;</span>, <span class="st">&quot;N&quot;</span>, <span class="st">&quot;Risk_Diff_Percent&quot;</span>, <span class="st">&quot;CI_Lower&quot;</span>, <span class="st">&quot;CI_Upper&quot;</span>, <span class="st">&quot;P_value&quot;</span>)])</span></code></pre></div>
<p>The subgroup analysis reveals heterogeneous treatment effects consistent with clinical understanding. Patients with diabetes and heart failure show larger benefits from ACE inhibitors, reflecting the additional cardioprotective mechanisms beyond blood pressure reduction. Elderly patients show smaller benefits, possibly reflecting competing risks or reduced physiological responsiveness to treatment.</p>
</div>
</div>
<div id="limitations-and-practical-implementation" class="section level2 hasAnchor" number="10.3">
<h2><span class="header-section-number">10.3</span> Limitations and Practical Implementation<a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#limitations-and-practical-implementation" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>TMLE shares fundamental limitations with all observational causal inference methods, most notably the untestable assumption of no unmeasured confounding. In healthcare settings, unmeasured factors like disease severity, patient preferences, or physician practice patterns could bias treatment effect estimates regardless of methodological sophistication. Sensitivity analyses examining how conclusions might change under various assumptions about unmeasured confounding remain essential for responsible interpretation.</p>
<p>The method’s reliance on machine learning for nuisance parameter estimation introduces potential instability in finite samples. While SuperLearner provides cross-validated model selection, the ensemble weights can vary substantially across bootstrap samples or data subsets, potentially leading to unstable causal estimates. This instability particularly affects smaller datasets where cross-validation may not provide reliable algorithm selection.</p>
<p>The positivity assumption requires that patients with similar characteristics have positive probability of receiving either treatment. In healthcare settings, strong clinical contraindications or guidelines may create regions of covariate space where treatment assignment becomes nearly deterministic. When propensity scores approach 0 or 1, the clever covariate weights become extreme, leading to unstable estimates and inflated standard errors. Truncation strategies can mitigate this issue but introduce bias-variance tradeoffs that require careful consideration.</p>
<p>Alternative approaches to TMLE offer different advantages depending on the specific research context. Augmented inverse probability weighting (AIPW) provides similar double robustness properties with simpler implementation but lacks TMLE’s theoretical efficiency guarantees. Double machine learning methods achieve similar robustness through different sample splitting strategies and may offer computational advantages in some settings. Bayesian approaches can naturally incorporate uncertainty about model specification but require stronger distributional assumptions and more complex implementation.</p>
<p>TMLE’s computational intensity stems from the SuperLearner ensemble approach, which requires fitting multiple machine learning algorithms with cross-validation for each nuisance parameter. In large healthcare datasets with hundreds of thousands of patients and numerous covariates, computational time can become prohibitive without careful implementation strategies.</p>
<p>The most computationally demanding aspect involves the SuperLearner cross-validation, which typically uses 10-fold cross-validation for each candidate algorithm. With five candidate algorithms for both outcome and propensity score models, a single TMLE analysis requires fitting 100 models (10 CV folds × 5 algorithms × 2 nuisance parameters). Parallel processing across multiple cores can dramatically reduce runtime, particularly for embarrassingly parallel algorithms like random forests.</p>
<p>Memory requirements scale with both sample size and the complexity of machine learning algorithms. Tree-based methods like random forests can require substantial memory for large datasets, while simpler algorithms like penalized regression remain more memory-efficient. Practitioners working with massive healthcare datasets may need to balance ensemble complexity against computational feasibility, potentially using smaller SuperLearner libraries or more efficient algorithms.</p>
<p>The honesty principle underlying TMLE’s theoretical guarantees requires sample splitting that reduces effective sample sizes for each model. This creates practical tradeoffs between statistical efficiency and computational tractability. In moderate-sized datasets, the sample splitting combined with cross-validation can yield unstable estimates, suggesting that TMLE may be most appropriate for large healthcare databases where abundant data supports both sample splitting and complex ensemble modeling.</p>
<p>Recent methodological developments extend TMLE to increasingly complex causal questions that arise in healthcare research. Longitudinal TMLE handles time-varying treatments and confounders, enabling analysis of dynamic treatment regimens where treatment decisions evolve based on patient response and changing clinical status. This extension proves particularly valuable for chronic disease management where treatment intensification or modification occurs based on ongoing monitoring.</p>
<p>Mediation analysis using TMLE decomposes treatment effects into direct pathways and indirect effects operating through intermediate variables. In pharmaceutical research, this might involve understanding how much of a medication’s benefit operates through intended biological pathways versus secondary mechanisms. The TMLE framework ensures that both direct and indirect effect estimates maintain desirable statistical properties under realistic conditions.</p>
<p>Survival analysis extensions handle time-to-event outcomes with censoring, common in healthcare settings where patients may die, switch treatments, or become lost to follow-up. These methods require careful handling of competing risks and informative censoring while maintaining the double robustness properties that make TMLE attractive for observational studies.</p>
<p>Variable importance measures within the TMLE framework identify which patient characteristics contribute most to treatment effect heterogeneity. Unlike traditional regression coefficients that may be confounded by model specification, TMLE-based importance measures provide robust rankings of covariate relevance for treatment decisions. This capability supports precision medicine initiatives by identifying patient characteristics that should guide treatment selection.</p>
<p>Modern healthcare generates massive electronic health record databases that present both opportunities and challenges for TMLE implementation. The rich longitudinal data captured in EHRs enables comprehensive confounder control but introduces data quality issues that can compromise causal inference. Missing data patterns may relate to both treatment assignment and outcomes, violating TMLE’s assumptions if not handled appropriately.</p>
<p>The temporal structure of EHR data requires careful consideration of baseline covariate definition and follow-up windows. Treatment effects may vary with time since initiation, and the choice of follow-up period can substantially influence estimates. TMLE’s framework accommodates these complexities through careful problem formulation, but practitioners must make explicit choices about time windows and covariate measurement timing.</p>
<p>High-dimensional EHR data with thousands of potential confounders benefits from TMLE’s machine learning integration, but computational challenges intensify. Dimension reduction techniques or variable selection procedures may be necessary preprocessing steps, though these introduce additional modeling assumptions that could affect the double robustness properties.</p>
<p>The increasing availability of real-world evidence platforms that standardize EHR data across health systems creates opportunities for large-scale TMLE analyses with enhanced external validity. Multi-site analyses using TMLE can pool evidence across diverse healthcare settings while accounting for site-specific confounding patterns through appropriate covariate adjustment.</p>
<p>Successful TMLE implementation requires systematic attention to several practical considerations that bridge theoretical properties with real-world data challenges. Sample size planning should account for the efficiency losses inherent in sample splitting and cross-validation, typically requiring larger samples than traditional regression approaches for equivalent precision. Healthcare datasets with fewer than several thousand observations may not provide sufficient power for stable TMLE estimates, particularly when investigating numerous potential confounders.</p>
<p>Covariate selection remains crucial despite TMLE’s flexibility. Including variables that predict treatment assignment or outcomes without being confounders improves efficiency, while including instrumental variables can worsen performance by increasing variance without reducing bias. Clinical knowledge should guide initial variable selection, with machine learning methods handling functional form specification and interaction detection.</p>
<p>Diagnostic procedures should evaluate both nuisance parameter model performance and assumption validity. Propensity score distributions should show adequate overlap between treatment groups, outcome model residuals should appear unrelated to patient characteristics, and influential observation diagnostics should identify patients whose removal substantially changes estimates. These diagnostics help distinguish between method limitations and data quality issues.</p>
<p>Results reporting should emphasize both statistical significance and clinical relevance. The risk difference scale often provides more intuitive interpretation than odds ratios, particularly for communicating with clinical audiences. Number needed to treat calculations translate risk differences into clinical decision-making frameworks that support evidence-based practice.</p>
<p>The TMLE framework continues evolving to address increasingly complex causal questions in healthcare research. Machine learning advances in deep learning and automated feature engineering promise to improve nuisance parameter estimation, potentially enhancing both the flexibility and stability of TMLE estimates. However, these advances must be balanced against interpretability requirements and computational constraints.</p>
<p>Integration with causal discovery methods offers potential for identifying confounding structures from data rather than relying solely on clinical knowledge. While purely data-driven approaches cannot replace domain expertise, hybrid methods that combine algorithmic discovery with clinical input may improve confounder selection and model specification.</p>
<p>Fairness considerations become increasingly important as TMLE analyses inform clinical guidelines and treatment recommendations that may affect different patient populations differently. Ensuring that personalized treatment recommendations promote rather than exacerbate health disparities requires explicit attention to equity measures and subgroup analyses across sociodemographic characteristics.</p>
<p>The growing emphasis on precision medicine creates demands for TMLE extensions that estimate individualized treatment rules rather than average effects. These methods must balance personalization benefits against statistical efficiency and interpretability costs while maintaining the theoretical rigor that makes TMLE attractive for high-stakes clinical decision-making.</p>
</div>
<div id="conclusion-7" class="section level2 hasAnchor" number="10.4">
<h2><span class="header-section-number">10.4</span> Conclusion<a href="targeted-maximum-likelihood-estimation-for-robust-causal-inference-in-healthcare.html#conclusion-7" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Targeted Maximum Likelihood Estimation represents a fundamental advance in observational causal inference that directly addresses the core challenges facing healthcare researchers analyzing electronic health records and administrative databases. By combining the flexibility of machine learning with the statistical rigor of semiparametric theory, TMLE provides a principled framework for extracting causal insights from complex observational data without requiring restrictive parametric assumptions.</p>
<p>The double robustness property offers crucial protection against model misspecification in healthcare settings where complex patient characteristics, treatment assignment mechanisms, and outcome processes resist simple parametric description. This robustness comes with computational costs and sample size requirements that may limit applicability in smaller studies, but the increasing availability of large healthcare databases makes these requirements increasingly feasible.</p>
<p>Our hypertension treatment analysis demonstrates how TMLE can provide clinically actionable insights about comparative effectiveness while acknowledging uncertainty through honest confidence intervals. The method’s ability to accommodate complex confounding patterns, missing data mechanisms, and machine learning approaches makes it particularly well-suited for modern healthcare research environments where traditional methods may prove inadequate.</p>
<p>The theoretical guarantees underlying TMLE ensure that estimates achieve optimal statistical properties when identifying assumptions hold, providing efficiency advantages over simpler approaches like inverse probability weighting or outcome regression alone. These efficiency gains translate directly into improved power for detecting clinically meaningful treatment effects and narrower confidence intervals that support more definitive clinical recommendations.</p>
<p>As healthcare increasingly embraces precision medicine and real-world evidence generation, TMLE’s combination of flexibility, robustness, and efficiency positions it as an essential tool for causal inference. The method’s continued development through extensions to longitudinal data, survival outcomes, and individualized treatment rules ensures its relevance for addressing the complex causal questions that characterize modern healthcare research.</p>
<p>Successful implementation requires careful attention to computational considerations, diagnostic procedures, and assumption verification, but the investment in methodological sophistication pays dividends through more reliable causal estimates that can guide clinical practice and health policy decisions. When applied appropriately with adequate sample sizes and valid identifying assumptions, TMLE provides a powerful framework for transforming observational healthcare data into actionable causal knowledge that improves patient outcomes and healthcare delivery.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="meta-learners-for-heterogeneous-treatment-effects.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="g-computation-for-causal-inference.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
  "sharing": {
    "github": false,
    "facebook": true,
    "twitter": true,
    "linkedin": false,
    "weibo": false,
    "instapaper": false,
    "vk": false,
    "whatsapp": false,
    "all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
  },
  "fontsettings": {
    "theme": "white",
    "family": "sans",
    "size": 2
  },
  "edit": {
    "link": "https://github.com/Kamran-Afzali/Bookdown_Causality/edit/main/10-TLME.Rmd",
    "text": "Edit"
  },
  "history": {
    "link": null,
    "text": null
  },
  "view": {
    "link": "https://github.com/Kamran-Afzali/Bookdown_Causality/blob/main/10-TLME.Rmd",
    "text": null
  },
  "download": null,
  "search": {
    "engine": "fuse",
    "options": null
  },
  "toc": {
    "collapse": "subsection"
  }
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
